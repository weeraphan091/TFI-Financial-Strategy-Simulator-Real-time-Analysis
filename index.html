<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai Fortunate Innovation - Financial Strategy Simulator (Ultimate VAT Fixed)</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#334155',
                        accent: '#2563eb',
                        bg: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Prompt', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f1f5f9; color: #1e293b; }
        .app-container { min-height: 100vh; padding-bottom: 40px; }
        .header-bar { background: #0f172a; color: white; padding: 16px 24px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        .card { background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; overflow: hidden; margin-bottom: 16px; transition: transform 0.2s; }
        .card:hover { border-color: #cbd5e1; }
        .card-header { background: #f8fafc; padding: 10px 16px; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-weight: 600; color: #334155; font-size: 0.95rem; display: flex; align-items: center; gap: 8px; }
        .card-body { padding: 16px; }

        .input-group { margin-bottom: 8px; }
        .input-label { font-size: 0.85rem; color: #64748b; display: block; margin-bottom: 4px; }
        .input-field { width: 100%; border: 1px solid #cbd5e1; border-radius: 6px; padding: 4px 10px; font-size: 0.9rem; text-align: right; transition: all 0.2s; color: #0f172a; font-weight: 500; }
        .input-field:focus { border-color: #2563eb; outline: none; ring: 2px solid #bfdbfe; }
        .input-row { display: flex; justify-content: space-between; align-items: center; gap: 8px; padding: 4px 0; border-bottom: 1px dashed #f1f5f9; }
        
        .hr-table th { text-align: left; font-size: 0.7rem; color: #64748b; padding-bottom: 4px; }
        .hr-table td { padding: 2px 1px; vertical-align: middle; font-size: 0.7rem; }
        .hr-input { width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 1px 2px; font-size: 0.7rem; text-align: right; height: 24px; }

        .flow-row { display: flex; justify-content: space-between; padding: 4px 0; font-size: 0.85rem; }
        .flow-row.total { font-weight: 700; border-top: 1px solid #e2e8f0; margin-top: 4px; padding-top: 8px; }
        .flow-sub { padding-left: 12px; color: #64748b; font-size: 0.8rem; }

        .scenario-btn { padding: 4px 12px; font-size: 0.75rem; border-radius: 20px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
        .scenario-btn.active { font-weight: bold; transform: scale(1.05); }

        .matrix-table th, .matrix-table td { border: 1px solid #e2e8f0; padding: 6px; text-align: center; font-size: 0.75rem; }
        .matrix-header { background: #f1f5f9; font-weight: 600; color: #475569; }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { height: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        @media print {
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .header-bar { padding: 10px; background: white !important; color: black !important; box-shadow: none; border-bottom: 2px solid #000; }
            .header-bar h1 { font-size: 1.5rem; color: #000; }
            .header-bar p { color: #666; }
            .header-controls, .scenario-btn, .print-btn-hide, .toggle-switch-container { display: none !important; }
            .card { box-shadow: none; border: 1px solid #ccc; break-inside: avoid; margin-bottom: 10px; }
            .card-header { background: #eee !important; color: #000; border-bottom: 1px solid #aaa; }
            .input-field { border: none; background: transparent; padding: 0; text-align: right; font-weight: bold; }
            .input-group, .input-row { border-bottom: 1px solid #eee; }
            input[type=range] { display: none; }
            .app-container { padding-bottom: 0; }
            .lg\:col-span-3, .lg\:col-span-5, .lg\:col-span-4 { width: 100% !important; display: block; }
            .bg-slate-800 { background-color: #fff !important; color: #000 !important; border: 2px solid #000; }
            .bg-slate-800 .text-white { color: #000 !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, AreaChart, Area, CartesianGrid, PieChart, Pie, Cell, Legend, ComposedChart, Line, ReferenceLine } = Recharts;

        const fmt = (n) => new Intl.NumberFormat('th-TH', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(n);
        const fmtDec = (n) => new Intl.NumberFormat('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(n);
        const COLORS = ['#3b82f6', '#ef4444', '#f59e0b', '#10b981', '#6366f1', '#8b5cf6', '#ec4899', '#64748b'];

        // --- Helper for Base64 Unicode ---
        const toBase64 = (str) => {
            return window.btoa(unescape(encodeURIComponent(str)));
        };

        const fromBase64 = (str) => {
            return decodeURIComponent(escape(window.atob(str)));
        };

        // --- Initial Data ---
        const INITIAL = {
            regCapital: 12000000,
            loan: { amount: 0, rate: 5, term: 5 },
            capex: { factory: 7000000, machine: 1300000, license: 200000, stock: 1000000 },
            depreciation: { factoryYears: 20, machineYears: 10 }, 
            targetBags: 20000, price: 389,
            creditTerm: 0, 
            yield: 60, paddyPrice: 12000,
            byProducts: [
                { name: "‡πÅ‡∏Å‡∏•‡∏ö", percent: 23, price: 1500 },
                { name: "‡∏£‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", percent: 10, price: 9000 },
                { name: "‡∏£‡∏≥‡∏´‡∏¢‡∏≤‡∏ö", percent: 2, price: 9000 },
                { name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏±‡∏Å", percent: 2, price: 14000 },
                { name: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢", percent: 1, price: 0 },
            ],
            unit: { bag: 6.5, sticker: 2.0 },
            hr: [
                { role: "CEO/MD", count: 1, salary: 50000 },
                { role: "Plant Manager", count: 1, salary: 35000 },
                { role: "Production Staff", count: 4, salary: 15000 },
                { role: "Admin/Account", count: 1, salary: 20000 },
                { role: "Sales/Marketing", count: 2, salary: 17775 }
            ],
            varParams: { elecRate: 600, mktPercent: 14, platformPercent: 12 },
            fixedParams: { erp: 9000, campaign: 41000, other: 10000, maintPercent: 2 },
            // Campaign Breakdown Details
            campaignDetails: [
                { name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á 1 ‡∏™‡∏•‡∏∂‡∏á", qty: 1, costPerUnit: 16500 },
                { name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏™‡∏•‡∏∂‡∏á", qty: 2, costPerUnit: 8500 },
                { name: "‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ü‡∏£‡∏µ 1 ‡∏õ‡∏µ", qty: 3, costPerUnit: 2500 }
            ],
            logistics: { active: true, percent: 50, profit: 5 },
            dividend: { payout: 50, founders: 3 },
            growth: 10, inflation: 3, monthlyGrowth: 0, discountRate: 10,
            // New Funnel Assumptions
            mktFunnel: { basketSize: 1.0, cvr: 2.0, ctr: 1.5 },
            scenario: 'base', taxPaymentMode: 'annual'
        };

        const App = () => {
            const [toast, setToast] = useState(null); // Notification state

            const [d, setD] = useState(() => {
                try {
                    // 1. Check URL Parameters first
                    const params = new URLSearchParams(window.location.search);
                    const sharedData = params.get('data');
                    if (sharedData) {
                        const parsed = JSON.parse(fromBase64(sharedData));
                        // Ensure compatibility with potentially older shared links
                        if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                        return parsed;
                    }

                    // 2. Fallback to LocalStorage
                    const savedData = localStorage.getItem('morbSukFinancialData_v42'); 
                    let parsed = savedData ? JSON.parse(savedData) : INITIAL;
                    if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                    return parsed;
                } catch (e) { 
                    console.error("Data load error:", e);
                    return INITIAL; 
                }
            });
            const [c, setC] = useState(null); 

            useEffect(() => { 
                // Only save to localStorage if NOT viewing a shared link (to prevent overwriting user's own data immediately)
                // However, for simplicity in this single-user simulation style, we usually just save current state.
                // Let's verify if URL has data, if so, maybe we don't auto-save until they edit?
                // For now, consistent behavior: Current state is saved.
                localStorage.setItem('morbSukFinancialData_v42', JSON.stringify(d)); 
            }, [d]);

            const resetToDefault = () => {
                if (confirm("Reset all data to default?")) { 
                    setD(INITIAL); 
                    localStorage.removeItem('morbSukFinancialData_v42'); 
                    // Clear URL params without reload
                    window.history.pushState({}, document.title, window.location.pathname);
                }
            };

            const handleShare = () => {
                try {
                    const jsonString = JSON.stringify(d);
                    const encoded = toBase64(jsonString);
                    const url = `${window.location.origin}${window.location.pathname}?data=${encoded}`;
                    
                    navigator.clipboard.writeText(url).then(() => {
                        setToast("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (Copied!)");
                        setTimeout(() => setToast(null), 3000);
                        // Update browser URL to reflect current state
                        window.history.pushState({}, document.title, `?data=${encoded}`);
                    });
                } catch (e) {
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå");
                }
            };

            const handlePrint = () => window.print();
            
            // ... (handleExport function remains same)
            const handleExport = () => {
                if(!c) return;
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "Year,Revenue,Expenses,EBITDA,Depreciation,Tax,Net Profit,Dividend,Cash Balance\n";
                c.yrProj.data.forEach(row => {
                    csvContent += `${row.y},${row.rev},${row.exp},${row.ebitda},${row.dep},${row.tax},${row.net},${row.div},${row.cash}\n`;
                });
                csvContent += "\nMonthly Year 1\nMonth,Cash Inflow (Rev),Expense(Cash),EBITDA,Tax Paid,Cash Balance\n";
                c.cf.forEach(row => {
                    csvContent += `${row.m},${row.revCashIn},${row.expCash},${row.netOpCash},${row.tax},${row.cashFinal}\n`;
                });

                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "financial_projection_pro.csv");
                document.body.appendChild(link);
                link.click();
            };

            const applyScenario = (type) => {
                let newData = { ...d, scenario: type };
                if (type === 'worst') { newData.targetBags = 14000; newData.paddyPrice = 13500; newData.growth = 0; newData.varParams.mktPercent = 18; } 
                else if (type === 'base') { newData.targetBags = 20000; newData.paddyPrice = 12000; newData.growth = 10; newData.varParams.mktPercent = 14; } 
                else if (type === 'best') { newData.targetBags = 25000; newData.paddyPrice = 11500; newData.growth = 15; newData.varParams.mktPercent = 12; }
                setD(newData);
            };

            const up = (k, sk, v) => setD(p => ({...p, [k]: sk ? {...p[k], [sk]: +v} : +v}));
            const upArr = (k, i, f, v) => {
                const n = [...d[k]]; n[i][f] = f==='name'||f==='role'?v:+v; setD(p=>({...p, [k]: n}));
            };
            const upFunnel = (k, v) => setD(p => ({...p, mktFunnel: {...p.mktFunnel, [k]: +v}}));

            // Function to update Campaign Details and recalculate Total Campaign Cost
            const upCampaign = (idx, field, val) => {
                setD(prev => {
                    const newDetails = [...prev.campaignDetails];
                    newDetails[idx][field] = field === 'name' ? val : +val;
                    
                    // Recalculate total campaign cost
                    const newTotal = newDetails.reduce((sum, item) => sum + (item.qty * item.costPerUnit), 0);
                    
                    return {
                        ...prev,
                        campaignDetails: newDetails,
                        fixedParams: { ...prev.fixedParams, campaign: newTotal }
                    };
                });
            };

            const handleYieldChange = (e) => {
                const newYield = parseFloat(e.target.value);
                setD(prev => {
                    const currentByProdSum = prev.byProducts.reduce((sum, item) => sum + item.percent, 0);
                    const totalSolidMass = prev.yield + currentByProdSum; 
                    let newByProdTarget = totalSolidMass - newYield;
                    if (newByProdTarget < 0) newByProdTarget = 0; 
                    const ratio = currentByProdSum > 0 ? newByProdTarget / currentByProdSum : 0;
                    const newByProducts = prev.byProducts.map(item => ({
                        ...item,
                        percent: parseFloat((item.percent * ratio).toFixed(2))
                    }));
                    return { ...prev, yield: newYield, byProducts: newByProducts };
                });
            };

            // ... (calculateFinancials remains mostly the same, ensuring it uses fixedParams.campaign which is now auto-calculated)
            const calculateFinancials = (data) => {
                const totalCapex = Object.values(data.capex).reduce((a,b)=>a+b,0);
                const totalSources = data.regCapital + (data.loan.amount || 0);
                const workingCap = totalSources - totalCapex;
                const annualDepreciation = (data.capex.factory / data.depreciation.factoryYears) + (data.capex.machine / data.depreciation.machineYears);

                // Maintenance (Fixed Bug: 0% was reverting to default 2%)
                const maintPercent = (data.fixedParams.maintPercent !== undefined && data.fixedParams.maintPercent !== null) ? data.fixedParams.maintPercent : 2;
                const maintenanceCostYearly = data.capex.machine * (maintPercent / 100);
                const maintenanceCostMonthly = maintenanceCostYearly / 12;

                const dayTarget = data.targetBags / 30;
                const hourTarget = dayTarget / 8; 
                const riceRev = data.targetBags * data.price;
                
                const paddyTons = (data.targetBags * 5) / (data.yield/100) / 1000;
                const paddyBudget = paddyTons * data.paddyPrice;
                let totalByProductIncome = 0;
                const byProductsCalc = data.byProducts.map(item => {
                    const weight = paddyTons * (item.percent / 100);
                    const revenue = weight * item.price;
                    totalByProductIncome += revenue;
                    return { ...item, weight, revenue };
                });

                const logIncome = (data.targetBags * (data.logistics.percent/100)) * data.logistics.profit;

                // VAT Logic
                const baseRev = riceRev + totalByProductIncome + logIncome; 
                const totalVatOut = baseRev - (baseRev / 1.07);

                // Expenses
                const riceTotal = paddyBudget; 
                const packTotal = (data.unit.bag + data.unit.sticker) * data.targetBags; 
                const elecTotal = data.varParams.elecRate * paddyTons; 
                const platformTotal = riceRev * (data.varParams.platformPercent/100); 
                const mktTotal = riceRev * (data.varParams.mktPercent/100); 
                
                // Marketing Budget Total (Variable Only as requested)
                const totalMarketingBudget = mktTotal; 

                // HR & SSO
                let baseSalaryTotal = 0;
                let ssoTotal = 0;
                const hrCosts = data.hr.map(h => {
                    const ssoPerPerson = Math.floor(Math.min(h.salary, 15000) * 0.05);
                    const totalPerRole = (h.salary + ssoPerPerson) * h.count;
                    const ssoTotalRole = ssoPerPerson * h.count;
                    baseSalaryTotal += h.salary * h.count;
                    ssoTotal += ssoTotalRole;
                    return { ...h, ssoPerPerson, totalPerRole, ssoTotalRole };
                });
                const salaryTotal = baseSalaryTotal + ssoTotal; 
                const fixedCashTotal = salaryTotal + data.fixedParams.erp + data.fixedParams.campaign + data.fixedParams.other + maintenanceCostMonthly; 

                // Input VAT Calculation (Modified: Only specific items as requested)
                const vatableExpenses = packTotal + elecTotal + platformTotal + mktTotal;
                const totalVatIn = vatableExpenses - (vatableExpenses / 1.07);
                
                const totalVar = riceTotal + packTotal + elecTotal + platformTotal + mktTotal; 
                const section7Total = elecTotal + platformTotal + mktTotal + data.fixedParams.erp + data.fixedParams.campaign + data.fixedParams.other + maintenanceCostMonthly;

                const riceCostUnit = (5 / (data.yield/100)) * (data.paddyPrice/1000);
                const matCostUnit = riceCostUnit + data.unit.bag + data.unit.sticker;

                // --- Marketing Funnel Calculation ---
                // Assumptions
                const basketSize = data.mktFunnel?.basketSize || 1;
                const cvr = data.mktFunnel?.cvr || 2.0;
                const ctr = data.mktFunnel?.ctr || 1.5;

                const totalOrders = data.targetBags / basketSize;
                const cpa = totalMarketingBudget / totalOrders; // Cost Per Acquisition (Order)
                const visitorsNeeded = totalOrders / (cvr / 100);
                const impressionsNeeded = visitorsNeeded / (ctr / 100);
                const impliedCPC = totalMarketingBudget / visitorsNeeded;
                const impliedCPM = (totalMarketingBudget / impressionsNeeded) * 1000;

                // New calculations for TikTok Shop GMV Max
                const roas = totalMarketingBudget > 0 ? riceRev / totalMarketingBudget : 0;
                const acos = riceRev > 0 ? (totalMarketingBudget / riceRev) * 100 : 0;

                const funnelMetrics = {
                    budget: totalMarketingBudget,
                    orders: totalOrders,
                    cpa: cpa,
                    visitors: visitorsNeeded,
                    cpc: impliedCPC,
                    impressions: impressionsNeeded,
                    cpm: impliedCPM,
                    roas: roas, 
                    acos: acos, 
                    gmv: riceRev 
                };

                // Pre-calculate accrued revenue
                const accruedRev = [];
                for(let k=1; k<=24; k++) {
                   const growthFactor = Math.pow(1 + data.monthlyGrowth/100, k - 1);
                   accruedRev.push(baseRev * growthFactor);
                }
                const dailyRevs = [0, ...accruedRev].map(r => r/30); 

                // Cashflow Loop
                const cf = [];
                let runningCash = workingCap; 
                let annualOperatingCashProfit = 0; 
                let annualFinanceCost = 0; 
                let annualPrincipalPaid = 0;
                let lowestCashBalance = workingCap; 

                let remainingLoanPrincipal = data.loan.amount;
                const monthlyPrincipalPayment = data.loan.amount > 0 ? data.loan.amount / (data.loan.term * 12) : 0; 

                const creditTermDays = parseInt(data.creditTerm || 0);

                for(let i=1; i<=12; i++) {
                    const mRev = accruedRev[i-1]; 
                    
                    let cashInflow = 0;
                    const currentMonthStartCashDay = (i-1)*30 + 1;
                    const currentMonthEndCashDay = i*30;

                    const startSalesDay = currentMonthStartCashDay - creditTermDays;
                    const endSalesDay = currentMonthEndCashDay - creditTermDays;

                    const maxLookBack = Math.ceil(creditTermDays/30) + 1;
                    const startSourceM = Math.max(1, i - maxLookBack);
                    
                    for(let srcM = startSourceM; srcM <= i; srcM++) {
                        const mStart = (srcM-1)*30 + 1;
                        const mEnd = srcM*30;
                        const overlapStart = Math.max(startSalesDay, mStart);
                        const overlapEnd = Math.min(endSalesDay, mEnd);
                        if (overlapEnd >= overlapStart) {
                            const daysCount = overlapEnd - overlapStart + 1;
                            cashInflow += daysCount * dailyRevs[srcM]; 
                        }
                    }

                    const growthFactor = Math.pow(1 + data.monthlyGrowth/100, i - 1);
                    const mRice = riceTotal * growthFactor;
                    const mVatableVar = (packTotal + elecTotal + platformTotal + mktTotal) * growthFactor;
                    const mSalary = salaryTotal;
                    const mVatableFixed = (data.fixedParams.erp + data.fixedParams.campaign + data.fixedParams.other + maintenanceCostMonthly);
                    const mExpCash = mRice + mVatableVar + mSalary + mVatableFixed; 
                    
                    // VAT Flow
                    const mOutVat = totalVatOut * growthFactor;
                    const mInVatTotal = totalVatIn * growthFactor;
                    const mVatSettlement = mOutVat - mInVatTotal;
                    
                    // Effective Interest
                    const interestThisMonth = remainingLoanPrincipal * (data.loan.rate / 100 / 12);
                    const principalThisMonth = remainingLoanPrincipal > 0 ? monthlyPrincipalPayment : 0;
                    remainingLoanPrincipal -= principalThisMonth;

                    const mNetOpProfit = (mRev - mOutVat) - (mExpCash - mInVatTotal); 

                    annualOperatingCashProfit += mNetOpProfit;
                    annualFinanceCost += interestThisMonth;
                    annualPrincipalPaid += principalThisMonth;

                    const startOfMonthCash = runningCash;
                    const netCashMovement = cashInflow - mExpCash - mVatSettlement - interestThisMonth - principalThisMonth;
                    
                    runningCash += netCashMovement;
                    if(runningCash < lowestCashBalance) lowestCashBalance = runningCash;

                    cf.push({ 
                        m: i, 
                        rev: mRev, 
                        revCashIn: cashInflow, 
                        expCash: mExpCash, 
                        netOpCash: mNetOpProfit, 
                        interest: interestThisMonth, 
                        principal: principalThisMonth, 
                        cashStart: startOfMonthCash, 
                        cashPreTax: runningCash, 
                        vatPaid: mVatSettlement,
                        cashFinal: runningCash 
                    });
                }

                // Tax Helper
                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };

                // Tax Calc
                const taxableIncome = annualOperatingCashProfit - annualDepreciation - annualFinanceCost;
                let taxDetails = [];
                let totalTaxEst = calcTax(taxableIncome);
                
                if (taxableIncome > 0) {
                    if (taxableIncome > 300000) taxDetails.push({ tier: "300k-3M", rate: 15, amount: Math.min(taxableIncome - 300000, 2700000) * 0.15 });
                    if (taxableIncome > 3000000) taxDetails.push({ tier: "> 3M", rate: 20, amount: (taxableIncome - 3000000) * 0.20 });
                }
                
                const monthlyTaxAvg = totalTaxEst / 12;
                const cfFinal = cf.map((item, index) => {
                    let mTax = 0;
                    if (data.taxPaymentMode === 'annual') mTax = index === 11 ? totalTaxEst : 0;
                    else if (data.taxPaymentMode === 'monthly') mTax = monthlyTaxAvg;
                    
                    let finalCumulativeCash = item.cashPreTax;
                    if (data.taxPaymentMode === 'annual') { if (index === 11) finalCumulativeCash -= totalTaxEst; } 
                    else if (data.taxPaymentMode === 'monthly') { finalCumulativeCash -= (monthlyTaxAvg * (index + 1)); }
                    
                    if(finalCumulativeCash < lowestCashBalance) lowestCashBalance = finalCumulativeCash; 

                    return { ...item, tax: mTax, cashFinal: finalCumulativeCash };
                });

                const cfTotal = cfFinal.reduce((acc, cur) => ({
                    rev: acc.rev + cur.rev, 
                    revCashIn: (acc.revCashIn || 0) + cur.revCashIn,
                    expCash: acc.expCash + cur.expCash, netOpCash: acc.netOpCash + cur.netOpCash, 
                    tax: acc.tax + cur.tax, interest: acc.interest + cur.interest, principal: acc.principal + cur.principal, 
                    vatPaid: acc.vatPaid + cur.vatPaid
                }), { rev: 0, revCashIn: 0, expCash: 0, netOpCash: 0, tax: 0, interest: 0, principal: 0, vatPaid: 0 });
                cfTotal.cashFinal = cfFinal[11].cashFinal;

                const annualNetProfitAfterAll = taxableIncome - totalTaxEst; 
                const dividendTotal = annualNetProfitAfterAll > 0 ? annualNetProfitAfterAll * (data.dividend.payout / 100) : 0;
                const dividendPerPersonYear = data.dividend.founders > 0 ? dividendTotal / data.dividend.founders : 0;
                const dividendPerPersonMonth = dividendPerPersonYear / 12;
                const roi = totalSources > 0 ? (annualNetProfitAfterAll / totalSources) * 100 : 0;
                
                // BEP Calc & Data
                const vcTotal = totalVar; 
                const revenueTotal = baseRev;
                const fcTotal = fixedCashTotal;
                const revPerBag = revenueTotal / data.targetBags;
                const vcPerBag = vcTotal / data.targetBags;
                const cmPerBag = revPerBag - vcPerBag; 
                const bepUnits = cmPerBag > 0 ? fcTotal / cmPerBag : 0;
                const bepSales = bepUnits * revPerBag;
                const bepData = [];
                [0, 0.5, 1.0, 1.5].forEach(s => {
                    const units = data.targetBags * s;
                    bepData.push({ units: units, revenue: units * revPerBag, totalCost: fcTotal + (units * vcPerBag), fixedCost: fcTotal });
                });
                if(bepUnits < data.targetBags * 1.5) bepData.push({ units: bepUnits, revenue: bepSales, totalCost: bepSales, fixedCost: fcTotal, isBep: true });
                bepData.sort((a,b) => a.units - b.units);

                const netMargin = (annualNetProfitAfterAll / cfTotal.rev) * 100;
                const grossMargin = ((riceRev - (riceTotal + packTotal + elecTotal + salaryTotal)) / riceRev) * 100;
                const debtService = annualPrincipalPaid + annualFinanceCost;
                const dscr = debtService > 0 ? annualOperatingCashProfit / debtService : (annualOperatingCashProfit > 0 ? 999 : 0);

                let paybackMonth = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô";
                const annualCashFlow = annualOperatingCashProfit - totalTaxEst - annualFinanceCost;
                if (annualCashFlow > 0) {
                      const monthsToPayback = totalSources / (annualCashFlow/12);
                      if (monthsToPayback <= 12) paybackMonth = `${Math.ceil(monthsToPayback)} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
                      else paybackMonth = `${(monthsToPayback/12).toFixed(1)} ‡∏õ‡∏µ`;
                }

                const vatBreakdown = {
                    vatableExp: vatableExpenses,
                    inputVat: totalVatIn,
                    outputVat: totalVatOut,
                    netVat: (totalVatOut - totalVatIn) 
                };

                const revBreakdown = {
                    sales: riceRev, byProduct: totalByProductIncome, logistics: logIncome,
                    totalIn: baseRev, vat: totalVatOut,
                    opCost: (totalVar - totalVatOut) + fixedCashTotal,
                    opVar: totalVar - totalVatOut,
                    opFixed: fixedCashTotal,
                    netCash: baseRev - totalVatOut - (totalVar - totalVatOut) - fixedCashTotal,
                    riceCost: riceTotal, packCost: packTotal, feesCost: platformTotal + mktTotal,
                    elecCost: elecTotal, salaryCost: salaryTotal, otherFixed: data.fixedParams.erp + data.fixedParams.campaign + data.fixedParams.other + maintenanceCostMonthly,
                    // Detailed breakdown for Other Fixed Cost
                    otherDetails: {
                        erp: data.fixedParams.erp,
                        campaign: data.fixedParams.campaign,
                        misc: data.fixedParams.other,
                        maintenance: maintenanceCostMonthly
                    }
                };

                return {
                    totalCapex, totalSources, workingCap, dayTarget, hourTarget, paddyTons,
                    annualDepreciation, depFactory: data.capex.factory / data.depreciation.factoryYears, depMachine: data.capex.machine / data.depreciation.machineYears,
                    totalByProductIncome, byProductsCalc, riceCostUnit, matCostUnit, grossRev: riceRev,
                    riceTotal, packTotal, elecTotal, platformTotal, mktTotal, totalVar,
                    salaryTotal, fixedCashTotal, logIncome, hrCosts,
                    ebitda: annualOperatingCashProfit, 
                    annualProfitEst: taxableIncome, annualTax: totalTaxEst, taxDetails, 
                    netProfit: annualNetProfitAfterAll, roi, paybackMonth, netMargin, grossMargin, dscr,
                    bepUnits, bepSales, fcTotal, vcPerBag, revPerBag, bepData,
                    cf: cfFinal, cfTotal, dividendTotal, revBreakdown, vatBreakdown,
                    section7Total, elecTotal, platformTotal, mktTotal,
                    dividendPerPersonYear, dividendPerPersonMonth,
                    annualFinanceCost, annualPrincipalPaid,
                    lowestCashBalance, 
                    funnelMetrics, // New export
                    yrProj: null 
                };
            };

            const sensitivityData = useMemo(() => {
                const results = [];
                const priceSteps = [0.9, 1.0, 1.1]; 
                const volumeSteps = [0.9, 1.0, 1.1]; 
                priceSteps.forEach(pStep => {
                    const row = [];
                    volumeSteps.forEach(vStep => {
                        const tData = JSON.parse(JSON.stringify(d));
                        tData.targetBags = Math.round(d.targetBags * vStep);
                        tData.paddyPrice = Math.round(d.paddyPrice * pStep);
                        const financials = calculateFinancials(tData);
                        row.push({ vLabel: `${(vStep*100-100).toFixed(0)}%`, pLabel: `${(pStep*100-100).toFixed(0)}%`, profit: financials.netProfit });
                    });
                    results.push(row);
                });
                return results;
            }, [d]);

            useEffect(() => { 
                const financials = calculateFinancials(d);
                setC(financials); 
            }, [d]);

            const projection = useMemo(() => {
                if(!c) return { data: [], npv: 0 }; 
                const yrProj = [];
                let yCash = c.cfTotal.cashFinal;
                const y1TaxPaid = (d.taxPaymentMode === 'annual' || d.taxPaymentMode === 'monthly') ? c.annualTax : 0;
                
                const y1ExpCash = c.cfTotal.expCash + y1TaxPaid + c.cfTotal.interest + c.cfTotal.principal;
                yCash -= c.dividendTotal;
                
                // Tax Shield Setup (Precise Audit)
                let accumulatedLoss = 0;
                if (c.annualProfitEst < 0) accumulatedLoss = Math.abs(c.annualProfitEst);

                yrProj.push({ y: 1, rev: c.cfTotal.rev, exp: y1ExpCash, ebitda: c.ebitda, dep: c.annualDepreciation, tax: c.annualTax, net: c.netProfit, div: c.dividendTotal, cash: yCash, taxSaving: 0 });

                let prevRev = c.cfTotal.rev;
                
                const totalExpY1 = c.cfTotal.expCash;
                const fixedComponentY1 = c.salaryTotal + (c.section7Total - c.elecTotal - c.platformTotal - c.mktTotal); 
                const varComponentY1 = totalExpY1 - fixedComponentY1;

                let prevVar = varComponentY1;
                let prevFixed = fixedComponentY1;

                let prevTaxLiability = d.taxPaymentMode === 'deferred' ? c.annualTax : 0;
                let remainingLoan = d.loan.amount - c.annualPrincipalPaid;

                let npv = -c.totalSources; 
                const discountRate = (d.discountRate || 10) / 100;

                // Helper for Tax Shield Calc
                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };

                for(let y=2;y<=5;y++) {
                    const growthRate = d.growth / 100;
                    const inflationRate = d.inflation / 100;
                    
                    const yRev = prevRev * (1 + growthRate);
                    
                    // NEW: Split Growth Logic
                    const yVar = prevVar * (1 + growthRate); 
                    const yFixed = prevFixed * (1 + inflationRate); 
                    const yExpExclTax = yVar + yFixed;

                    const yGrossMargin = yRev - yExpExclTax;
                    const yVatLiability = yGrossMargin * (7/107);
                    const yEbitda = yGrossMargin - yVatLiability; 

                    const annualPrincipal = c.annualPrincipalPaid;
                    remainingLoan = Math.max(0, remainingLoan - annualPrincipal);
                    const yInterest = remainingLoan * (d.loan.rate / 100); 
                    const yPrincipal = remainingLoan > 0 ? annualPrincipal : 0;
                    
                    const yTaxable = yEbitda - c.annualDepreciation - yInterest;
                    
                    // --- Precise Tax Shield Logic ---
                    let taxableAfterShield = yTaxable;
                    let usedLoss = 0;
                    
                    if (yTaxable > 0 && accumulatedLoss > 0) {
                        usedLoss = Math.min(yTaxable, accumulatedLoss);
                        taxableAfterShield = yTaxable - usedLoss;
                        accumulatedLoss -= usedLoss;
                    } else if (yTaxable < 0) {
                        accumulatedLoss += Math.abs(yTaxable);
                        taxableAfterShield = 0;
                    }

                    // Calculate real saving
                    const taxNormal = calcTax(yTaxable > 0 ? yTaxable : 0);
                    const taxShielded = calcTax(taxableAfterShield);
                    const taxSaving = taxNormal - taxShielded;
                    const yTax = taxShielded;

                    let taxPaidThisYear = d.taxPaymentMode === 'deferred' ? prevTaxLiability : yTax;
                    if (d.taxPaymentMode === 'deferred') prevTaxLiability = yTax;

                    const yNetAcc = yTaxable - yTax; 
                    const yDiv = yNetAcc > 0 ? yNetAcc * (d.dividend.payout / 100) : 0;
                    
                    yCash += (yEbitda - taxPaidThisYear - yDiv - yInterest - yPrincipal);
                    
                    yrProj.push({ y, rev: yRev, exp: yExpExclTax + taxPaidThisYear + yInterest + yPrincipal, ebitda: yEbitda, dep: c.annualDepreciation, tax: yTax, net: yNetAcc, div: yDiv, cash: yCash, taxSaving });
                    prevRev = yRev;
                    prevVar = yVar;
                    prevFixed = yFixed;
                }
                
                yrProj.forEach((yr) => {
                      const cashFlow = yr.ebitda - yr.tax;
                      npv += cashFlow / Math.pow(1 + discountRate, yr.y);
                });

                return { data: yrProj, npv };
            }, [c, d.growth, d.inflation, d.dividend.payout, d.taxPaymentMode, d.discountRate, d.loan.amount, d.loan.rate, d.loan.term]);

            if(c && projection.data.length > 0) {
                c.yrProj = projection;
            }

            if(!c) return <div className="p-10 text-center text-slate-500">Loading System...</div>;

            const costData = [
                { name: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£', value: c.revBreakdown.riceCost }, { name: '‡∏ö‡∏£‡∏£‡∏à‡∏∏', value: c.revBreakdown.packCost },
                { name: '‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î', value: c.mktTotal }, { name: 'Platform', value: c.platformTotal },
                { name: '‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü', value: c.elecTotal }, { name: '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', value: c.salaryTotal },
                { name: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', value: c.revBreakdown.otherFixed + c.annualFinanceCost },
            ];
            const revenueData = [ { name: '‡∏Ç‡πâ‡∏≤‡∏ß', value: c.grossRev }, { name: '‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢', value: c.totalByProductIncome }, { name: '‡∏Ç‡∏ô‡∏™‡πà‡∏á', value: c.logIncome } ];
            
            const getHeatmapColor = (profit) => {
                if (profit < 0) return 'bg-red-100 text-red-700';
                if (profit < c.netProfit * 0.5) return 'bg-orange-100 text-orange-700';
                if (profit < c.netProfit * 0.8) return 'bg-yellow-100 text-yellow-700';
                return 'bg-green-100 text-green-700';
            };

            return (
                <div className="app-container font-sans text-slate-800">
                    <header className="header-bar sticky top-0 z-50 flex flex-col md:flex-row justify-between items-center gap-4">
                        <div>
                            <h1 className="text-xl font-bold tracking-tight">Thai Fortunate Innovation</h1>
                            <p className="text-xs text-slate-400">Financial Strategy Simulator (Ultimate VAT Fixed)</p>
                        </div>
                        <div className="flex items-center gap-2 header-controls">
                            <span className="text-xs text-slate-400 font-bold mr-1">SCENARIO:</span>
                            <button onClick={()=>applyScenario('worst')} className={`scenario-btn ${d.scenario==='worst'?'bg-red-100 text-red-700 active ring-2 ring-red-500':'bg-slate-700 text-slate-300'}`}>Worst</button>
                            <button onClick={()=>applyScenario('base')} className={`scenario-btn ${d.scenario==='base'?'bg-blue-100 text-blue-700 active ring-2 ring-blue-500':'bg-slate-700 text-slate-300'}`}>Base</button>
                            <button onClick={()=>applyScenario('best')} className={`scenario-btn ${d.scenario==='best'?'bg-green-100 text-green-700 active ring-2 ring-green-500':'bg-slate-700 text-slate-300'}`}>Best</button>
                            <button onClick={resetToDefault} className="scenario-btn bg-slate-600 text-slate-200 ml-2 hover:bg-slate-500">Reset</button>
                            <button onClick={handleShare} className="scenario-btn bg-purple-600 text-white ml-2 hover:bg-purple-500 flex items-center gap-1"><span>üîó</span> Share</button>
                            <button onClick={handleExport} className="scenario-btn bg-emerald-600 text-white ml-2 hover:bg-emerald-500 flex items-center gap-1"><span>üì•</span> CSV</button>
                            <button onClick={handlePrint} className="scenario-btn bg-white text-slate-800 ml-2 hover:bg-slate-100 flex items-center gap-1 font-bold border border-slate-300"><span>üñ®Ô∏è</span> Print</button>
                        </div>
                    </header>

                    {toast && (
                        <div className="fixed top-20 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-[100] animate-bounce">
                            {toast}
                        </div>
                    )}

                    <main className="p-4 max-w-[1600px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
                        
                        {/* --- LEFT: Production & Cost --- */}
                        <div className="lg:col-span-3 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">1. Production & Cost</h2>
                            <div className="card">
                                <div className="card-header"><div className="card-title">‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô & ‡πÅ‡∏´‡∏•‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô (CAPEX)</div><div className="text-red-500 font-bold text-sm">{fmt(c.totalCapex)}</div></div>
                                <div className="card-body">
                                    <div className="input-group"><label className="input-label">‡∏ó‡∏∏‡∏ô‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Equity)</label><input type="number" className="input-field border-blue-200 bg-blue-50 text-blue-800" value={d.regCapital} onChange={e=>up('regCapital',null,e.target.value)} /></div>
                                    <div className="p-2 border border-dashed rounded mb-3 bg-yellow-50/50"><div className="text-xs font-bold text-slate-500 mb-1">üè¶ ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Bank Loan)</div><div className="flex gap-2 mb-1"><div className="flex-1"><label className="text-[10px]">‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ</label><input type="number" className="input-field" value={d.loan.amount} onChange={e=>up('loan','amount',e.target.value)}/></div><div className="w-16"><label className="text-[10px]">‡∏î‡∏ö.%</label><input type="number" className="input-field text-center" value={d.loan.rate} onChange={e=>up('loan','rate',e.target.value)}/></div></div><div className="flex gap-2"><div className="flex-1 text-[10px] text-slate-400 pt-1">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ {d.loan.term} ‡∏õ‡∏µ</div><div className="text-[10px] text-red-400 font-bold pt-1">‡∏î‡∏ö. {fmt(c.annualFinanceCost)}/‡∏õ‡∏µ (‡∏•‡∏î‡∏ï‡πâ‡∏ô)</div></div></div>
                                    <div className="grid grid-cols-2 gap-2 mb-2"><div><label className="input-label">‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</label><input type="number" className="input-field" value={d.capex.factory} onChange={e=>up('capex','factory',e.target.value)}/></div><div><label className="input-label">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£</label><input type="number" className="input-field" value={d.capex.machine} onChange={e=>up('capex','machine',e.target.value)}/></div></div>
                                    <div className="input-group"><label className="input-label">‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï</label><input type="number" className="input-field" value={d.capex.license} onChange={e=>up('capex','license',e.target.value)} /></div>
                                    <div className="input-group bg-orange-50 p-2 rounded border border-orange-100"><label className="input-label text-orange-800 font-bold">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏Ç‡πâ‡∏≤‡∏ß‡∏•‡πá‡∏≠‡∏ï‡πÅ‡∏£‡∏Å</label><input type="number" className="input-field bg-white text-orange-700 font-bold" value={d.capex.stock} onChange={e=>up('capex','stock',e.target.value)} /></div>
                                    <div className="flex justify-between text-xs text-green-600 mt-2 bg-green-50 p-2 rounded"><span>Working Cap ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span><span className="font-bold">{fmt(c.workingCap)}</span></div>
                                </div>
                            </div>
                            <div className="card"><div className="card-header"><div className="card-title">‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï (Yield)</div></div><div className="card-body"><div className="input-group mb-4"><label className="input-label flex justify-between"><span>Yield ‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£</span><span className="font-bold text-blue-600">{d.yield}%</span></label><input type="range" className="w-full" min="40" max="70" value={d.yield} onChange={handleYieldChange}/></div><div className="input-group"><label className="input-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å (‡∏ö‡∏≤‡∏ó/‡∏ï‡∏±‡∏ô)</label><input type="number" className="input-field" value={d.paddyPrice} onChange={e=>up('paddyPrice',null,e.target.value)}/></div><div className="text-xs text-slate-500 mt-2 text-right">‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å: <b>{fmtDec(c.paddyTons)}</b> ‡∏ï‡∏±‡∏ô</div><div className="text-xs text-right text-orange-600 font-bold">‡πÉ‡∏ä‡πâ‡∏á‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡πâ‡∏≤‡∏ß: {fmt(c.riceTotal)} ‡∏ö‡∏≤‡∏ó</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á</div><div className="text-red-600 font-bold">{fmtDec(c.matCostUnit)}</div></div><div className="card-body"><div className="grid grid-cols-3 gap-2 text-center text-xs mb-2"><div className="bg-slate-100 p-1 rounded"><div>‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£</div><b>{fmtDec(c.riceCostUnit)}</b><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(c.riceTotal)} ‡∏ö./‡∏î</div></div><div className="bg-slate-100 p-1 rounded"><div>‡∏ñ‡∏∏‡∏á</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.bag} onChange={e=>up('unit','bag',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.bag * d.targetBags)} ‡∏ö./‡∏î</div></div><div className="bg-slate-100 p-1 rounded"><div>‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.sticker} onChange={e=>up('unit','sticker',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.sticker * d.targetBags)} ‡∏ö./‡∏î</div></div></div><div className="text-xs text-right text-red-600 font-bold border-t border-slate-100 pt-2">‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: {fmt(c.riceTotal + c.packTotal)} ‡∏ö‡∏≤‡∏ó</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div><div className="text-blue-600 font-bold text-sm">{fmt(c.salaryTotal)}</div></div><div className="card-body"><table className="w-full hr-table"><thead><tr><th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th className="w-10 text-center">‡∏Ñ‡∏ô</th><th className="w-20 text-right">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th><th className="w-16 text-right text-xs text-slate-500">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°<br/>(5%)</th><th className="w-20 text-right font-bold">‡∏£‡∏ß‡∏°</th></tr></thead><tbody>{c.hrCosts.map((h,i)=>(<tr key={i}><td>{h.role}</td><td><input type="number" className="hr-input text-center" value={h.count} onChange={e=>upArr('hr',i,'count',e.target.value)}/></td><td><input type="number" className="hr-input" value={h.salary} onChange={e=>upArr('hr',i,'salary',e.target.value)}/></td><td className="text-right text-xs text-slate-500">{fmt(h.ssoTotalRole)}</td><td className="text-right font-bold text-slate-700">{fmt(h.totalPerRole)}</td></tr>))}</tbody></table></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Expenses)</div><div className="text-red-500 font-bold text-sm">{fmt(c.section7Total)}</div></div><div className="card-body space-y-3">
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">Variable Cost Parameters</div>
                                    <div className="input-row"><span className="text-sm">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü ({d.varParams.elecRate} ‡∏ö./‡∏ï‡∏±‡∏ô)</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.elecRate} onChange={e=>up('varParams','elecRate',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.elecTotal)}</span></div></div>
                                    <div className="input-row"><span className="text-sm">Platform (%)</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.platformPercent} onChange={e=>up('varParams','platformPercent',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.platformTotal)}</span></div></div>
                                    <div className="input-row"><span className="text-sm">Marketing (%)</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.mktPercent} onChange={e=>up('varParams','mktPercent',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.mktTotal)}</span></div></div>
                                </div>
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">Fixed Cost (Other)</div>
                                    <div className="input-row"><span className="text-sm">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (%)</span><input type="number" className="input-field w-24" value={d.fixedParams.maintPercent} onChange={e=>up('fixedParams','maintPercent',e.target.value)} placeholder="% Machine"/></div>
                                    <div className="input-row"><span className="text-sm">ERP Software</span><input type="number" className="input-field w-24" value={d.fixedParams.erp} onChange={e=>up('fixedParams','erp',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Misc)</span><input type="number" className="input-field w-24" value={d.fixedParams.other} onChange={e=>up('fixedParams','other',e.target.value)}/></div>
                                    <div className="input-row bg-yellow-50 p-1 rounded border border-yellow-100"><span className="text-sm font-bold text-yellow-800">‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á‡∏Ø</span><div className="font-bold text-yellow-700">{fmt(d.fixedParams.campaign)}</div></div>
                                </div>
                                
                                {/* Campaign Details Breakdown */}
                                <div className="mt-2 border-t border-slate-200 pt-2">
                                    <div className="text-[10px] font-bold text-slate-400 mb-1">üèÜ Campaign Gold Breakdown</div>
                                    <table className="w-full text-[10px]">
                                        <thead>
                                            <tr className="bg-yellow-50 text-yellow-800">
                                                <th className="text-left p-1 rounded-l">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                                <th className="text-center p-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                                <th className="text-right p-1">‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                                <th className="text-right p-1 rounded-r">‡∏£‡∏ß‡∏°</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {d.campaignDetails.map((item, i) => (
                                                <tr key={i} className="border-b border-slate-100">
                                                    <td className="p-1"><input className="w-full bg-transparent outline-none focus:text-blue-600" value={item.name} onChange={e=>upCampaign(i,'name',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-8 text-center bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.qty} onChange={e=>upCampaign(i,'qty',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-12 text-right bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.costPerUnit} onChange={e=>upCampaign(i,'costPerUnit',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-medium text-slate-600">{fmt(item.qty * item.costPerUnit)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div></div>
                        </div>

                        {/* --- CENTER: Strategy & Dashboard --- */}
                        <div className="lg:col-span-5 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">2. Strategy & Performance</h2>
                            
                            <div className="bg-slate-800 rounded-xl p-4 text-white shadow-lg mb-4">
                                <div className="flex justify-between items-start mb-4">
                                    <h3 className="font-bold text-lg flex items-center gap-2"><span className="text-yellow-400">‚òÖ</span> Executive Summary</h3>
                                    <div className="text-right">
                                        <div className="text-xs text-slate-400">Net Profit (Year 1)</div>
                                        <div className={`text-2xl font-bold ${c.netProfit>0?'text-green-400':'text-red-400'}`}>{fmt(c.netProfit)} ‡∏ø</div>
                                    </div>
                                </div>
                                <div className="grid grid-cols-4 gap-2 text-center">
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">Net Margin</div>
                                        <div className="font-bold text-md text-green-300">{c.netMargin.toFixed(1)}%</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">Gross Margin</div>
                                        <div className="font-bold text-md text-blue-300">{c.grossMargin.toFixed(1)}%</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">DSCR</div>
                                        <div className={`font-bold text-md ${c.dscr>=1.25?'text-green-300':c.dscr>=1?'text-yellow-300':'text-red-400'}`}>{c.dscr.toFixed(2)}</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">ROI</div>
                                        <div className="font-bold text-md text-yellow-300">{fmtDec(c.roi)}%</div>
                                    </div>
                                </div>
                                <div className="mt-2 text-center text-xs text-slate-400">
                                    ‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô: <span className="text-white font-bold">{c.paybackMonth}</span> | 
                                    BEP: <span className="text-white font-bold">{fmt(c.bepUnits)}</span> ‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                                </div>
                            </div>

                            <div className="card border-blue-200">
                                <div className="card-header bg-blue-50/50"><div className="card-title text-blue-800">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ & ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</label><input type="number" className="input-field text-lg font-bold text-blue-700 border-blue-300" value={d.targetBags} onChange={e=>up('targetBags',null,e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó/‡∏ñ‡∏∏‡∏á)</label><input type="number" className="input-field text-lg" value={d.price} onChange={e=>up('price',null,e.target.value)}/></div>
                                    </div>
                                    <div className="input-group bg-yellow-50 p-2 rounded border border-yellow-200"><label className="input-label text-yellow-800 font-bold">Credit Term (‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏ô‡∏µ‡πâ)</label><select className="input-field bg-white text-yellow-900" value={d.creditTerm} onChange={e=>up('creditTerm',null,e.target.value)}><option value="0">‡∏Ç‡∏≤‡∏¢‡∏™‡∏î (0 ‡∏ß‡∏±‡∏ô)</option><option value="15">TikTok Shop (15 ‡∏ß‡∏±‡∏ô)</option><option value="20">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï 20 ‡∏ß‡∏±‡∏ô</option><option value="30">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï 30 ‡∏ß‡∏±‡∏ô</option><option value="60">‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï 60 ‡∏ß‡∏±‡∏ô</option></select><div className="text-[10px] text-yellow-600 mt-1">*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ô‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡πâ‡∏≤‡∏•‡∏á</div></div>
                                    <div className="flex justify-between bg-slate-50 p-3 rounded mt-2 border border-slate-100">
                                        <div className="text-center"><div className="text-xs text-slate-500">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div><div className="font-bold text-slate-700">{fmt(c.grossRev)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</div><div className="font-bold text-slate-700">{fmt(c.dayTarget)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠ ‡∏ä‡∏°. (8h)</div><div className="font-bold text-slate-700">{fmtDec(c.hourTarget)}</div></div>
                                    </div>
                                </div>
                            </div>

                            <div className="card border-orange-200">
                                <div className="card-header bg-orange-50"><div className="card-title text-orange-800">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ (By-products)</div></div>
                                <div className="card-body p-2">
                                    <table className="w-full text-xs">
                                        <thead><tr className="border-b border-orange-100 text-orange-600"><th className="p-1 text-left">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th className="p-1 text-center">%</th><th className="p-1 text-right">‡∏ï‡∏±‡∏ô</th><th className="p-1 text-right">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ï‡∏±‡∏ô</th><th className="p-1 text-right">‡∏£‡∏ß‡∏° (‡∏ö.)</th></tr></thead>
                                        <tbody>
                                            {c.byProductsCalc.map((item, i) => (
                                                <tr key={i} className="border-b border-dashed border-slate-100 hover:bg-orange-50/30">
                                                    <td className="p-1">{item.name}</td>
                                                    <td className="p-1 text-center text-slate-400">
                                                        <input type="number" className="input-field text-xs p-1 h-6 w-full text-center" value={item.percent} onChange={e=>upArr('byProducts',i,'percent',e.target.value)}/>
                                                    </td>
                                                    <td className="p-1 text-right font-medium">{fmtDec(item.weight)}</td>
                                                    <td className="p-1"><input type="number" className="input-field text-xs p-1 h-6 w-full text-right" value={item.price} onChange={e=>upArr('byProducts',i,'price',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-bold text-orange-700">{fmt(item.revenue)}</td>
                                                </tr>
                                            ))}
                                            <tr className="bg-orange-50 font-bold border-t border-orange-200"><td colSpan="4" className="p-2 text-right text-orange-800">‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</td><td className="p-2 text-right text-orange-800">{fmt(c.totalByProductIncome)}</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ Drop-off (J&T Home)</div></div>
                                <div className="card-body p-3">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏á (%)</label><input type="number" className="input-field" value={d.logistics.percent} onChange={e=>up('logistics','percent',e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">‡∏Ñ‡πà‡∏≤ Drop-off/‡∏ä‡∏¥‡πâ‡∏ô</label><input type="number" className="input-field" value={d.logistics.profit} onChange={e=>up('logistics','profit',e.target.value)}/></div>
                                    </div>
                                    <div className="text-right text-sm text-green-600 font-bold mt-2 border-t pt-2">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°: +{fmt(c.logIncome)} ‡∏ö./‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                                </div>
                            </div>

                            {/* NEW: VAT Refund Section */}
                            <div className="card border-blue-100">
                                <div className="card-header bg-blue-50"><div className="card-title text-blue-800">‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠ (VAT Refund Est.)</div></div>
                                <div className="card-body p-3 text-xs">
                                    <div className="flex justify-between mb-1 text-slate-500"><span>‡∏ê‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (Vatable Expenses)</span><span>{fmt(c.vatBreakdown.vatableExp)}</span></div>
                                    <div className="text-[10px] text-slate-400 pl-2 mb-2">- ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á, ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á, ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü, Platform, Ads ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
                                    <div className="flex justify-between border-t border-dashed pt-2">
                                        <span>Output VAT (‡∏Ç‡∏≤‡∏¢)</span>
                                        <span className="text-red-500 font-bold">{fmt(c.vatBreakdown.outputVat)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Input VAT (‡∏ã‡∏∑‡πâ‡∏≠)</span>
                                        <span className="text-green-500 font-bold">-{fmt(c.vatBreakdown.inputVat)}</span>
                                    </div>
                                    <div className={`flex justify-between mt-2 pt-2 border-t font-bold text-sm ${c.vatBreakdown.netVat > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                        <span>{c.vatBreakdown.netVat > 0 ? '‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° (Pay)' : '‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ (Refund)'}</span>
                                        <span>{fmt(Math.abs(c.vatBreakdown.netVat))}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-indigo-700">Monthly Revenue & Cost Breakdown</div></div>
                                <div className="card-body">
                                    <div className="flow-row"><span className="text-indigo-600 font-bold">1. Cash Inflow</span><span>{fmt(c.revBreakdown.totalIn)}</span></div>
                                    <div className="flow-row flow-sub"><span>- Sales (Gross)</span><span>{fmt(c.revBreakdown.sales)}</span></div>
                                    <div className="flow-row flow-sub"><span>- By-products</span><span>{fmt(c.revBreakdown.byProduct)}</span></div>
                                    <div className="flow-row flow-sub"><span>- Logistics</span><span>{fmt(c.revBreakdown.logistics)}</span></div>
                                    <div className="flow-row mt-2"><span className="text-red-600 font-bold">2. VAT Obligation</span><span>-{fmt(c.revBreakdown.vat)}</span></div>
                                    <div className="flow-row flow-sub text-xs"><span>* VAT ‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° (‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö VAT)</span></div>
                                    <div className="flow-row mt-2"><span className="text-orange-600 font-bold">3. Operational Outflow</span><span>-{fmt(c.revBreakdown.opCost)}</span></div>
                                    <div className="flow-row flow-sub font-bold text-slate-600">Variable (excl. VAT)<span>{fmt(c.revBreakdown.opVar)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Rice: {fmt(c.revBreakdown.riceCost)} | Pack: {fmt(c.revBreakdown.packCost)}<br/>- Fees: {fmt(c.revBreakdown.feesCost)} | Elec: {fmt(c.revBreakdown.elecCost)}</div>
                                    <div className="flow-row flow-sub font-bold text-slate-600 mt-1">Fixed Cost<span>{fmt(c.revBreakdown.opFixed)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Salary (Base+SSO): {fmt(c.revBreakdown.salaryCost)}</div>
                                    
                                    {/* Expanded Other Fixed Breakdown */}
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Other Fixed: {fmt(c.revBreakdown.otherFixed)}</div>
                                    <div className="bg-slate-50 rounded p-2 ml-6 my-1 border border-slate-100">
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Campaign:</span><span>{fmt(c.revBreakdown.otherDetails.campaign)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ ERP:</span><span>{fmt(c.revBreakdown.otherDetails.erp)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Misc:</span><span>{fmt(c.revBreakdown.otherDetails.misc)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Maintenance:</span><span>{fmt(c.revBreakdown.otherDetails.maintenance)}</span></div>
                                    </div>

                                    <div className="flow-row total text-lg bg-green-50 p-2 rounded mt-2"><span className="text-green-700">Net Cash (EBITDA)</span><span className="text-green-700">{fmt(c.revBreakdown.netCash)}</span></div>
                                </div>
                            </div>
                        </div>

                        {/* --- RIGHT: Analysis --- */}
                        <div className="lg:col-span-4 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">3. Financial Outlook</h2>
                            
                            <div className="card print-btn-hide">
                                <div className="card-header"><div className="card-title">Cumulative Cashflow</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <AreaChart data={c.cf}><CartesianGrid strokeDasharray="3 3" vertical={false} /><XAxis dataKey="m" tick={{fontSize: 10}} /><YAxis tick={{fontSize: 10}} tickFormatter={(val)=>`${val/1000000}M`} /><Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Month ${l}`} /><Area type="monotone" dataKey="cashFinal" stroke="#10b981" fill="#dcfce7" strokeWidth={2} /></AreaChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Break-even Chart - FIXED */}
                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô (Break-even Analysis)</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={c.bepData}>
                                            <CartesianGrid strokeDasharray="3 3" />
                                            <XAxis dataKey="units" type="number" tickFormatter={(val)=>`${val/1000}k`} label={{ value: 'Units (Bags)', position: 'insideBottom', offset: -5, fontSize: 10 }} />
                                            <YAxis tickFormatter={(val)=>`${val/1000}k`} tick={{fontSize: 10}} />
                                            <Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Units: ${fmt(l)}`} />
                                            <Line type="monotone" dataKey="revenue" stroke="#10b981" name="Revenue" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="totalCost" stroke="#ef4444" name="Total Cost" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="fixedCost" stroke="#94a3b8" name="Fixed Cost" strokeDasharray="5 5" dot={false} />
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Revenue Structure */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">Revenue Structure</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={revenueData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={5} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{revenueData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Cost Structure - Resized */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">Cost Structure</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={costData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={2} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{costData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Sensitivity Analysis with Heatmap */}
                            <div className="card mt-4">
                                <div className="card-header"><div className="card-title text-sm">‚ö†Ô∏è Sensitivity (Net Profit)</div></div>
                                <div className="card-body p-2">
                                    <div className="text-[10px] text-center mb-1 text-slate-400">‡πÅ‡∏Å‡∏ô‡∏ï‡∏±‡πâ‡∏á: ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö | ‡πÅ‡∏Å‡∏ô‡∏ô‡∏≠‡∏ô: ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</div>
                                    <table className="w-full matrix-table">
                                        <thead>
                                            <tr>
                                                <th className="bg-slate-100">Price \ Vol</th>
                                                <th className="matrix-header">-10%</th>
                                                <th className="matrix-header">Base</th>
                                                <th className="matrix-header">+10%</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {sensitivityData.map((row, rI) => (
                                                <tr key={rI}>
                                                    <td className="matrix-header">{row[0].pLabel}</td>
                                                    {row.map((cell, cI) => (
                                                        <td key={cI} className={`font-bold ${getHeatmapColor(cell.profit)}`}>{fmt(cell.profit/1000)}k</td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Marketing Funnel & Budget Allocation */}
                            <div className="card mt-4 border-indigo-200">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800">TikTok Shop Ads Planning (GMV Max)</div></div>
                                <div className="card-body p-3">
                                    {/* Top Row: Budget & ROAS (The most important for GMV Max) */}
                                    <div className="grid grid-cols-3 gap-4 mb-4 border-b border-indigo-100 pb-3">
                                        <div className="text-center">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">Total Budget</div>
                                            <div className="text-lg font-bold text-indigo-700">{fmt(c.funnelMetrics.budget)}</div>
                                            <div className="text-[9px] text-slate-400">‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Marketing %</div>
                                        </div>
                                        <div className="text-center bg-indigo-50 rounded border border-indigo-100 p-1">
                                            <div className="text-[10px] text-indigo-800 uppercase font-bold">Target ROAS</div>
                                            <div className="text-2xl font-bold text-indigo-600">{c.funnelMetrics.roas.toFixed(2)}x</div>
                                            <div className="text-[9px] text-indigo-400">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Minimum ROAS</div>
                                        </div>
                                         <div className="text-center">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">ACOS</div>
                                            <div className="text-lg font-bold text-slate-600">{c.funnelMetrics.acos.toFixed(1)}%</div>
                                            <div className="text-[9px] text-slate-400">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î/GMV</div>
                                        </div>
                                    </div>

                                    {/* Middle Row: Manual Bidding Reference (CPA/CPC) */}
                                    <div className="grid grid-cols-2 gap-4 mb-3">
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">Max CPA (Cost/Order)</div>
                                            <div className="text-xl font-bold text-pink-600">{fmt(c.funnelMetrics.cpa)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô)</div>
                                        </div>
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">Max CPC (Bid)</div>
                                            <div className="text-xl font-bold text-blue-600">{c.funnelMetrics.cpc.toFixed(2)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å (Standard Mode)</div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-slate-50 rounded p-2 border border-slate-200 space-y-2">
                                        <div className="text-xs font-bold text-slate-700 mb-1 border-b pb-1">Funnel Simulation Inputs</div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>Basket Size (‡∏ñ‡∏∏‡∏á/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.basketSize} onChange={e=>upFunnel('basketSize', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>Conversion Rate (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.cvr} onChange={e=>upFunnel('cvr', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>CTR (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.ctr} onChange={e=>upFunnel('ctr', e.target.value)} />
                                        </div>
                                    </div>

                                    <div className="mt-3 space-y-1">
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">1. Impressions Needed</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.impressions)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">2. Clicks (Traffic)</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.visitors)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs font-bold text-indigo-700 bg-indigo-50 p-1 rounded">
                                            <span>3. Orders (Target)</span>
                                            <span>{fmt(c.funnelMetrics.orders)}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        {/* --- BOTTOM --- */}
                        <div className="lg:col-span-12 space-y-6">
                             <div className="card">
                                <div className="card-header"><div className="card-title text-slate-700">Detailed Monthly Cashflow (Year 1)</div><div className="flex items-center gap-2 text-xs"><span className="text-slate-500">Monthly Growth:</span><input type="number" className="border border-slate-300 rounded px-2 py-1 w-16 text-right" value={d.monthlyGrowth} onChange={e=>up('monthlyGrowth', null, e.target.value)} /><span className="text-slate-500">%</span><span className="ml-2 text-slate-400 font-bold bg-slate-100 px-2 py-1 rounded">Credit: {d.creditTerm} Days</span></div></div>
                                <div className="overflow-x-auto custom-scroll">
                                    <table className="w-full text-xs text-right border-collapse min-w-[800px]">
                                        <thead className="bg-slate-100 text-slate-600"><tr><th className="p-3 text-center">Month</th><th className="p-3 text-slate-400">Sales (Booking)</th><th className="p-3 text-blue-700 font-bold">Cash Inflow (Actual)</th><th className="p-3 text-red-500">Expenses (Cash)</th><th className="p-3 text-orange-500">Net VAT Paid</th><th className="p-3 text-blue-600">Op. Cash (EBITDA)</th><th className="p-3 font-bold text-green-700 bg-green-50">Cash Balance</th></tr></thead>
                                        <tbody>
                                            <tr className="bg-slate-50 border-b border-slate-200"><td className="p-3 text-center font-bold text-slate-500">0 (Start)</td><td className="p-3" colSpan="5"></td><td className="p-3 font-bold text-slate-700 bg-green-50/50">{fmt(c.workingCap)}</td></tr>
                                            {c.cf.map((row) => (<tr key={row.m} className={`border-b hover:bg-slate-50 ${row.cashFinal < 0 ? 'bg-red-50':''}`}><td className="p-3 text-center font-bold text-slate-400">{row.m}</td><td className="p-3 text-slate-400">{fmt(row.rev)}</td><td className="p-3 font-bold text-blue-700">{fmt(row.revCashIn)}</td><td className="p-3 text-red-400">{fmt(row.expCash)}</td><td className={`p-3 font-bold ${row.vatPaid > 0 ? 'text-orange-500' : 'text-green-500'}`}>{fmt(row.vatPaid)}</td><td className="p-3 font-bold text-blue-600">{fmt(row.netOpCash)}</td><td className={`p-3 font-bold ${row.cashFinal < 0 ? 'text-red-600':'text-green-700 bg-green-50/30'}`}>{fmt(row.cashFinal)}</td></tr>))}
                                            <tr className="bg-slate-200 font-bold border-t-2 border-slate-400 text-slate-800"><td className="p-3 text-center">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ (Total)</td><td className="p-3 text-slate-600">{fmt(c.cfTotal.rev)}</td><td className="p-3 text-blue-800">{fmt(c.cfTotal.revCashIn)}</td><td className="p-3 text-red-600">{fmt(c.cfTotal.expCash)}</td><td className="p-3 text-orange-600">{fmt(c.cfTotal.vatPaid)}</td><td className="p-3 text-blue-800">{fmt(c.cfTotal.netOpCash)}</td><td className="p-3 bg-green-100 text-green-900">{fmt(c.cfTotal.cashFinal)}</td></tr>
                                        </tbody>
                                    </table>
                                    <div className="mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                                            <div className="p-3 bg-slate-100 rounded border"><div className="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Working Cap)</div><div className="font-bold text-slate-700">{fmt(c.workingCap)}</div></div>
                                            <div className={`p-3 rounded border ${c.lowestCashBalance < 0 ? 'bg-red-100 border-red-300' : 'bg-green-50 border-green-200'}`}><div className={`text-xs font-bold ${c.lowestCashBalance < 0 ? 'text-red-600' : 'text-green-600'}`}>‡∏à‡∏∏‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest)</div><div className={`font-bold ${c.lowestCashBalance < 0 ? 'text-red-700' : 'text-green-700'}`}>{fmt(c.lowestCashBalance)}</div></div>
                                            <div className="p-3 bg-blue-50 rounded border border-blue-100 text-red-500"><div className="text-xs text-red-500">‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô+‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</div><div className="font-bold">-{fmt(c.annualPrincipalPaid + c.annualFinanceCost)}</div></div>
                                            <div className="p-3 bg-red-50 rounded border border-red-100"><div className="text-xs text-red-500">‡∏´‡∏±‡∏Å‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ‡∏ô‡∏µ‡πâ (Cash Paid)</div><div className="font-bold text-red-700">-{fmt(c.cfTotal.tax)}</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-indigo-50 rounded border border-indigo-200 mt-2 md:mt-0"><div className="text-xs text-indigo-600">‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Net Profit)</div><div className="font-bold text-xl text-indigo-800">{fmt(c.netProfit)}</div><div className="text-[10px] text-indigo-400">(‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ - ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° - ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ - ‡∏†‡∏≤‡∏©‡∏µ)</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-green-50 rounded border border-green-200 mt-2 md:mt-0"><div className="text-xs text-green-600">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ (Cash Balance Year End)</div><div className={`font-bold text-xl ${c.cfTotal.cashFinal < 0 ? 'text-red-600':'text-green-800'}`}>{fmt(c.cfTotal.cashFinal)}</div><div className="text-[10px] text-green-500">(‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô + ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î - ‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á - ‡∏´‡∏ô‡∏µ‡πâ)</div></div>
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">Tax & Depreciation Details</div><div className="flex bg-slate-100 rounded text-[10px] overflow-hidden toggle-switch-container"><button className={`px-2 py-1 ${d.taxPaymentMode==='monthly'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'monthly')}>Monthly</button><button className={`px-2 py-1 ${d.taxPaymentMode==='annual'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'annual')}>Annual</button><button className={`px-2 py-1 ${d.taxPaymentMode==='deferred'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'deferred')}>Deferred</button></div></div>
                                <div className="card-body"><div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ (Depreciation Schedule)</h4><table className="w-full text-sm text-right"><thead className="bg-slate-50 text-slate-500"><tr><th className="text-left p-2">‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</th><th className="p-2">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</th><th className="p-2">‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)</th><th className="p-2">‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏õ‡∏µ</th></tr></thead><tbody><tr><td className="text-left p-2">‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</td><td className="p-2">{fmt(d.capex.factory)}</td><td className="p-2">{d.depreciation.factoryYears}</td><td className="p-2">{fmt(c.depFactory)}</td></tr><tr><td className="text-left p-2">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£</td><td className="p-2">{fmt(d.capex.machine)}</td><td className="p-2">{d.depreciation.machineYears}</td><td className="p-2">{fmt(c.depMachine)}</td></tr><tr className="font-bold border-t"><td className="text-left p-2">‡∏£‡∏ß‡∏°</td><td></td><td></td><td className="p-2 text-red-500">{fmt(c.annualDepreciation)}</td></tr></tbody></table></div>
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (Corporate Tax)</h4><div className="space-y-2 text-sm"><div className="flex justify-between"><span>‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (EBITDA)</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-red-500"><span>‡∏´‡∏±‡∏Å ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-red-500"><span>‡∏´‡∏±‡∏Å ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏à‡πà‡∏≤‡∏¢</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between font-bold text-blue-700 border-t pt-2"><span>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ (Taxable Income)</span><span>{fmt(c.annualProfitEst)}</span></div></div><div className="bg-slate-50 p-2 rounded text-xs mt-3"><table className="w-full text-right"><thead><tr className="text-slate-400"><th>Tier</th><th>Rate</th><th>Tax</th></tr></thead><tbody>{c.taxDetails.map((t,i)=>(<tr key={i}><td className="text-slate-600">{t.tier}</td><td>{t.rate}%</td><td className="font-medium">{fmt(t.amount)}</td></tr>))}<tr className="border-t font-bold text-red-600"><td colSpan="2" className="pt-1">Total Tax</td><td className="pt-1">{fmt(c.annualTax)}</td></tr></tbody></table></div></div></div></div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">Dividend Policy & Shareholder Return</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ (Policy Inputs)</h4><div className="input-group"><label className="input-label">Payout Ratio (%)</label><input className="input-field" value={d.dividend.payout} onChange={e=>up('dividend','payout',e.target.value)}/></div><div className="input-group"><label className="input-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (‡∏Ñ‡∏ô)</label><input className="input-field" value={d.dividend.founders} onChange={e=>up('dividend','founders',e.target.value)}/></div></div>
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Profit Breakdown)</h4><div className="flex justify-between text-xs text-slate-500"><span>EBITDA (Year)</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏à‡πà‡∏≤‡∏¢</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between text-xs text-red-400 border-b border-slate-200 pb-1"><span>- ‡∏†‡∏≤‡∏©‡∏µ (Tax Liability)</span><span>-{fmt(c.annualTax)}</span></div><div className="flex justify-between text-sm pt-1"><span className="font-bold text-slate-700">‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Profit)</span><span className="font-bold text-blue-600">{fmt(c.netProfit)}</span></div></div>
                                        <div className="bg-yellow-50 p-4 rounded border border-yellow-200 text-center flex flex-col justify-center"><h4 className="font-bold text-yellow-800 text-sm mb-2">‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (Per Shareholder)</h4><div className="text-xs text-slate-500 mb-1">‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏° (Total Pool)</div><div className="text-lg font-bold text-yellow-700 mb-2">{fmt(c.dividendTotal)} ‡∏ø</div><div className="border-t border-yellow-200 my-2"></div><div className="text-2xl font-bold text-yellow-700">{fmt(c.dividendPerPersonYear)} <span className="text-sm font-normal text-yellow-600">‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ</span></div><div className="text-sm text-yellow-600 mt-1">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ {fmt(c.dividendPerPersonMonth)} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div></div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Financial Health Check */}
                            <div className="card border-emerald-200">
                                <div className="card-header bg-emerald-50"><div className="card-title text-emerald-800">Financial Health Check (Year 1)</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">D/E Ratio</div>
                                            <div className={`text-lg font-bold ${d.loan.amount/d.regCapital > 2 ? 'text-red-500' : 'text-emerald-600'}`}>{(d.loan.amount/d.regCapital).toFixed(2)}x</div>
                                            <div className="text-[9px] text-slate-400">‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô (‡∏Ñ‡∏ß‡∏£ &lt; 2.0)</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">ROA</div>
                                            <div className="text-lg font-bold text-blue-600">{c.totalSources > 0 ? ((c.netProfit / c.totalSources)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">ROE</div>
                                            <div className="text-lg font-bold text-blue-600">{d.regCapital > 0 ? ((c.netProfit / d.regCapital)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">Asset Turnover</div>
                                            <div className="text-lg font-bold text-slate-600">{c.totalSources > 0 ? (c.grossRev / c.totalSources).toFixed(2) : 0}x</div>
                                            <div className="text-[9px] text-slate-400">‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏£‡∏≠‡∏ö/‡∏õ‡∏µ)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="card">
                                <div className="card-header"><div className="card-title">Detailed 5-Year Financial Projection (With Tax Shield & Split Growth)</div><div className="flex gap-4 text-xs items-center"><div className="flex items-center gap-1"><span>Growth:</span><input className="w-12 border rounded text-center" value={d.growth} onChange={e=>up('growth',null,e.target.value)}/>%</div><div className="flex items-center gap-1"><span>Inflation:</span><input className="w-12 border rounded text-center" value={d.inflation} onChange={e=>up('inflation',null,e.target.value)}/>%</div><div className="flex items-center gap-1 font-bold text-blue-600"><span>Discount Rate:</span><input className="w-12 border rounded text-center" value={d.discountRate} onChange={e=>up('discountRate',null,e.target.value)}/>%</div></div></div>
                                <div className="overflow-x-auto custom-scroll mb-2">
                                    <table className="w-full text-xs text-right border-collapse min-w-[800px]"><thead className="bg-indigo-900 text-white"><tr><th className="p-3 text-center">Year</th><th className="p-3">Revenue</th><th className="p-3 text-red-300">Op. Expense (Cash)</th><th className="p-3 font-bold text-yellow-300">EBITDA</th><th className="p-3 text-slate-300">Depreciation</th><th className="p-3 text-orange-300">Tax Expense</th><th className="p-3 font-bold text-blue-300 bg-indigo-800">Net Profit</th><th className="p-3 text-green-300">Dividend</th><th className="p-3 font-bold text-green-400 bg-indigo-950">Cash Balance (End)</th></tr></thead>
                                    <tbody>{projection.data.map((y,i) => (<tr key={i} className="border-b last:border-0 hover:bg-indigo-50"><td className="p-3 text-center font-bold text-indigo-900 bg-gray-50">{y.y}</td><td className="p-3 font-medium">{fmt(y.rev)}</td><td className="p-3 text-red-600">{fmt(y.exp)}</td><td className="p-3 font-bold text-yellow-700 bg-yellow-50">{fmt(y.ebitda)}</td><td className="p-3 text-slate-500">{fmt(y.dep)}</td><td className="p-3 text-orange-600">{fmt(y.tax)}{y.taxSaving > 0 && <div className="text-[9px] text-green-500">(Save {fmt(y.taxSaving)})</div>}</td><td className="p-3 font-bold text-blue-700 bg-blue-50">{fmt(y.net)}</td><td className="p-3 text-green-700">{fmt(y.div)}</td><td className="p-3 font-bold text-green-800 bg-green-100">{fmt(y.cash)}</td></tr>))}</tbody></table>
                                </div>
                                <div className="p-3 bg-blue-50 border-t flex justify-between items-center">
                                    <div className="text-xs text-slate-500">Net Present Value (NPV) ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ 5 ‡∏õ‡∏µ ‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å</div>
                                    <div className={`text-xl font-bold ${projection.npv > 0 ? 'text-green-600' : 'text-red-600'}`}>NPV: {fmt(projection.npv)}</div>
                                </div>
                            </div>

                            {/* NEW: AI Analysis & Recommendation Section */}
                            <div className="card mt-6 border-slate-300 shadow-md">
                                <div className="card-header bg-slate-800 text-white"><div className="card-title text-white">ü§ñ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå & ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (AI Analysis)</div></div>
                                <div className="card-body space-y-4">
                                    
                                    {/* 1. NPV Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${projection.npv > 0 ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{projection.npv > 0 ? '‚úÖ' : '‚ùå'}</span> 
                                            ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (NPV) = {fmt(projection.npv)} ‡∏ö‡∏≤‡∏ó
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:</strong> {projection.npv > 0 
                                                ? "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ '‡∏ä‡∏ô‡∏∞' ‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á" 
                                                : "‡∏ô‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡πà‡∏ß‡∏á! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß '‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°' ‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏û‡πâ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠"}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: {projection.npv > 0 
                                                ? "‡∏•‡∏∏‡∏¢‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢! ‡πÅ‡∏ú‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ô‡∏µ‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ Re-invest ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°" 
                                                : "‡∏´‡∏¢‡∏∏‡∏î‡∏Ñ‡∏¥‡∏î‡∏Å‡πà‡∏≠‡∏ô! ‡∏•‡∏≠‡∏á‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (CAPEX) ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢/‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤ NPV ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å"}
                                        </div>
                                    </div>

                                    {/* 2. ROAS Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${c.funnelMetrics.roas >= 5 ? 'bg-blue-50 border-blue-500' : (c.funnelMetrics.roas >= 3 ? 'bg-yellow-50 border-yellow-500' : 'bg-orange-50 border-orange-500')}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{c.funnelMetrics.roas >= 5 ? 'üöÄ' : (c.funnelMetrics.roas >= 3 ? '‚ö†Ô∏è' : 'üî•')}</span>
                                            ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (ROAS) = {c.funnelMetrics.roas.toFixed(2)}‡πÄ‡∏ó‡πà‡∏≤
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:</strong> {c.funnelMetrics.roas >= 5 
                                                ? "‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ñ‡∏π‡∏Å‡∏°‡∏≤‡∏Å! ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ö‡∏≤‡∏ó ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ü‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô" 
                                                : (c.funnelMetrics.roas >= 3 
                                                    ? "‡∏û‡∏≠‡πÑ‡∏õ‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏∂‡∏á! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏õ‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£ ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏°‡∏á‡∏ö‡∏î‡∏µ‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ ROAS ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ" 
                                                    : "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏û‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏ô‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠")}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: {c.funnelMetrics.roas >= 5 
                                                ? "Scale Up! ‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ï‡∏£‡∏≤‡∏ö‡πÉ‡∏î‡∏ó‡∏µ‡πà ROAS ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≠‡∏ö‡πÇ‡∏Å‡∏¢‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" 
                                                : (c.funnelMetrics.roas >= 3 
                                                    ? "Optimize! ‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏î‡∏π‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° Basket Size ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á ROAS ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô" 
                                                    : "Stop & Fix! ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏£‡∏µ‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡∏•‡∏¥‡∏õ/‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô ‡∏ñ‡πâ‡∏≤‡∏ù‡∏∑‡∏ô‡∏¢‡∏¥‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏∞‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô")}
                                        </div>
                                    </div>

                                    {/* 3. Cash Flow Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${c.lowestCashBalance >= 0 ? 'bg-emerald-50 border-emerald-500' : 'bg-red-50 border-red-500'}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{c.lowestCashBalance >= 0 ? 'üí∞' : 'üí∏'}</span>
                                            ‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (Cash Flow)
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô:</strong> {c.lowestCashBalance >= 0 
                                                ? `‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢! ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${fmt(c.lowestCashBalance)} ‡∏ö‡∏≤‡∏ó ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡∏ô` 
                                                : `‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠! ‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${fmt(c.lowestCashBalance)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å`}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: {c.lowestCashBalance >= 0 
                                                ? "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏≠‡∏≤‡∏à‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏õ‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢" 
                                                : "‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πà‡∏ß‡∏ô! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Ç‡∏≠‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏ó‡∏≠‡∏°‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏•‡∏á)"}
                                        </div>
                                    </div>

                                    {/* --- NEW: Financial Deep Dive (Grid) --- */}
                                    <div className="mt-6 pt-4 border-t border-slate-200">
                                        <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">üìä ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Deep Dive)</h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                            
                                            {/* EBITDA */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>EBITDA (‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î)</span><span className={c.ebitda > 0 ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.ebitda)}</span></div>
                                                <div className="text-[10px] text-slate-600">{c.ebitda > 0 ? "‚úÖ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏õ‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡∏†‡∏≤‡∏©‡∏µ" : "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏µ‡∏ö‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢"}</div>
                                            </div>

                                            {/* DSCR */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>DSCR (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ)</span><span className={c.dscr >= 1.25 ? 'text-green-500 font-bold' : 'text-orange-500 font-bold'}>{c.dscr.toFixed(2)}x</span></div>
                                                <div className="text-[10px] text-slate-600">{c.dscr >= 1.25 ? "‚úÖ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏£‡∏±‡∏Å! ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏ö‡∏≤‡∏¢‡πÜ" : (c.dscr >= 1 ? "‚ö†Ô∏è ‡∏û‡∏≠‡∏ñ‡∏π‡πÑ‡∏ñ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏∏‡∏î ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏ö‡∏á‡∏Å‡πå" : "‚ùå ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î")}</div>
                                            </div>

                                            {/* D/E Ratio */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>D/E Ratio (‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô)</span><span className={(d.loan.amount/d.regCapital) <= 2 ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{(d.loan.amount/d.regCapital).toFixed(2)}x</span></div>
                                                <div className="text-[10px] text-slate-600">{(d.loan.amount/d.regCapital) <= 2 ? "‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏Å‡∏π‡πâ‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ï‡∏±‡∏ß" : "‚ùå ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á! ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏ö‡∏Å‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ"}</div>
                                            </div>

                                            {/* BEP */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>BEP (‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô)</span><span className={d.targetBags >= c.bepUnits ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.bepUnits)} ‡∏ñ‡∏∏‡∏á</span></div>
                                                <div className="text-[10px] text-slate-600">{d.targetBags >= c.bepUnits ? `‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô‡∏°‡∏≤ ${fmt(d.targetBags - c.bepUnits)} ‡∏ñ‡∏∏‡∏á` : "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô! ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô"}</div>
                                            </div>

                                            {/* ROE/ROA */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>ROE (‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á)</span><span className="text-blue-500 font-bold">{fmtDec(c.roi)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.roi > 15 ? "‚úÖ ‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏°‡∏≤‡∏Å! ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏∏‡πâ‡∏ô" : (c.roi > 5 ? "‚ö†Ô∏è ‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ù‡∏≤‡∏Å‡πÅ‡∏ö‡∏á‡∏Å‡πå‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢" : "‚ùå ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢")}</div>
                                            </div>

                                            {/* Margins */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Net Margin (‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥)</span><span className={c.netMargin > 10 ? 'text-green-500 font-bold' : 'text-orange-500 font-bold'}>{c.netMargin.toFixed(1)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.netMargin > 15 ? "‚úÖ ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏ô‡∏≤ ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á" : (c.netMargin > 5 ? "‚ö†Ô∏è ‡∏Å‡∏≥‡πÑ‡∏£‡∏ö‡∏≤‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏≤‡∏ô‡∏õ‡∏•‡∏≤‡∏¢" : "‚ùå ‡∏Å‡∏≥‡πÑ‡∏£‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô")}</div>
                                            </div>

                                            {/* Fixed/Variable Check */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Cost Structure</span><span className="text-slate-700 font-bold">Fix {((c.revBreakdown.opFixed/c.revBreakdown.opCost)*100).toFixed(0)}% : Var {((c.revBreakdown.opVar/c.revBreakdown.opCost)*100).toFixed(0)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.revBreakdown.opFixed > c.revBreakdown.opVar ? "‚ö†Ô∏è Fixed Cost ‡∏™‡∏π‡∏á! ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (Economy of Scale)" : "‚úÖ ‡πÄ‡∏ô‡πâ‡∏ô Variable Cost ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢"}</div>
                                            </div>

                                            {/* Working Cap */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Working Cap (‡∏ó‡∏∏‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô)</span><span className={c.workingCap > 0 ? 'text-blue-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.workingCap)}</span></div>
                                                <div className="text-[10px] text-slate-600">{c.workingCap > 0 ? "‚úÖ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠" : "‚ùå ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∞‡∏î‡∏∏‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å"}</div>
                                            </div>

                                            {/* CAPEX */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>CAPEX Break-even</span><span className="text-slate-700 font-bold">{c.paybackMonth}</span></div>
                                                <div className="text-[10px] text-slate-600">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                                            </div>

                                        </div>
                                    </div>

                                    {/* --- NEW: Marketing Deep Dive (Grid) --- */}
                                    <div className="mt-4 pt-4 border-t border-slate-200">
                                        <h4 className="font-bold text-indigo-700 mb-3 flex items-center gap-2">üì¢ ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Ads Performance)</h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                            
                                            {/* ACOS */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>ACOS (‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î/‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢)</span><span className={c.funnelMetrics.acos < 20 ? 'text-green-600 font-bold' : 'text-red-600 font-bold'}>{c.funnelMetrics.acos.toFixed(1)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.funnelMetrics.acos < 20 ? "‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£" : "‚ùå ‡∏™‡∏π‡∏á‡πÑ‡∏õ! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏à‡πä‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î"}</div>
                                            </div>

                                            {/* CPA */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>CPA (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)</span><span className="text-indigo-700 font-bold">{fmt(c.funnelMetrics.cpa)} ‡∏ø</span></div>
                                                <div className="text-[10px] text-slate-600">‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô > {fmt(c.funnelMetrics.cpa)} ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</div>
                                            </div>

                                            {/* CPC (Bid) */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Max CPC (‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å)</span><span className="text-blue-600 font-bold">{c.funnelMetrics.cpc.toFixed(2)} ‡∏ø</span></div>
                                                <div className="text-[10px] text-slate-600">‡∏´‡πâ‡∏≤‡∏° Bid ‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ ‡∏ñ‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° CVR ‡∏´‡∏£‡∏∑‡∏≠ Basket Size ‡πÅ‡∏ó‡∏ô</div>
                                            </div>

                                            {/* CTR / CVR */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Metrics ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</span><span className="text-slate-700 font-bold">CTR {d.mktFunnel.ctr}% / CVR {d.mktFunnel.cvr}%</span></div>
                                                <div className="text-[10px] text-slate-600">{d.mktFunnel.ctr < 1.5 ? "‚ö†Ô∏è CTR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏´‡πâ‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à" : ""} {d.mktFunnel.cvr < 2 ? "‚ö†Ô∏è CVR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ã‡∏•‡πÄ‡∏û‡∏à/‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô" : ""}</div>
                                            </div>

                                            {/* Basket Size */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Basket Size (AOV)</span><span className="text-slate-700 font-bold">{d.mktFunnel.basketSize} ‡∏ñ‡∏∏‡∏á/‡∏ö‡∏¥‡∏•</span></div>
                                                <div className="text-[10px] text-slate-600">‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° AOV ‡πÑ‡∏î‡πâ ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏á ‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>
                                            </div>

                                            {/* Reach / Impression */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Scale (‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á)</span><span className="text-slate-700 font-bold">{fmt(c.funnelMetrics.visitors)} Clicks</span></div>
                                                <div className="text-[10px] text-slate-600">‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ {fmt(c.funnelMetrics.visitors)} ‡∏Ñ‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤</div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>

                            {/* NEW: Financial Glossary Section */}
                            <div className="card mt-6 border-slate-200 shadow-sm">
                                <div className="card-header bg-slate-100"><div className="card-title text-slate-600 text-sm">üìö ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏¢‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Glossary)</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-700 mb-1">EBITDA (‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î)</div>
                                            <div className="text-slate-500 italic mb-1">Earnings Before Interest, Tax, Depreciation</div>
                                            <div>‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‡∏†‡∏≤‡∏©‡∏µ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-700 mb-1">NPV (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥)</div>
                                            <div className="text-slate-500 italic mb-1">Net Present Value</div>
                                            <div>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏´‡∏±‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô <br/><span className="font-bold text-green-600">> 0 ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-700 mb-1">DSCR (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ä‡∏≥‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ)</div>
                                            <div className="text-slate-500 italic mb-1">Debt Service Coverage Ratio</div>
                                            <div>(EBITDA / ‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ) ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏´‡∏° <br/><span className="font-bold text-blue-600">‡∏Ñ‡∏ß‡∏£ > 1.25 (‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏≠‡∏ö)</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-700 mb-1">D/E Ratio (‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Debt to Equity Ratio</div>
                                            <div>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á <br/><span className="font-bold text-orange-600">‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡∏¥‡∏ô 2.0 ‡πÄ‡∏ó‡πà‡∏≤</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">ROE (‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á)</div>
                                            <div className="text-slate-500 italic mb-1">Return on Equity</div>
                                            <div>(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô) ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏•‡∏á‡πÑ‡∏õ 100 ‡∏ö‡∏≤‡∏ó ‡∏á‡∏≠‡∏Å‡πÄ‡∏á‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó <br/><span className="font-bold text-teal-600">‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£ > 10-15%)</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-pink-700 mb-1">Break-even Point (‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">BEP (Units)</div>
                                            <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏û‡∏≠‡∏î‡∏µ (‡∏Å‡∏≥‡πÑ‡∏£ = 0) ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">ROA (‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå)</div>
                                            <div className="text-slate-500 italic mb-1">Return on Assets</div>
                                            <div>(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≥‡πÑ‡∏£ <br/><span className="font-bold text-teal-600">‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">Asset Turnover (‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå)</div>
                                            <div className="text-slate-500 italic mb-1">Asset Turnover Ratio</div>
                                            <div>(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå 1 ‡∏ö‡∏≤‡∏ó ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó ‡∏ö‡∏≠‡∏Å‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-600 mb-1">Gross Margin (‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Gross Profit Margin</div>
                                            <div>((‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢) / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-600 mb-1">Net Margin (‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥)</div>
                                            <div className="text-slate-500 italic mb-1">Net Profit Margin</div>
                                            <div>(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏µ</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-600 mb-1">Working Capital (‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Current Assets - Current Liabilities</div>
                                            <div>‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏∏‡∏î (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-purple-600 mb-1">Tax Shield (‡πÇ‡∏•‡πà‡∏†‡∏≤‡∏©‡∏µ)</div>
                                            <div className="text-slate-500 italic mb-1">Loss Carry Forward</div>
                                            <div>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ô‡∏≥ "‡∏ú‡∏•‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏™‡∏∞‡∏™‡∏°" ‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï ‡∏°‡∏≤‡∏´‡∏±‡∏Å‡∏•‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 5 ‡∏õ‡∏µ)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">CAPEX (‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏•‡∏á‡∏ó‡∏∏‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Capital Expenditure</div>
                                            <div>‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ (‡πÑ‡∏°‡πà‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">OPEX (‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Operating Expenditure</div>
                                            <div>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-emerald-700 mb-1">Cash Flow (‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î)</div>
                                            <div className="text-slate-500 italic mb-1">Liquidity</div>
                                            <div>‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏à‡πä‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-red-600 mb-1">Fixed Cost (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)</div>
                                            <div className="text-slate-500 italic mb-1">Fixed Expenses</div>
                                            <div>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-600 mb-1">Variable Cost (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£)</div>
                                            <div className="text-slate-500 italic mb-1">Variable Expenses</div>
                                            <div>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Marketing & Ads Glossary Section */}
                            <div className="card mt-6 border-indigo-200 shadow-sm">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800 text-sm">üì¢ ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏¢‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î & ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Marketing & Ads Glossary)</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-700 mb-1">ROAS (‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)</div>
                                            <div className="text-slate-500 italic mb-1">Return on Ad Spend</div>
                                            <div>(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤) ‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó <br/><span className="font-bold text-indigo-600">‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (TikTok Shop ‡∏Ñ‡∏ß‡∏£ > 5-7x)</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-pink-700 mb-1">ACOS (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)</div>
                                            <div className="text-slate-500 italic mb-1">Advertising Cost of Sales</div>
                                            <div>(‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏µ‡πà % ‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <br/><span className="font-bold text-pink-600">‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≥‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ % ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô)</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-blue-700 mb-1">CPA (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Acquisition / Action</div>
                                            <div>(‡∏á‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå) ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á <br/><span className="font-bold text-blue-600">‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-orange-700 mb-1">CPC (‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å)</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Click</div>
                                            <div>‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á <br/>‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-teal-700 mb-1">CTR (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å)</div>
                                            <div className="text-slate-500 italic mb-1">Click-Through Rate</div>
                                            <div>(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å / ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å <br/><span className="font-bold text-teal-600">‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à (TikTok ‡∏Ñ‡∏ß‡∏£ > 1.5-2%)</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-purple-700 mb-1">CVR (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠)</div>
                                            <div className="text-slate-500 italic mb-1">Conversion Rate</div>
                                            <div>(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏£‡∏¥‡∏á <br/><span className="font-bold text-purple-600">‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≥‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏£‡∏≤‡∏Ñ‡∏≤</span></div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-sky-700 mb-1">CPM (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô)</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Mille (1,000 Impressions)</div>
                                            <div>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏ö 1,000 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á <br/>‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-green-700 mb-1">GMV (‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°)</div>
                                            <div className="text-slate-500 italic mb-1">Gross Merchandise Value</div>
                                            <div>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-red-700 mb-1">Impression (‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•)</div>
                                            <div className="text-slate-500 italic mb-1">Ad Views</div>
                                            <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ô‡∏±‡∏ö‡∏ã‡πâ‡∏≥‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-600 mb-1">Basket Size / AOV</div>
                                            <div className="text-slate-500 italic mb-1">Average Order Value</div>
                                            <div>‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠ 1 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ö‡∏¥‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Affiliate (‡∏ô‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤)</div>
                                            <div className="text-slate-500 italic mb-1">Commission Base</div>
                                            <div>‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô (Creators) ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡πÅ‡∏ö‡πà‡∏á % ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ <br/>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠: ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢ (Cost per Action)</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Reach (‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á)</div>
                                            <div className="text-slate-500 italic mb-1">Unique Users</div>
                                            <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô "‡∏Ñ‡∏ô" ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Impression ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô "‡∏Ñ‡∏£‡∏±‡πâ‡∏á") ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÑ‡∏õ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
