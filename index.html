<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai Fortunate Innovation - Financial Strategy Simulator</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#334155',
                        accent: '#2563eb',
                        bg: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Prompt', 'Noto Sans SC', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f1f5f9; color: #1e293b; }
        .app-container { min-height: 100vh; padding-bottom: 40px; }
        .header-bar { background: #0f172a; color: white; padding: 16px 24px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        .card { background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; overflow: hidden; margin-bottom: 16px; transition: transform 0.2s; }
        .card:hover { border-color: #cbd5e1; }
        .card-header { background: #f8fafc; padding: 10px 16px; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-weight: 600; color: #334155; font-size: 0.95rem; display: flex; align-items: center; gap: 8px; }
        .card-body { padding: 16px; }

        .input-group { margin-bottom: 8px; }
        .input-label { font-size: 0.85rem; color: #64748b; display: block; margin-bottom: 4px; }
        .input-field { width: 100%; border: 1px solid #cbd5e1; border-radius: 6px; padding: 4px 10px; font-size: 0.9rem; text-align: right; transition: all 0.2s; color: #0f172a; font-weight: 500; }
        .input-field:focus { border-color: #2563eb; outline: none; ring: 2px solid #bfdbfe; }
        .input-row { display: flex; justify-content: space-between; align-items: center; gap: 8px; padding: 4px 0; border-bottom: 1px dashed #f1f5f9; }
        
        .hr-table th { text-align: left; font-size: 0.7rem; color: #64748b; padding-bottom: 4px; }
        .hr-table td { padding: 2px 1px; vertical-align: middle; font-size: 0.7rem; }
        .hr-input { width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 1px 2px; font-size: 0.7rem; text-align: right; height: 24px; }

        .flow-row { display: flex; justify-content: space-between; padding: 4px 0; font-size: 0.85rem; }
        .flow-row.total { font-weight: 700; border-top: 1px solid #e2e8f0; margin-top: 4px; padding-top: 8px; }
        .flow-sub { padding-left: 12px; color: #64748b; font-size: 0.8rem; }

        .scenario-btn { padding: 4px 12px; font-size: 0.75rem; border-radius: 20px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
        .scenario-btn.active { font-weight: bold; transform: scale(1.05); }

        .matrix-table th, .matrix-table td { border: 1px solid #e2e8f0; padding: 6px; text-align: center; font-size: 0.75rem; }
        .matrix-header { background: #f1f5f9; font-weight: 600; color: #475569; }

        .risk-btn {
            font-size: 0.7rem; padding: 6px 8px; border-radius: 6px; border: 1px solid #e2e8f0; background: white; 
            text-align: left; transition: all 0.2s; position: relative; overflow: hidden;
        }
        .risk-btn:hover { border-color: #94a3b8; transform: translateY(-1px); shadow: sm; }
        .risk-btn.active { border-color: #ef4444; background: #fef2f2; color: #991b1b; font-weight: 600; }
        .risk-btn::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: transparent; }
        .risk-btn.cat-1.active::before { background: #f97316; } /* Market - Orange */
        .risk-btn.cat-2.active::before { background: #3b82f6; } /* Supply - Blue */
        .risk-btn.cat-3.active::before { background: #a855f7; } /* Finance - Purple */
        .risk-btn.cat-4.active::before { background: #ef4444; } /* Ops - Red */

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { height: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        @media print {
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .header-bar { padding: 10px; background: white !important; color: black !important; box-shadow: none; border-bottom: 2px solid #000; }
            .header-bar h1 { font-size: 1.5rem; color: #000; }
            .header-bar p { color: #666; }
            .header-controls, .scenario-btn, .print-btn-hide, .toggle-switch-container, .risk-sim-section { display: none !important; }
            .card { box-shadow: none; border: 1px solid #ccc; break-inside: avoid; margin-bottom: 10px; }
            .card-header { background: #eee !important; color: #000; border-bottom: 1px solid #aaa; }
            .input-field { border: none; background: transparent; padding: 0; text-align: right; font-weight: bold; }
            .input-group, .input-row { border-bottom: 1px solid #eee; }
            input[type=range] { display: none; }
            .app-container { padding-bottom: 0; }
            .lg\:col-span-3, .lg\:col-span-5, .lg\:col-span-4 { width: 100% !important; display: block; }
            .bg-slate-800 { background-color: #fff !important; color: #000 !important; border: 2px solid #000; }
            .bg-slate-800 .text-white { color: #000 !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, AreaChart, Area, CartesianGrid, PieChart, Pie, Cell, Legend, ComposedChart, Line, ReferenceLine } = Recharts;

        const fmt = (n) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(n);
        const fmtDec = (n) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(n);
        const COLORS = ['#3b82f6', '#ef4444', '#f59e0b', '#10b981', '#6366f1', '#8b5cf6', '#ec4899', '#64748b'];

        // --- Helper for Base64 Unicode ---
        const toBase64 = (str) => {
            return window.btoa(unescape(encodeURIComponent(str)));
        };

        const fromBase64 = (str) => {
            return decodeURIComponent(escape(window.atob(str)));
        };

        // --- TRANSLATIONS ---
        const TRANS = {
            th: {
                title: "Thai Fortunate Innovation",
                subtitle: "Financial Strategy Simulator",
                scenario: "SCENARIO:",
                reset: "Reset",
                share: "Share",
                print: "Print",
                section1: "1. Production & Cost",
                capexTitle: "‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô & ‡πÅ‡∏´‡∏•‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô (CAPEX)",
                regCapital: "‡∏ó‡∏∏‡∏ô‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Equity)",
                bankLoan: "üè¶ ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Bank Loan)",
                loanAmount: "‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ",
                interestRate: "‡∏î‡∏ö.%",
                loanTerm: "‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏õ‡∏µ)",
                interestPerYear: "‡∏î‡∏ö./‡∏õ‡∏µ (‡∏•‡∏î‡∏ï‡πâ‡∏ô)",
                factory: "‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô",
                machine: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£",
                license: "‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï",
                stockMoney: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Ñ‡∏Ç‡πâ‡∏≤‡∏ß‡∏•‡πá‡∏≠‡∏ï‡πÅ‡∏£‡∏Å",
                workingCap: "Working Cap ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:",
                productionTitle: "‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï (Yield)",
                yieldRice: "Yield ‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£",
                paddyPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å (‡∏ö‡∏≤‡∏ó/‡∏ï‡∏±‡∏ô)",
                paddyUsed: "‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å:",
                ton: "‡∏ï‡∏±‡∏ô",
                riceBudget: "‡πÉ‡∏ä‡πâ‡∏á‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡πâ‡∏≤‡∏ß:",
                unitCostTitle: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á",
                rice: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£",
                bag: "‡∏ñ‡∏∏‡∏á",
                sticker: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
                totalUnitCost: "‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:",
                hrTitle: "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô",
                role: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
                count: "‡∏Ñ‡∏ô",
                salary: "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                sso: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° (5%)",
                total: "‡∏£‡∏ß‡∏°",
                expenseTitle: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Expenses)",
                varParamTitle: "Variable Cost Parameters",
                elec: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü",
                platform: "Platform",
                marketing: "Marketing",
                returnRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (%)",
                fixedParamTitle: "Fixed Cost (Other)",
                operationTitle: "Operation & Admin", // New Header
                maintenance: "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (%)",
                insurance: "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢/‡∏õ‡∏µ",
                erp: "ERP Software",
                audit: "‡∏Ñ‡πà‡∏≤‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Audit)",
                travel: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á/‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á",
                campaign: "‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á‡∏Ø",
                misc: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Misc)",
                campaignBreakdown: "üèÜ Campaign Gold Breakdown",
                reward: "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•",
                qty: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",
                costPerUnit: "‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢",
                section2: "2. Strategy & Performance",
                execSummary: "Executive Summary",
                netProfitYear1: "Net Profit (Year 1)",
                payback: "‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô:",
                month: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                year: "‡∏õ‡∏µ",
                salesTargetTitle: "‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ & ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
                targetBags: "‡πÄ‡∏õ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ñ‡∏∏‡∏á/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
                sellPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó/‡∏ñ‡∏∏‡∏á)",
                creditTerm: "Credit Term (‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏ô‡∏µ‡πâ)",
                cash: "‡∏Ç‡∏≤‡∏¢‡∏™‡∏î (0 ‡∏ß‡∏±‡∏ô)",
                credit: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
                creditWarning: "*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ô‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡πâ‡∏≤‡∏•‡∏á",
                totalSales: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°",
                targetPerDay: "‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô",
                targetPerHour: "‡πÄ‡∏õ‡πâ‡∏≤‡∏ï‡πà‡∏≠ ‡∏ä‡∏°. (24h)",
                byProductTitle: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ (By-products)",
                item: "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
                pricePerTon: "‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ï‡∏±‡∏ô",
                totalIncome: "‡∏£‡∏ß‡∏° (‡∏ö.)",
                totalByProductIncome: "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                logisticsTitle: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ Drop-off (J&T Home)",
                ownDeliveryPercent: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏á (%)",
                dropOffProfit: "‡∏Ñ‡πà‡∏≤ Drop-off/‡∏ä‡∏¥‡πâ‡∏ô",
                extraIncome: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°:",
                vatRefundTitle: "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ã‡∏∑‡πâ‡∏≠ (VAT Refund Est.)",
                vatableExp: "‡∏ê‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (Vatable Expenses)",
                vatNote: "- ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á, ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á, ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü, Platform, Ads ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô",
                outputVat: "Output VAT (‡∏Ç‡∏≤‡∏¢)",
                inputVat: "Input VAT (‡∏ã‡∏∑‡πâ‡∏≠)",
                payMore: "‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° (Pay)",
                refund: "‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ (Refund)",
                monthlyFlowTitle: "Monthly Revenue & Cost Breakdown",
                cashInflow: "1. Cash Inflow",
                salesGross: "- Sales (Gross)",
                vatObligation: "2. VAT Obligation",
                vatNote2: "* VAT ‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°",
                opOutflow: "3. Operational Outflow",
                varExclVat: "Variable (excl. VAT)",
                fixedCost: "Fixed Cost",
                netCashEbitda: "Net Cash (EBITDA)",
                section3: "3. Financial Outlook",
                cumCashflow: "Cumulative Cashflow",
                bepTitle: "‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô (Break-even Analysis)",
                revStruct: "Revenue Structure",
                costStruct: "Cost Structure",
                sensitivity: "‚ö†Ô∏è Sensitivity (Net Profit)",
                tiktokAdsTitle: "TikTok Shop Ads Planning (GMV Max)",
                totalBudget: "Total Budget",
                budgetNote: "‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Marketing %",
                targetRoas: "Target ROAS",
                minRoasNote: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Minimum ROAS",
                acos: "ACOS",
                acosNote: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î/GMV",
                maxCpa: "Max CPA (Cost/Order)",
                maxCpaNote: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô)",
                maxCpc: "Max CPC (Bid)",
                maxCpcNote: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å (Standard Mode)",
                funnelInput: "Funnel Simulation Inputs",
                basketSize: "Basket Size (‡∏ñ‡∏∏‡∏á/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå)",
                impressionsNeeded: "1. Impressions Needed",
                clicksTraffic: "2. Clicks (Traffic)",
                ordersTarget: "3. Orders (Target)",
                detailedCashflow: "Detailed Monthly Cashflow (Year 1)",
                monthlyGrowth: "Monthly Growth:",
                taxDepTitle: "Tax & Depreciation Details",
                depSchedule: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ (Depreciation Schedule)",
                asset: "‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                value: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤",
                lifeYear: "‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)",
                depPerYear: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏õ‡∏µ",
                corpTax: "‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (Corporate Tax)",
                taxableIncome: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ (Taxable Income)",
                dividendTitle: "Dividend Policy & Shareholder Return",
                policyInput: "‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ (Policy Inputs)",
                payoutRatio: "Payout Ratio (%)",
                shareholders: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (‡∏Ñ‡∏ô)",
                netProfitBreakdown: "‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Profit Breakdown)",
                shareholderReturn: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô (Per Shareholder)",
                totalPool: "‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏° (Total Pool)",
                perYear: "‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ",
                avgPerMonth: "‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢",
                financialHealth: "Financial Health Check (Year 1)",
                debtToEquity: "D/E Ratio (‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô)",
                debtToEquityDesc: "‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡∏∏‡∏ô (‡∏Ñ‡∏ß‡∏£ < 2.0)",
                returnOnAsset: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                returnOnEquity: "‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô",
                assetTurnoverDesc: "‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (‡∏£‡∏≠‡∏ö/‡∏õ‡∏µ)",
                projectionTitle: "Detailed 5-Year Financial Projection (With Tax Shield & Split Growth)",
                npvDesc: "Net Present Value (NPV) ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ 5 ‡∏õ‡∏µ ‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å",
                aiAnalysis: "ü§ñ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå & ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (AI Analysis)",
                financialDeepDive: "üìä ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Deep Dive)",
                adsPerformance: "üì¢ ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Ads Performance)",
                financialGlossary: "üìö ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏¢‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Glossary)",
                marketingGlossary: "üì¢ ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏¢‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î & ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (Marketing & Ads Glossary)",
                
                // --- Additional Translations ---
                beRoas: "Breakeven ROAS (‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô)",
                beRoasNote: "‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ (‡∏Å‡∏≥‡πÑ‡∏£ = 0)",
                spreadAnalysis: "‚ö†Ô∏è Sensitivity (Spread: Cost vs Price)",
                paddyLabel: "Paddy (Rice Cost)",
                priceLabel: "Selling Price",
                perMonth: "‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",

                // NEW: Scenario Comparison
                scenComp: "‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 3 ‡∏â‡∏≤‡∏Å‡∏ó‡∏±‡∏®‡∏ô‡πå (Scenario Comparison)",
                scenWorst: "Worst (‡πÅ‡∏¢‡πà‡∏™‡∏∏‡∏î)",
                scenBase: "Base (‡∏õ‡∏Å‡∏ï‡∏¥)",
                scenBest: "Best (‡∏î‡∏µ‡∏™‡∏∏‡∏î)",
                scenProfit: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                scenCash: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ",
                
                // NEW: Ads Matrix
                adsMatrixTitle: "üéØ Ads Efficiency Matrix (CTR x CVR = ROAS)",
                adsMatX: "CTR (Clip Quality)",
                adsMatY: "CVR (Sale Page)",

                // --- Cash Flow Summary (Below Table) ---
                wcStart: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (Working Cap)",
                lowestCash: "‡∏à‡∏∏‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest)",
                debtService: "‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô+‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢",
                taxPaidCash: "‡∏´‡∏±‡∏Å‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏µ‡∏ô‡∏µ‡πâ (Cash Paid)",
                netProfitAcc: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Net Profit)",
                netProfitDesc: "(‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ - ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° - ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ - ‡∏†‡∏≤‡∏©‡∏µ)",
                cashEndYear: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ (Cash Balance Year End)",
                cashEndDesc: "(‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô + ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á - ‡∏†‡∏≤‡∏©‡∏µ - ‡∏´‡∏ô‡∏µ‡πâ)",

                // --- NEW MODEL TRANSLATIONS ---
                channelMixTitle: "üõí Channel Mix Revenue (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏≤‡∏¢)",
                channelPct: "% ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                platformFeePct: "‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏° %",
                offline: "Offline / Other",
                weightedFee: "‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Weighted Fee):",

                elasticityTitle: "üíé Brand Pricing Elasticity (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤)",
                elasticityCoef: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (Elasticity)",
                elasticityDesc: (c) => `(-${c} ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ ‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ 10% ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å ${(c * 10).toFixed(0)}%)`,
                optPrice: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
                estVol: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                estRev: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                
                clvTitle: "üë• Customer Lifetime Value (‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û)",
                freqPerYear: "‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡πâ‡∏≥ (‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏õ‡∏µ)",
                retentionRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (%)",
                ltv1: "LTV (1 ‡∏õ‡∏µ)",
                ltv3: "LTV (3 ‡∏õ‡∏µ)",
                cac: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (CAC)",
                ltvCacRatio: "LTV : CAC Ratio",
                ltvDesc: "‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠ Ratio > 3 ‡πÄ‡∏ó‡πà‡∏≤",

                seasonalTitle: "‚õàÔ∏è Seasonal Supply Shock (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•)",
                enableShock: "‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (Enable Scenario)",
                shockMonthStart: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° (Start)",
                shockMonthEnd: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏ö (End)",
                shockCostImpact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏° (%)",
                shockDesc: "‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Cashflow ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",

                // --- Cash Flow Table Headers ---
                cfSales: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (Booking)",
                cfInflow: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á",
                cfExp: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Cash)",
                cfVat: "‡∏ô‡∏≥‡∏™‡πà‡∏á VAT",
                cfOpCash: "‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (EBITDA)",
                cfBalance: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                start0: "0 (‡πÄ‡∏£‡∏¥‡πà‡∏°)",

                // --- 5-Year Projection Headers ---
                pyYear: "‡∏õ‡∏µ‡∏ó‡∏µ‡πà",
                pyRev: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°",
                pyExp: "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Cash)",
                pyEbitda: "EBITDA",
                pyDep: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°",
                pyTax: "‡∏†‡∏≤‡∏©‡∏µ‡∏à‡πà‡∏≤‡∏¢",
                pyNet: "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥",
                pyDiv: "‡∏õ‡∏±‡∏ô‡∏ú‡∏•",
                pyCashEnd: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏õ‡∏µ",

                // --- Items (By-products & Campaigns) ---
                prod_husk: "‡πÅ‡∏Å‡∏•‡∏ö",
                prod_fine: "‡∏£‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î",
                prod_rough: "‡∏£‡∏≥‡∏´‡∏¢‡∏≤‡∏ö",
                prod_broken: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏±‡∏Å",
                prod_waste: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢",
                camp_gold1: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á 1 ‡∏™‡∏•‡∏∂‡∏á",
                camp_gold2: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏™‡∏•‡∏∂‡∏á",
                camp_free: "‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ü‡∏£‡∏µ 1 ‡∏õ‡∏µ",
                refundDeduction: "- Refunds (‡∏´‡∏±‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)",

                // NEW: Risk Simulator
                riskTitle: "üö® Risk Simulation Center (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á)",
                riskLabelMarket: "1. Market Risk",
                riskLabelSupply: "2. Supply & Prod",
                riskLabelFin: "3. Financial",
                riskLabelOps: "4. Ops & Human",
                riskAnalTitle: "ü§ñ AI Risk Analysis",
                simLogic: "‚ö†Ô∏è Logic ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Assumption):",
                impact: "‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö (Impact):",
                cause: "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (Cause):",
                strategy: "‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠ (Strategy):",
                simActive: "Simulation Active:",
                stopSim: "Stop Simulation",
                
                // NEW: Capacity Engine
                capTitle: "‚öôÔ∏è Capacity Utilization Engine (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï)",
                maxCapInput: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Max Capacity)",
                utilRate: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï (Utilization)",
                fcPerUnit: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á (Fixed Cost/Unit)",
                capStatus: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï",
                capWarning: "‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï! ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ OT ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏±‡∏á",
                capOptimal: "‚úÖ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (Optimal) ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤",
                capWaste: "‚ùå ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ (Under) ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏™‡∏π‡∏á",

                // AI Builders
                meaning: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢",
                situation: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå",
                status: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô",
                advice: "üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
                npvPos: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ '‡∏ä‡∏ô‡∏∞' ‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á",
                npvNeg: "‡∏ô‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡πà‡∏ß‡∏á! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß '‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°' ‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÑ‡∏õ ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏û‡πâ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠",
                npvAdvPos: "‡∏•‡∏∏‡∏¢‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢! ‡πÅ‡∏ú‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ô‡∏µ‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ Re-invest ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°",
                npvAdvNeg: "‡∏´‡∏¢‡∏∏‡∏î‡∏Ñ‡∏¥‡∏î‡∏Å‡πà‡∏≠‡∏ô! ‡∏•‡∏≠‡∏á‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (CAPEX) ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢/‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤ NPV ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å",
                roasHigh: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ñ‡∏π‡∏Å‡∏°‡∏≤‡∏Å! ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ö‡∏≤‡∏ó ‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ü‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô",
                roasMed: "‡∏û‡∏≠‡πÑ‡∏õ‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏∂‡∏á! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏õ‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£ ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏°‡∏á‡∏ö‡∏î‡∏µ‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ ROAS ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ",
                roasLow: "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏û‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏ô‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠",
                roasAdvHigh: "Scale Up! ‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ï‡∏£‡∏≤‡∏ö‡πÉ‡∏î‡∏ó‡∏µ‡πà ROAS ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≠‡∏ö‡πÇ‡∏Å‡∏¢‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",
                roasAdvMed: "Optimize! ‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏î‡∏π‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° Basket Size ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á ROAS ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô",
                roasAdvLow: "Stop & Fix! ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏±‡∏î‡∏á‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏£‡∏µ‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡∏•‡∏¥‡∏õ/‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô ‡∏ñ‡πâ‡∏≤‡∏ù‡∏∑‡∏ô‡∏¢‡∏¥‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏∞‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                cfSafe: (v) => `‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢! ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${v} ‡∏ö‡∏≤‡∏ó ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡∏ô`,
                cfDanger: (v) => `‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠! ‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${v} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å`,
                cfAdvSafe: "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏≠‡∏≤‡∏à‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏õ‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢",
                cfAdvDanger: "‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πà‡∏ß‡∏ô! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Ç‡∏≠‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏ó‡∏≠‡∏°‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏•‡∏á)",
                
                // Deep Dive Checks
                ebitdaOk: "‚úÖ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏õ‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡∏†‡∏≤‡∏©‡∏µ",
                ebitdaFail: "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏µ‡∏ö‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                dscrOk: "‚úÖ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏£‡∏±‡∏Å! ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏ö‡∏≤‡∏¢‡πÜ",
                dscrWarn: "‚ö†Ô∏è ‡∏û‡∏≠‡∏ñ‡∏π‡πÑ‡∏ñ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏∏‡∏î ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏ö‡∏á‡∏Å‡πå",
                dscrFail: "‚ùå ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢! ‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î",
                deOk: "‚úÖ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏Å‡∏π‡πâ‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ï‡∏±‡∏ß",
                deFail: "‚ùå ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á! ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏ö‡∏Å‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
                bepOk: (v) => `‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô‡∏°‡∏≤ ${v} ‡∏ñ‡∏∏‡∏á`,
                bepFail: "‚ùå ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô! ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô",
                roeHigh: "‚úÖ ‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏°‡∏≤‡∏Å! ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏∏‡πâ‡∏ô",
                roeMed: "‚ö†Ô∏è ‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ù‡∏≤‡∏Å‡πÅ‡∏ö‡∏á‡∏Å‡πå‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢",
                roeLow: "‚ùå ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢",
                nmHigh: "‚úÖ ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏ô‡∏≤ ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á",
                nmMed: "‚ö†Ô∏è ‡∏Å‡∏≥‡πÑ‡∏£‡∏ö‡∏≤‡∏á ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏≤‡∏ô‡∏õ‡∏•‡∏≤‡∏¢",
                nmLow: "‚ùå ‡∏Å‡∏≥‡πÑ‡∏£‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏≤‡∏Å ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                fixHigh: "‚ö†Ô∏è Fixed Cost ‡∏™‡∏π‡∏á! ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (Economy of Scale)",
                varHigh: "‚úÖ ‡πÄ‡∏ô‡πâ‡∏ô Variable Cost ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
                wcOk: "‚úÖ ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠",
                wcFail: "‚ùå ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏∞‡∏î‡∏∏‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å",
                
                // Ads Checks
                acosOk: "‚úÖ ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£",
                acosFail: "‚ùå ‡∏™‡∏π‡∏á‡πÑ‡∏õ! ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡πÅ‡∏ï‡πà‡πÄ‡∏à‡πä‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î",
                cpaCheck: (v) => `‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô > ${v} ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô`,
                bidCheck: "‡∏´‡πâ‡∏≤‡∏° Bid ‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ ‡∏ñ‡πâ‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° CVR ‡∏´‡∏£‡∏∑‡∏≠ Basket Size ‡πÅ‡∏ó‡∏ô",
                ctrLow: "‚ö†Ô∏è CTR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏´‡πâ‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à",
                cvrLow: "‚ö†Ô∏è CVR ‡∏ï‡πà‡∏≥‡πÑ‡∏õ ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ã‡∏•‡πÄ‡∏û‡∏à/‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô",
                aovTip: "‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° AOV ‡πÑ‡∏î‡πâ ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏á ‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                scaleTip: (v) => `‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ${v} ‡∏Ñ‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤`,

                // Glossary
                gEbitda: "‡∏Å‡∏≥‡πÑ‡∏£‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‡∏†‡∏≤‡∏©‡∏µ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£",
                gNpv: "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏´‡∏±‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô \n> 0 ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô",
                gDscr: "(EBITDA / ‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ) ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏´‡∏° \n‡∏Ñ‡∏ß‡∏£ > 1.25 (‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏≠‡∏ö)",
                gDe: "‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á \n‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡∏¥‡∏ô 2.0 ‡πÄ‡∏ó‡πà‡∏≤",
                gRoe: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô) ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏•‡∏á‡πÑ‡∏õ 100 ‡∏ö‡∏≤‡∏ó ‡∏á‡∏≠‡∏Å‡πÄ‡∏á‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£ > 10-15%)",
                gBep: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏û‡∏≠‡∏î‡∏µ (‡∏Å‡∏≥‡πÑ‡∏£ = 0) ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≥‡πÑ‡∏£",
                gRoa: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≥‡πÑ‡∏£ \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ",
                gAssetTurn: "(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏ß‡∏°) ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå 1 ‡∏ö‡∏≤‡∏ó ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó ‡∏ö‡∏≠‡∏Å‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                gGross: "((‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢) / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£",
                gNet: "(‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) % ‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏µ",
                gWc: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏∏‡∏î (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)",
                gTaxShield: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ô‡∏≥ \"‡∏ú‡∏•‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏™‡∏∞‡∏™‡∏°\" ‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï ‡∏°‡∏≤‡∏´‡∏±‡∏Å‡∏•‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 5 ‡∏õ‡∏µ)",
                gCapex: "‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ (‡πÑ‡∏°‡πà‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°)",
                gOpex: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ)",
                gCf: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏•‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏à‡πä‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
                gFix: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® ‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤",
                gVar: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á",
                
                gRoas: "(‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤) ‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î 1 ‡∏ö‡∏≤‡∏ó ‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (TikTok Shop ‡∏Ñ‡∏ß‡∏£ > 5-7x)",
                gAcos: "(‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢) ‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏µ‡πà % ‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ \n‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≥‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ (‡∏Ñ‡∏ß‡∏£‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ % ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô)",
                gCpa: "(‡∏á‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå) ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô",
                gCpc: "‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤",
                gCtr: "(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å / ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å \n‡∏¢‡∏¥‡πà‡∏á‡∏™‡∏π‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à (TikTok ‡∏Ñ‡∏ß‡∏£ > 1.5-2%)",
                gCvr: "(‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå / ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å) % ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏£‡∏¥‡∏á \n‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≥‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏£‡∏≤‡∏Ñ‡∏≤",
                gCpm: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏ö 1,000 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á \n‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°",
                gGmv: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á)",
                gImp: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ô‡∏±‡∏ö‡∏ã‡πâ‡∏≥‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ)",
                gAov: "‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠ 1 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡∏¢‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏ö‡∏¥‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)",
                gAff: "‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô (Creators) ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡πÅ‡∏ö‡πà‡∏á % ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ \n‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠: ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢ (Cost per Action)",
                gReach: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô \"‡∏Ñ‡∏ô\" ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Impression ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô \"‡∏Ñ‡∏£‡∏±‡πâ‡∏á\") ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÑ‡∏õ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô"
            }
        };

        const SCENARIOS = {
            // 1. Market Risk
            price_war: {
                category: 1,
                label: { th: "‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ (Price War)", cn: "‰ª∑Ê†ºÊàò" },
                apply: (d) => ({ ...d, price: d.price * 0.85, varParams: { ...d.varParams, mktPercent: d.varParams.mktPercent * 1.2 } }),
                math_desc: { th: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ -15%, ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î +20%", cn: "ÂîÆ‰ª∑ -15%, Ëê•ÈîÄÈ¢ÑÁÆó +20%" },
                analysis: {
                    th: { impact: "‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏Æ‡∏ß‡∏ö, ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏∏‡πà‡∏á", cause: "‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏µ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ï‡∏µ‡∏ï‡∏•‡∏≤‡∏î", strategy: "‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏Ç‡πà‡∏á! ‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Bundling) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏ô‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤" },
                    cn: { impact: "ÊØõÂà©ÁéáÊö¥Ë∑åÔºåËê•ÈîÄÊàêÊú¨È£ôÂçá", cause: "‰∏ªË¶ÅÁ´û‰∫âÂØπÊâãÈôç‰ª∑Êàñ‰∏≠ÂõΩÂïÜÂìÅËøõÂÖ•Â∏ÇÂú∫", strategy: "‰∏çË¶ÅÊâì‰ª∑Ê†ºÊàòÔºÅ‰∏ìÊ≥®‰∫éÂìÅÁâåÂª∫ËÆæÔºåÂ¢ûÂä†ÊúçÂä°ÊàñÊçÜÁªëÈîÄÂîÆ (Bundling) ‰ª•ÈÅøÂÖç‰ª∑Ê†ºÊØîËæÉ" }
                }
            },
            new_competitor: {
                category: 1,
                label: { th: "‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÉ‡∏´‡∏°‡πà (New Competitor)", cn: "Êñ∞Á´û‰∫âÂØπÊâã" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.8 }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡πÄ‡∏õ‡πâ‡∏≤) -20%", cn: "ÈîÄÂîÆÁõÆÊ†á -20%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å 20%, ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏•‡∏≤‡∏î‡∏•‡∏î‡∏•‡∏á", cause: "‡∏°‡∏µ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏¢‡πà‡∏á‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏î‡∏¥‡∏°", strategy: "‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (Retention) ‡∏î‡πâ‡∏ß‡∏¢ CRM, ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡πâ‡∏≥" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ù‰∏ãÈôç 20%ÔºåÂ∏ÇÂú∫‰ªΩÈ¢ùÂáèÂ∞ë", cause: "Êñ∞ÂìÅÁâåÊä¢Âç†ÂéüÊúâÂÆ¢Êà∑Áæ§", strategy: "ÈÄöËøá CRM„ÄÅ‰ºöÂëòÁ≥ªÁªüÂíåÂ§çË¥≠‰øÉÈîÄÊù•Áïô‰ΩèËÄÅÂÆ¢Êà∑ (Retention)" }
                }
            },
            algo_change: {
                category: 1,
                label: { th: "‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏° (Algo Change)", cn: "ÁÆóÊ≥ïÂèòÊõ¥" },
                apply: (d) => ({ ...d, varParams: { ...d.varParams, mktPercent: d.varParams.mktPercent * 1.5 } }),
                math_desc: { th: "‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î (Ads) +50%", cn: "ÂπøÂëäÈ¢ÑÁÆó +50%" },
                analysis: {
                    th: { impact: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 50% ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ, ROAS ‡∏£‡πà‡∏ß‡∏á", cause: "TikTok/Shopee ‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô (Reach) ‡∏Ç‡∏≠‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á", strategy: "‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏õ‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏ó‡∏≥‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå Organic ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô (Entertainment first)" },
                    cn: { impact: "ÂπøÂëäË¥πÁ´ãÂç≥‰∏äÊ∂® 50%ÔºåROAS ‰∏ãË∑å", cause: "TikTok/Shopee Èôç‰Ωé‰∫ÜÈîÄÂîÆÂ∏ñÂ≠êÁöÑÊõùÂÖâÁéá (Reach)", strategy: "ÂàÜÊï£È£éÈô©Ëá≥Â§ö‰∏™Âπ≥Âè∞ÔºåÂπ∂‰∏ìÊ≥®‰∫éÂà∂‰ΩúÊõ¥Â§öÂéüÁîüÂÜÖÂÆπ (Â®±‰πê‰ºòÂÖà)" }
                }
            },
            negative_viral: {
                category: 1,
                label: { th: "‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏• (Viral Drama)", cn: "Á§æ‰∫§Â™í‰ΩìÂç±Êú∫" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.6, varParams: { ...d.varParams, returnRate: 10 } }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -40%, ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á = 10%", cn: "ÈîÄÂîÆÈ¢ù -40%, ÈÄÄË¥ßÁéá = 10%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏≤‡∏¢ 40%, ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏´‡πà‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á", cause: "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏¢‡πà‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πà‡∏≤‡∏ß", strategy: "‡πÅ‡∏ñ‡∏•‡∏á‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏±‡∏ô‡∏ó‡∏µ, ‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏° 100% ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á QC ‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ùÊçüÂ§± 40%ÔºåÂÆ¢Êà∑Â§ßÈáèÈÄÄË¥ß", cause: "‰∫ßÂìÅË¥®ÈáèÈóÆÈ¢òÊàñÂîÆÂêéÊúçÂä°Á≥üÁ≥ïÂØºËá¥Ë¥üÈù¢Êñ∞Èóª", strategy: "Á´ãÂç≥ÂèëË°®ÈÅìÊ≠âÂ£∞ÊòéÔºåÊó†Êù°‰ª∂ 100% ÁêÜËµîÔºåÂπ∂Â∞ΩÂø´ÊîπËøõ QC" }
                }
            },

            // 2. Supply & Production Risk
            drought: {
                category: 2,
                label: { th: "‡∏†‡∏±‡∏¢‡πÅ‡∏•‡πâ‡∏á‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (Drought)", cn: "‰∏•ÈáçÂπ≤Êó±" },
                apply: (d) => ({ ...d, paddyPrice: d.paddyPrice * 1.25 }),
                math_desc: { th: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å +25%", cn: "Á®ªË∞∑ÊàêÊú¨ +25%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏û‡∏∏‡πà‡∏á 25%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏ö‡∏≤‡∏á‡πÄ‡∏â‡∏µ‡∏¢‡∏ö", cause: "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏î‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", strategy: "‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Futures) ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ)" },
                    cn: { impact: "ÂéüÊùêÊñôÊàêÊú¨È£ôÂçá 25%ÔºåÂà©Ê∂¶ÂæÆËñÑ", cause: "Áî±‰∫éÂ§©Ê∞îÂéüÂõ†Á®ªË∞∑‰∫ßÈáè‰∏ãÈôç", strategy: "ÈîÅÂÆöËøúÊúüË¥≠‰π∞‰ª∑Ê†º (Futures) ÊàñÊèêÈ´òÁªàÁ´Ø‰∫ßÂìÅÂîÆ‰ª∑ (Â¶ÇÊûúÂèØËÉΩ)" }
                }
            },
            machine_break: {
                category: 2,
                label: { th: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏±‡∏á (Machine Break)", cn: "Êú∫Âô®ÊïÖÈöú" },
                apply: (d) => ({ ...d, yield: d.yield * 0.95, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 50000 } }),
                math_desc: { th: "Yield -5%, ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏° +50,000", cn: "Âá∫Á±≥Áéá -5%, Áª¥‰øÆË¥π +50,000" },
                analysis: {
                    th: { impact: "Yield ‡∏ï‡∏Å 5%, ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô", cause: "‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö (Preventive Maintenance)", strategy: "‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏™‡∏≥‡∏£‡∏≠‡∏á (Spare Parts) ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏ß‡πâ‡πÄ‡∏™‡∏°‡∏≠" },
                    cn: { impact: "‰∫ßÈáè‰∏ãÈôç 5%Ôºå‰∫ßÁîüÁ¥ßÊÄ•Áª¥‰øÆË¥π", cause: "Áº∫‰πèÂÆöÊúüÈ¢ÑÈò≤ÊÄßÁª¥Êä§ (Preventive Maintenance)", strategy: "Âà∂ÂÆöÊèêÂâçÁª¥Êä§ËÆ°ÂàíÔºåÂπ∂ÂßãÁªàÂáÜÂ§áÂÖ≥ÈîÆÂ§á‰ª∂ (Spare Parts)" }
                }
            },
            pack_cost: {
                category: 2,
                label: { th: "‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ç‡∏∂‡πâ‡∏ô (Pack Cost)", cn: "ÂåÖË£ÖÊàêÊú¨‰∏äÊ∂®" },
                apply: (d) => ({ ...d, unit: { bag: d.unit.bag * 1.5, sticker: d.unit.sticker * 1.5 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡∏ñ‡∏∏‡∏á/‡∏Å‡∏•‡πà‡∏≠‡∏á +50%", cn: "ÂåÖË£ÖË¢ã/Ë¥¥Á∫∏ÊàêÊú¨ +50%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏ñ‡∏∏‡∏á‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å", cause: "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÇ‡∏•‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤", strategy: "‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å (Mass Lot) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏™‡πÄ‡∏õ‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡∏ñ‡∏∏‡∏á‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢" },
                    cn: { impact: "ÊØèË¢ãÊàêÊú¨Â§ßÂπÖ‰∏äÂçá", cause: "ÂÖ®ÁêÉÊ≤π‰ª∑‰∏äÊ∂®ÊàñÂ°ëÊñôÂéÇÊèê‰ª∑", strategy: "Â§ßÈáèËÆ¢Ë¥≠ (Mass Lot) ‰ª•ËÆÆ‰ª∑ÔºåÊàñÁ®çÂæÆÈôç‰ΩéË¢ãÂ≠êÂéöÂ∫¶ËßÑÊ†º" }
                }
            },
            energy_crisis: {
                category: 2,
                label: { th: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (Energy Crisis)", cn: "ËÉΩÊ∫êÂç±Êú∫" },
                apply: (d) => ({ ...d, varParams: { ...d.varParams, elecRate: d.varParams.elecRate * 1.4 }, logistics: { ...d.logistics, profit: d.logistics.profit * 0.5 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü +40%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á -50%", cn: "ÁîµË¥π +40%, ËøêËæìÂà©Ê∂¶ -50%" },
                analysis: {
                    th: { impact: "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏û‡∏∏‡πà‡∏á 40%, ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏´‡∏≤‡∏¢‡∏Ñ‡∏£‡∏∂‡πà‡∏á", cause: "‡∏Ñ‡πà‡∏≤ Ft ‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏µ‡πÄ‡∏ã‡∏•", strategy: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Solar Rooftop ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏ß‡∏¥‡πà‡∏á‡∏£‡∏ñ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡πâ‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" },
                    cn: { impact: "ÁîµË¥πÈ£ôÂçá 40%ÔºåËøêËæìÂà©Ê∂¶ÂáèÂçä", cause: "Ft Ë¥πÁî®‰∏äÊ∂®ÂíåÊü¥Ê≤π‰ª∑Ê†ºË∞ÉÊï¥", strategy: "ÂÆâË£ÖÂ±ãÈ°∂Â§™Èò≥ËÉΩ‰ª•ÈïøÊúüÈôç‰ΩéÁîµË¥πÔºåÂπ∂‰ºòÂåñËøêËæìËΩ¶Ê¨°‰ª•ÂÆûÁé∞ÊúÄÂ§ßÊïàÁõä" }
                }
            },

            // 3. Financial Risk
            rate_hike: {
                category: 3,
                label: { th: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô (Rate Hike)", cn: "Âä†ÊÅØ" },
                apply: (d) => ({ ...d, loan: { ...d.loan, rate: 9 } }),
                math_desc: { th: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 9%", cn: "Ë¥∑Ê¨æÂà©ÁéáË∞ÉËá≥ 9%" },
                analysis: {
                    th: { impact: "‡∏†‡∏≤‡∏£‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ï‡∏±‡∏ß", cause: "‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢", strategy: "‡∏£‡∏µ‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå (Refinance) ‡∏´‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡πà‡∏á‡πÇ‡∏õ‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢" },
                    cn: { impact: "Âà©ÊÅØË¥üÊãÖÂá†‰πéÁøªÂÄç", cause: "Â§ÆË°å‰∏äË∞ÉÊîøÁ≠ñÂà©Áéá", strategy: "ÂÜçËûçËµÑ (Refinance) ÂØªÊâæÂõ∫ÂÆöÂà©ÁéáÔºåÊàñÂä†ÈÄüÂÅøËøòÊú¨Èáë‰ª•ÂáèÂ∞ëÂà©ÊÅØË¥üÊãÖ" }
                }
            },
            credit_crunch: {
                category: 3,
                label: { th: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πâ‡∏≤ (Credit Crunch)", cn: "‰ø°Ë¥∑Á¥ßÁº©" },
                apply: (d) => ({ ...d, creditTerm: 60 }),
                math_desc: { th: "‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏ó‡∏≠‡∏° = 60 ‡∏ß‡∏±‡∏ô", cn: "‰ø°Áî®Êúü = 60 Â§©" },
                analysis: {
                    th: { impact: "‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≤‡∏î‡∏°‡∏∑‡∏≠‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô 2 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", cause: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÑ‡∏°‡πà‡∏î‡∏µ ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏î‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á", strategy: "‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (Cash Discount) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Ç‡∏∂‡πâ‡∏ô" },
                    cn: { impact: "Áé∞ÈáëÊµÅÁº∫Âè£Ëææ 2 ‰∏™Êúà", cause: "ÁªèÊµé‰∏çÊôØÊ∞îÔºåÂêà‰Ωú‰ºô‰º¥Áº∫‰πèÊµÅÂä®ÊÄß", strategy: "‰∏∫Âø´ÈÄü‰ªòÊ¨æËÄÖÊèê‰æõÁé∞ÈáëÊäòÊâ£ (Cash Discount)ÔºåÂπ∂Êõ¥‰∏•Ê†ºÂú∞Á≠õÈÄâÂÆ¢Êà∑‰ø°Áî®" }
                }
            },
            tax_fine: {
                category: 3,
                label: { th: "‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ (Tax Fine)", cn: "Á®éÂä°ÁΩöÊ¨æ" },
                apply: (d) => ({ ...d, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 100000 } }),
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ +100,000", cn: "ÂÖ∂‰ªñË¥πÁî® +100,000" },
                analysis: {
                    th: { impact: "‡πÇ‡∏î‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö 100,000 ‡∏ö‡∏≤‡∏ó ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ", cause: "‡∏¢‡∏∑‡πà‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö", strategy: "‡∏à‡πâ‡∏≤‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (ERP) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Human Error" },
                    cn: { impact: "Ë¢´ÁΩöÊ¨æ 100,000 Ê≥∞Èì¢ÔºåÂΩ±ÂìçÊú¨ÊúàÂà©Ê∂¶", cause: "Êä•Á®éÈîôËØØÊàñÊñá‰ª∂‰∏çÂÖ®", strategy: "ËÅòËØ∑‰∏ì‰∏ö‰ºöËÆ°Â∏à‰∫ãÂä°ÊâÄÔºåÂπ∂‰ΩøÁî®‰ºöËÆ°ËΩØ‰ª∂ (ERP) ‰ª•ÂáèÂ∞ë‰∫∫‰∏∫ÈîôËØØ" }
                }
            },
            inflation: {
                category: 3,
                label: { th: "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡∏û‡∏∏‡πà‡∏á (Inflation)", cn: "ÈÄöË¥ßËÜ®ËÉÄ" },
                apply: (d) => {
                     // Need to map HR array to increase salary
                     const newHr = d.hr.map(h => ({ ...h, salary: h.salary * 1.1 }));
                     return { ...d, hr: newHr, paddyPrice: d.paddyPrice * 1.1, unit: { bag: d.unit.bag * 1.1, sticker: d.unit.sticker * 1.1 } };
                },
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏Ç‡πâ‡∏≤‡∏ß/‡∏ñ‡∏∏‡∏á +10%", cn: "Â∑•ËµÑ/Â§ßÁ±≥/ÂåÖË£Ö +10%" },
                analysis: {
                    th: { impact: "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 10% ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô", cause: "‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏°‡∏´‡∏†‡∏≤‡∏Ñ", strategy: "‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Reprice) ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Shrinkflation) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Å‡∏≥‡πÑ‡∏£" },
                    cn: { impact: "ÊâÄÊúâÊàêÊú¨ÂêåÊó∂‰∏äÊ∂® 10%", cause: "ÂÆèËßÇÁªèÊµéÁä∂ÂÜµ", strategy: "ÂøÖÈ°ªÊèê‰ª∑ (Reprice) ÊàñÁº©Â∞èÂïÜÂìÅÂ∞∫ÂØ∏ (Shrinkflation) ‰ª•‰øùÊåÅÂà©Ê∂¶" }
                }
            },

            // 4. Operational Risk
            staff_turnover: {
                category: 4,
                label: { th: "‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏≠‡∏≠‡∏Å (Staff Turnover)", cn: "ÂëòÂ∑•ÊµÅÂ§±" },
                apply: (d) => {
                     const newHr = d.hr.map(h => ({ ...h, salary: h.salary * 1.1 })); // Hire new staff expensive
                     return { ...d, hr: newHr, targetBags: d.targetBags * 0.9, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 20000 } };
                },
                math_desc: { th: "‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á +10%, ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -10%, ‡∏Ñ‡πà‡∏≤‡∏´‡∏≤‡∏Ñ‡∏ô +20,000", cn: "Â∑•ËµÑ +10%, ÈîÄÂîÆ -10%, ÊãõËÅòË¥π +20,000" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏Å 10%, ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÅ‡∏û‡∏á‡∏Ç‡∏∂‡πâ‡∏ô", cause: "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏°‡∏î‡πÑ‡∏ü ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏î‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏±‡∏ß", strategy: "‡∏™‡∏£‡πâ‡∏≤‡∏á Career Path ‡πÉ‡∏´‡πâ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ Incentive ‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Performance-based)" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ù‰∏ãÈôç 10%ÔºåÂ∑•ËµÑÊàêÊú¨‰∏äÂçá", cause: "ÂëòÂ∑•ÂÄ¶ÊÄ†ÊàñË¢´ÊåñËßí", strategy: "‰∏∫ÂëòÂ∑•Âª∫Á´ãËÅå‰∏öÂèëÂ±ïË∑ØÂæÑ (Career Path)ÔºåÂπ∂Êèê‰æõÂü∫‰∫éÁª©ÊïàÁöÑÊøÄÂä± (Incentive)" }
                }
            },
            fraud: {
                category: 4,
                label: { th: "‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (Fraud)", cn: "ÂÜÖÈÉ®Ê¨∫ËØà" },
                apply: (d) => ({ ...d, yield: d.yield * 0.9 }), // Yield drops effectively simulates stock loss
                math_desc: { th: "Yield ‡∏´‡∏≤‡∏¢ 10% (Stock Loss)", cn: "Âá∫Á±≥Áéá -10% (Â∫ìÂ≠òÊçüÂ§±)" },
                analysis: {
                    th: { impact: "Yield ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ 10% (‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏≤‡∏¢)", cause: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡∏•‡∏∞‡∏´‡∏•‡∏ß‡∏°", strategy: "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î‡∏à‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥ Stock Count ‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° (Surprise Check)" },
                    cn: { impact: "‰∫ßÈáèÊçüÂ§± 10% (Â§ßÁ±≥Â§±Ë∏™)", cause: "ÂÜÖÈÉ®ÊéßÂà∂Á≥ªÁªüÊùæÊáà", strategy: "Âú®Áß∞ÈáçÂ§ÑÂÆâË£ÖÈó≠Ë∑ØÁîµËßÜÔºåÂπ∂ÊØèÂë®ËøõË°åÈöèÊú∫Â∫ìÂ≠òÁõòÁÇπ (Surprise Check)" }
                }
            },
            warehouse_pest: {
                category: 4,
                label: { th: "‡∏°‡∏≠‡∏î/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô (Pest/Moisture)", cn: "Ëô´ÂÆ≥/ÊΩÆÊπø" },
                apply: (d) => ({ ...d, fixedParams: { ...d.fixedParams, other: d.fixedParams.other + 50000 }, yield: d.yield * 0.98 }),
                math_desc: { th: "Yield -2%, ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ +50,000", cn: "Âá∫Á±≥Áéá -2%, Â§ÑÁêÜË¥π +50,000" },
                analysis: {
                    th: { impact: "‡πÄ‡∏™‡∏µ‡∏¢‡∏Ñ‡πà‡∏≤‡∏£‡∏°‡∏¢‡∏≤ 50k, ‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", cause: "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÇ‡∏Å‡∏î‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô", strategy: "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö FIFO (‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î" },
                    cn: { impact: "ÊçüÂ§± 5‰∏áÁÜèËí∏Ë¥πÔºåÂ§ßÁ±≥ÂèóÊçü", cause: "‰ªìÂ∫ìÂÇ®Â≠ò‰∏çËææÊ†á", strategy: "ÊîπÂñÑÈÄöÈ£éÁ≥ªÁªüÔºåÂπ∂‰∏•Ê†ºÊâßË°å FIFO (ÂÖàËøõÂÖàÂá∫) Á≥ªÁªü" }
                }
            },
            platform_ban: {
                category: 4,
                label: { th: "‡πÇ‡∏î‡∏ô‡πÅ‡∏ö‡∏ô‡∏£‡πâ‡∏≤‡∏ô (Platform Ban)", cn: "Âπ≥Âè∞Â∞ÅÂè∑" },
                apply: (d) => ({ ...d, targetBags: d.targetBags * 0.5 }),
                math_desc: { th: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ -50%", cn: "ÈîÄÂîÆÈ¢ù -50%" },
                analysis: {
                    th: { impact: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏´‡∏≤‡∏¢‡∏ß‡∏π‡∏ö 50% ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", cause: "‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏Å‡∏é‡∏ä‡∏∏‡∏°‡∏ä‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏•‡∏ü‡πå‡∏ú‡∏¥‡∏î‡∏Å‡∏é", strategy: "‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏õ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á (Omni-channel) ‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏£‡∏ô‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠" },
                    cn: { impact: "ÈîÄÂîÆÈ¢ùÁ´ãÂç≥Êö¥Ë∑å 50%", cause: "ËøùÂèçÁ§æÂå∫ÂáÜÂàôÊàñÁõ¥Êí≠ËøùËßÑ", strategy: "ÈÄöËøáÂÖ®Ê∏†ÈÅì (Omni-channel) ÂàÜÊï£Êî∂ÂÖ•ÔºåÂπ∂ÂÆöÊúüÂüπËÆ≠Âõ¢ÈòüÊúâÂÖ≥Ê≥ïËßÑ" }
                }
            }
        };

        // --- Initial Data ---
        const INITIAL = {
            regCapital: 12000000,
            loan: { amount: 0, rate: 5, term: 5 },
            // ... (keep existing) ...
            maxCapacity: 30000, // Added Max Capacity
            capex: { factory: 7000000, machine: 1300000, license: 200000, stock: 1000000 },
            depreciation: { factoryYears: 20, machineYears: 10 }, 
            targetBags: 20000, price: 389,
            creditTerm: 0, 
            yield: 60, paddyPrice: 12000,
            byProducts: [
                { id: "prod_husk", name: "‡πÅ‡∏Å‡∏•‡∏ö", percent: 23, price: 1500 },
                { id: "prod_fine", name: "‡∏£‡∏≥‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", percent: 10, price: 9000 },
                { id: "prod_rough", name: "‡∏£‡∏≥‡∏´‡∏¢‡∏≤‡∏ö", percent: 2, price: 9000 },
                { id: "prod_broken", name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏±‡∏Å", percent: 2, price: 14000 },
                { id: "prod_waste", name: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢", percent: 1, price: 0 },
            ],
            unit: { bag: 6.5, sticker: 2.0 },
            hr: [
                { role: "CEO/MD", count: 1, salary: 50000 },
                { role: "Plant Manager", count: 1, salary: 35000 },
                { role: "Production Staff", count: 4, salary: 15000 },
                { role: "Admin/Account", count: 1, salary: 20000 },
                { role: "Sales/Marketing", count: 2, salary: 17775 }
            ],
            varParams: { elecRate: 600, mktPercent: 14, platformPercent: 12, returnRate: 1 },
            fixedParams: { erp: 9000, campaign: 41000, other: 10000, maintPercent: 2, insurance: 60000, audit: 5000, travel: 10000 },
            // Campaign Breakdown Details
            campaignDetails: [
                { id: "camp_gold1", name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á 1 ‡∏™‡∏•‡∏∂‡∏á", qty: 1, costPerUnit: 16500 },
                { id: "camp_gold2", name: "‡∏•‡∏∏‡πâ‡∏ô‡∏ó‡∏≠‡∏á ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏™‡∏•‡∏∂‡∏á", qty: 2, costPerUnit: 8500 },
                { id: "camp_free", name: "‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ü‡∏£‡∏µ 1 ‡∏õ‡∏µ", qty: 3, costPerUnit: 2500 }
            ],
            logistics: { active: true, percent: 50, profit: 5 },
            dividend: { payout: 50, founders: 3 },
            growth: 10, inflation: 3, monthlyGrowth: 0, discountRate: 10,
            // New Funnel Assumptions
            mktFunnel: { basketSize: 1.0, cvr: 2.0, ctr: 1.5 },
            scenario: 'base', taxPaymentMode: 'annual',
            // --- NEW FEATURES ---
            clvParams: { freq: 4, retention: 60 },
            channelMix: { tiktok: 80, shopee: 10, offline: 10 },
            channelFees: { tiktok: 12, shopee: 8, offline: 0 },
            elasticityParams: { coefficient: 1.5 }, // Price Elasticity of Demand
            seasonalShock: { active: false, startM: 5, endM: 8, costImpact: 20 }
        };

        const App = () => {
            const [toast, setToast] = useState(null); // Notification state
            const [lang, setLang] = useState('th'); // Language State: 'th' or 'cn'
            const [activeSim, setActiveSim] = useState(null); // Active Simulation Key
            const [backupD, setBackupD] = useState(null); // Backup state for simulation revert

            // Modified translation helper with safety check
            const t = (key) => {
                if (!TRANS[lang]) return key;
                return TRANS[lang][key] || key;
            };

            const [d, setD] = useState(() => {
                try {
                    // 1. Check URL Parameters first
                    const params = new URLSearchParams(window.location.search);
                    const sharedData = params.get('data');
                    if (sharedData) {
                        const parsed = JSON.parse(fromBase64(sharedData));
                        // Ensure compatibility with potentially older shared links
                        if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                        // Default insurance if missing
                        if (parsed.fixedParams && parsed.fixedParams.insurance === undefined) {
                            parsed.fixedParams.insurance = 60000;
                        }
                        // Default audit/travel if missing
                        if (parsed.fixedParams && parsed.fixedParams.audit === undefined) parsed.fixedParams.audit = 5000;
                        if (parsed.fixedParams && parsed.fixedParams.travel === undefined) parsed.fixedParams.travel = 10000;

                        // Default new features
                        if (!parsed.clvParams) parsed.clvParams = INITIAL.clvParams;
                        if (!parsed.channelMix) parsed.channelMix = INITIAL.channelMix;
                        if (!parsed.channelFees) parsed.channelFees = INITIAL.channelFees;
                        if (!parsed.elasticityParams) parsed.elasticityParams = INITIAL.elasticityParams;
                        if (!parsed.seasonalShock) parsed.seasonalShock = INITIAL.seasonalShock;
                        if (!parsed.maxCapacity) parsed.maxCapacity = INITIAL.maxCapacity; // Default Max Cap
                        return parsed;
                    }

                    // 2. Fallback to LocalStorage - Use NEW KEY v43 to force fresh state
                    const savedData = localStorage.getItem('morbSukFinancialData_v43'); 
                    let parsed = savedData ? JSON.parse(savedData) : INITIAL;
                    if (!parsed.campaignDetails) parsed.campaignDetails = INITIAL.campaignDetails;
                      // Default insurance if missing
                    if (parsed.fixedParams && parsed.fixedParams.insurance === undefined) {
                        parsed.fixedParams.insurance = 60000;
                    }
                    if (parsed.fixedParams && parsed.fixedParams.audit === undefined) parsed.fixedParams.audit = 5000;
                    if (parsed.fixedParams && parsed.fixedParams.travel === undefined) parsed.fixedParams.travel = 10000;

                    // Default new features
                    if (!parsed.clvParams) parsed.clvParams = INITIAL.clvParams;
                    if (!parsed.channelMix) parsed.channelMix = INITIAL.channelMix;
                    if (!parsed.channelFees) parsed.channelFees = INITIAL.channelFees;
                    if (!parsed.elasticityParams) parsed.elasticityParams = INITIAL.elasticityParams;
                    if (!parsed.seasonalShock) parsed.seasonalShock = INITIAL.seasonalShock;
                    if (!parsed.maxCapacity) parsed.maxCapacity = INITIAL.maxCapacity; // Default Max Cap
                    
                    // 3. Migrate old data to have IDs for translation if missing
                    parsed.byProducts = parsed.byProducts.map((p, i) => (!p.id ? { ...p, id: INITIAL.byProducts[i]?.id } : p));
                    parsed.campaignDetails = parsed.campaignDetails.map((c, i) => (!c.id ? { ...c, id: INITIAL.campaignDetails[i]?.id } : c));

                    return parsed;
                } catch (e) { 
                    console.error("Data load error:", e);
                    return INITIAL; 
                }
            });
            const [c, setC] = useState(null); 

            useEffect(() => { 
                localStorage.setItem('morbSukFinancialData_v43', JSON.stringify(d)); 
            }, [d]);

            const resetToDefault = () => {
                if (confirm("Reset all data to default?")) { 
                    setD(INITIAL); 
                    setActiveSim(null);
                    setBackupD(null);
                    localStorage.removeItem('morbSukFinancialData_v43'); 
                    // Clear URL params without reload
                    window.history.pushState({}, document.title, window.location.pathname);
                }
            };

            const handleSimulate = (key) => {
                if (activeSim === key) {
                    // STOP SIMULATION
                    if (backupD) {
                        setD(backupD); // Restore exactly what was there
                        setBackupD(null);
                    } else {
                        applyScenario('base'); // Fallback only if no backup
                    }
                    setActiveSim(null);
                } else {
                    // START OR SWITCH SIMULATION
                    let baseState;
                    
                    if (activeSim && backupD) {
                        // Switching from one risk to another: Use original backup as base
                        baseState = backupD;
                    } else {
                        // Starting new risk from normal state: Create backup
                        baseState = JSON.parse(JSON.stringify(d)); // Deep clone
                        setBackupD(baseState);
                    }
                    
                    const newD = SCENARIOS[key].apply(baseState);
                    setD(newD);
                    setActiveSim(key);
                    setToast(`Activated: ${SCENARIOS[key].label[lang]}`);
                    setTimeout(() => setToast(null), 3000);
                }
            };

            const handleShare = () => {
                try {
                    const jsonString = JSON.stringify(d);
                    const encoded = toBase64(jsonString);
                    const url = `${window.location.origin}${window.location.pathname}?data=${encoded}`;
                    
                    navigator.clipboard.writeText(url).then(() => {
                        setToast("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (Copied!)");
                        setTimeout(() => setToast(null), 3000);
                        // Update browser URL to reflect current state
                        window.history.pushState({}, document.title, `?data=${encoded}`);
                    });
                } catch (e) {
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå");
                }
            };

            const handlePrint = () => window.print();
            
            const handleExport = () => {
                if(!c) return;
                let csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "Year,Revenue,Expenses,EBITDA,Depreciation,Tax,Net Profit,Dividend,Cash Balance\n";
                c.yrProj.data.forEach(row => {
                    csvContent += `${row.y},${row.rev},${row.exp},${row.ebitda},${row.dep},${row.tax},${row.net},${row.div},${row.cash}\n`;
                });
                csvContent += "\nMonthly Year 1\nMonth,Cash Inflow (Rev),Expense(Cash),EBITDA,Tax Paid,Cash Balance\n";
                c.cf.forEach(row => {
                    csvContent += `${row.m},${row.revCashIn},${row.expCash},${row.netOpCash},${row.tax},${row.cashFinal}\n`;
                });

                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "financial_projection_pro.csv");
                document.body.appendChild(link);
                link.click();
            };

            const applyScenario = (type) => {
                let newData = { ...d, scenario: type };
                
                // Note: We don't reset price here anymore because this function is ONLY for the Scenario buttons (Base/Worst/Best)
                // which explicitly set their own defaults below.
                
                if (type === 'worst') { newData.targetBags = 14000; newData.paddyPrice = 13500; newData.growth = 0; newData.varParams.mktPercent = 18; } 
                else if (type === 'base') { newData.targetBags = 20000; newData.paddyPrice = 12000; newData.growth = 10; newData.varParams.mktPercent = 14; } 
                else if (type === 'best') { newData.targetBags = 25000; newData.paddyPrice = 11500; newData.growth = 15; newData.varParams.mktPercent = 12; }
                
                setD(newData);
                setActiveSim(null); // Reset risk sim if changing scenario
                setBackupD(null);   // Clear backup since we changed baseline
            };

            const up = (k, sk, v) => setD(p => ({...p, [k]: sk ? {...p[k], [sk]: +v} : +v}));
            const upArr = (k, i, f, v) => {
                // If user edits name, remove ID so translation stops overriding user input
                const n = [...d[k]]; 
                if (f === 'name') delete n[i].id;
                n[i][f] = f==='name'||f==='role'?v:+v; 
                setD(p=>({...p, [k]: n}));
            };
            const upFunnel = (k, v) => setD(p => ({...p, mktFunnel: {...p.mktFunnel, [k]: +v}}));

            const upCampaign = (idx, field, val) => {
                setD(prev => {
                    const newDetails = [...prev.campaignDetails];
                    // If user edits name, remove ID
                    if (field === 'name') delete newDetails[idx].id;
                    
                    newDetails[idx][field] = field === 'name' ? val : +val;
                    
                    const newTotal = newDetails.reduce((sum, item) => sum + (item.qty * item.costPerUnit), 0);
                    
                    return {
                        ...prev,
                        campaignDetails: newDetails,
                        fixedParams: { ...prev.fixedParams, campaign: newTotal }
                    };
                });
            };

            const upNew = (category, field, val) => {
                setD(prev => ({
                    ...prev,
                    [category]: { ...prev[category], [field]: +val }
                }));
            };

            const handleYieldChange = (e) => {
                const newYield = parseFloat(e.target.value);
                setD(prev => {
                    const currentByProdSum = prev.byProducts.reduce((sum, item) => sum + item.percent, 0);
                    const totalSolidMass = prev.yield + currentByProdSum; 
                    let newByProdTarget = totalSolidMass - newYield;
                    if (newByProdTarget < 0) newByProdTarget = 0; 
                    const ratio = currentByProdSum > 0 ? newByProdTarget / currentByProdSum : 0;
                    const newByProducts = prev.byProducts.map(item => ({
                        ...item,
                        percent: parseFloat((item.percent * ratio).toFixed(2))
                    }));
                    return { ...prev, yield: newYield, byProducts: newByProducts };
                });
            };

            const calculateFinancials = (data) => {
                const totalCapex = Object.values(data.capex).reduce((a,b)=>a+b,0);
                const totalSources = data.regCapital + (data.loan.amount || 0);
                const workingCap = totalSources - totalCapex;
                const annualDepreciation = (data.capex.factory / data.depreciation.factoryYears) + (data.capex.machine / data.depreciation.machineYears);

                // Maintenance
                const maintPercent = (data.fixedParams.maintPercent !== undefined && data.fixedParams.maintPercent !== null) ? data.fixedParams.maintPercent : 2;
                const maintenanceCostYearly = data.capex.machine * (maintPercent / 100);
                const maintenanceCostMonthly = maintenanceCostYearly / 12;

                // Insurance (Yearly to Monthly)
                const insuranceYearly = (data.fixedParams.insurance !== undefined) ? data.fixedParams.insurance : 60000;
                const insuranceMonthly = insuranceYearly / 12;

                const dayTarget = data.targetBags / 30;
                const hourTarget = dayTarget / 24; 
                const riceRev = data.targetBags * data.price;
                
                const paddyTons = (data.targetBags * 5) / (data.yield/100) / 1000;
                const paddyBudget = paddyTons * data.paddyPrice;
                let totalByProductIncome = 0;
                const byProductsCalc = data.byProducts.map(item => {
                    const weight = paddyTons * (item.percent / 100);
                    const revenue = weight * item.price;
                    totalByProductIncome += revenue;
                    return { ...item, weight, revenue };
                });

                const logIncome = (data.targetBags * (data.logistics.percent/100)) * data.logistics.profit;

                // Refund Logic
                const refundTotal = riceRev * ((data.varParams.returnRate || 0) / 100);

                // VAT Logic
                // Base revenue for VAT should be net of refunds
                const baseRev = (riceRev - refundTotal) + totalByProductIncome + logIncome; 
                const totalVatOut = baseRev - (baseRev / 1.07);

                // Channel Mix Calculation
                const cm = data.channelMix || { tiktok: 80, shopee: 10, offline: 10 };
                const cFees = data.channelFees || { tiktok: 12, shopee: 8, offline: 0 }; 
                const blendedFeePct = (cm.tiktok * cFees.tiktok + cm.shopee * cFees.shopee + cm.offline * cFees.offline) / 100;
                const platformTotal = riceRev * (blendedFeePct/100); 

                // Expenses
                const riceTotal = paddyBudget; 
                const packTotal = (data.unit.bag + data.unit.sticker) * data.targetBags; 
                const elecTotal = data.varParams.elecRate * paddyTons; 
                const mktTotal = riceRev * (data.varParams.mktPercent/100); 
                
                const totalMarketingBudget = mktTotal; 

                // HR & SSO
                let baseSalaryTotal = 0;
                let ssoTotal = 0;
                const hrCosts = data.hr.map(h => {
                    const ssoPerPerson = Math.floor(Math.min(h.salary, 15000) * 0.05);
                    const totalPerRole = (h.salary + ssoPerPerson) * h.count;
                    const ssoTotalRole = ssoPerPerson * h.count;
                    baseSalaryTotal += h.salary * h.count;
                    ssoTotal += ssoTotalRole;
                    return { ...h, ssoPerPerson, totalPerRole, ssoTotalRole };
                });
                const salaryTotal = baseSalaryTotal + ssoTotal; 
                
                // Fixed Costs Summation
                const fixedCostItems = 
                    data.fixedParams.erp + 
                    data.fixedParams.campaign + 
                    data.fixedParams.other + 
                    maintenanceCostMonthly + 
                    insuranceMonthly + 
                    (data.fixedParams.audit || 0) + 
                    (data.fixedParams.travel || 0);

                const fixedCashTotal = salaryTotal + fixedCostItems; 

                // Input VAT Calculation
                const vatableExpenses = packTotal + elecTotal + platformTotal + mktTotal;
                const totalVatIn = vatableExpenses - (vatableExpenses / 1.07);
                
                const totalVar = riceTotal + packTotal + elecTotal + platformTotal + mktTotal; 
                const section7Total = elecTotal + platformTotal + mktTotal + fixedCostItems;

                const riceCostUnit = (5 / (data.yield/100)) * (data.paddyPrice/1000);
                const matCostUnit = riceCostUnit + data.unit.bag + data.unit.sticker;

                // Marketing Funnel
                const basketSize = data.mktFunnel?.basketSize || 1;
                const cvr = data.mktFunnel?.cvr || 2.0;
                const ctr = data.mktFunnel?.ctr || 1.5;

                const totalOrders = data.targetBags / basketSize;
                const cpa = totalMarketingBudget / totalOrders; 
                const visitorsNeeded = totalOrders / (cvr / 100);
                const impressionsNeeded = visitorsNeeded / (ctr / 100);
                const impliedCPC = totalMarketingBudget / visitorsNeeded;
                const impliedCPM = (totalMarketingBudget / impressionsNeeded) * 1000;

                const roas = totalMarketingBudget > 0 ? riceRev / totalMarketingBudget : 0;
                const acos = riceRev > 0 ? (totalMarketingBudget / riceRev) * 100 : 0;

                // Breakeven ROAS Calculation
                const varCostPerUnit = matCostUnit + (data.varParams.elecRate * (5 / (data.yield/100)) / 1000) + (data.price * blendedFeePct/100);
                const marginPerUnit = data.price - varCostPerUnit;
                const beRoasVal = marginPerUnit > 0 ? data.price / marginPerUnit : 999;

                // CLV Calculation
                const clvP = data.clvParams || { freq: 4, retention: 60 };
                const grossMarginPct = riceRev > 0 ? ((riceRev - (riceTotal + packTotal + elecTotal + salaryTotal)) / riceRev) : 0; 
                const aov = basketSize * data.price;
                const retention = clvP.retention / 100;
                const ltv1 = (aov * clvP.freq * grossMarginPct); 
                const ltv3 = ltv1 * 3; 
                const churn = 1 - retention;
                const lifetimeValue = churn > 0 ? (ltv1 / churn) : 0; 
                const ltvCac = cpa > 0 ? lifetimeValue / cpa : 0;

                // Elasticity Simulation Data
                const elasticityData = [];
                const baseVol = data.targetBags;
                const baseP = data.price;
                const coef = data.elasticityParams?.coefficient || 1.5;
                
                [-20, -10, 0, 10, 20].forEach(change => {
                    const newP = baseP * (1 + change/100);
                    const qtyChange = (change/100) * -coef;
                    const newVol = baseVol * (1 + qtyChange);
                    const newRev = newP * newVol;
                    elasticityData.push({
                        pct: `${change > 0 ? '+' : ''}${change}%`,
                        price: newP,
                        vol: newVol,
                        rev: newRev
                    });
                });

                const funnelMetrics = {
                    budget: totalMarketingBudget,
                    orders: totalOrders,
                    cpa: cpa,
                    visitors: visitorsNeeded,
                    cpc: impliedCPC,
                    impressions: impressionsNeeded,
                    cpm: impliedCPM,
                    roas: roas, 
                    acos: acos, 
                    gmv: riceRev,
                    beRoas: beRoasVal,
                    ltv1, ltv3, ltvCac, lifetimeValue
                };

                const accruedRev = [];
                for(let k=1; k<=24; k++) {
                   const growthFactor = Math.pow(1 + data.monthlyGrowth/100, k - 1);
                   accruedRev.push(baseRev * growthFactor);
                }
                const dailyRevs = [0, ...accruedRev].map(r => r/30); 

                const cf = [];
                let runningCash = workingCap; 
                let annualOperatingCashProfit = 0; 
                let annualFinanceCost = 0; 
                let annualPrincipalPaid = 0;
                let lowestCashBalance = workingCap; 

                let remainingLoanPrincipal = data.loan.amount;
                const monthlyPrincipalPayment = data.loan.amount > 0 ? data.loan.amount / (data.loan.term * 12) : 0; 

                const creditTermDays = parseInt(data.creditTerm || 0);
                const season = data.seasonalShock || { active: false, startM: 5, endM: 8, costImpact: 20 };

                for(let i=1; i<=12; i++) {
                    const mRev = accruedRev[i-1]; 
                    
                    let cashInflow = 0;
                    const currentMonthStartCashDay = (i-1)*30 + 1;
                    const currentMonthEndCashDay = i*30;

                    const startSalesDay = currentMonthStartCashDay - creditTermDays;
                    const endSalesDay = currentMonthEndCashDay - creditTermDays;

                    const maxLookBack = Math.ceil(creditTermDays/30) + 1;
                    const startSourceM = Math.max(1, i - maxLookBack);
                    
                    for(let srcM = startSourceM; srcM <= i; srcM++) {
                        const mStart = (srcM-1)*30 + 1;
                        const mEnd = srcM*30;
                        const overlapStart = Math.max(startSalesDay, mStart);
                        const overlapEnd = Math.min(endSalesDay, mEnd);
                        if (overlapEnd >= overlapStart) {
                            const daysCount = overlapEnd - overlapStart + 1;
                            cashInflow += daysCount * dailyRevs[srcM]; 
                        }
                    }

                    const growthFactor = Math.pow(1 + data.monthlyGrowth/100, i - 1);
                    
                    // Apply Seasonality to Rice Cost
                    let monthlyRiceCost = riceTotal * growthFactor;
                    if (season.active && i >= season.startM && i <= season.endM) {
                        monthlyRiceCost *= (1 + season.costImpact/100);
                    }

                    const mRice = monthlyRiceCost;
                    const mVatableVar = (packTotal + elecTotal + platformTotal + mktTotal) * growthFactor;
                    const mSalary = salaryTotal;
                    const mVatableFixed = (data.fixedParams.erp + data.fixedParams.campaign + data.fixedParams.other + maintenanceCostMonthly + insuranceMonthly);
                    const mExpCash = mRice + mVatableVar + mSalary + mVatableFixed; 
                    
                    const mOutVat = totalVatOut * growthFactor;
                    const mInVatTotal = totalVatIn * growthFactor;
                    const mVatSettlement = mOutVat - mInVatTotal;
                    
                    const interestThisMonth = remainingLoanPrincipal * (data.loan.rate / 100 / 12);
                    const principalThisMonth = remainingLoanPrincipal > 0 ? monthlyPrincipalPayment : 0;
                    remainingLoanPrincipal -= principalThisMonth;

                    const mNetOpProfit = (mRev - mOutVat) - (mExpCash - mInVatTotal); 

                    annualOperatingCashProfit += mNetOpProfit;
                    annualFinanceCost += interestThisMonth;
                    annualPrincipalPaid += principalThisMonth;

                    const startOfMonthCash = runningCash;
                    const netCashMovement = cashInflow - mExpCash - mVatSettlement - interestThisMonth - principalThisMonth;
                    
                    runningCash += netCashMovement;
                    if(runningCash < lowestCashBalance) lowestCashBalance = runningCash;

                    cf.push({ 
                        m: i, 
                        rev: mRev, 
                        revCashIn: cashInflow, 
                        expCash: mExpCash, 
                        netOpCash: mNetOpProfit, 
                        interest: interestThisMonth, 
                        principal: principalThisMonth, 
                        cashStart: startOfMonthCash, 
                        cashPreTax: runningCash, 
                        vatPaid: mVatSettlement,
                        cashFinal: runningCash 
                    });
                }

                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };

                const taxableIncome = annualOperatingCashProfit - annualDepreciation - annualFinanceCost;
                let taxDetails = [];
                let totalTaxEst = calcTax(taxableIncome);
                
                if (taxableIncome > 0) {
                    if (taxableIncome > 300000) taxDetails.push({ tier: "300k-3M", rate: 15, amount: Math.min(taxableIncome - 300000, 2700000) * 0.15 });
                    if (taxableIncome > 3000000) taxDetails.push({ tier: "> 3M", rate: 20, amount: (taxableIncome - 3000000) * 0.20 });
                }
                
                const monthlyTaxAvg = totalTaxEst / 12;
                const cfFinal = cf.map((item, index) => {
                    let mTax = 0;
                    if (data.taxPaymentMode === 'annual') mTax = index === 11 ? totalTaxEst : 0;
                    else if (data.taxPaymentMode === 'monthly') mTax = monthlyTaxAvg;
                    
                    let finalCumulativeCash = item.cashPreTax;
                    if (data.taxPaymentMode === 'annual') { if (index === 11) finalCumulativeCash -= totalTaxEst; } 
                    else if (data.taxPaymentMode === 'monthly') { finalCumulativeCash -= (monthlyTaxAvg * (index + 1)); }
                    
                    if(finalCumulativeCash < lowestCashBalance) lowestCashBalance = finalCumulativeCash; 

                    return { ...item, tax: mTax, cashFinal: finalCumulativeCash };
                });

                const cfTotal = cfFinal.reduce((acc, cur) => ({
                    rev: acc.rev + cur.rev, 
                    revCashIn: (acc.revCashIn || 0) + cur.revCashIn,
                    expCash: acc.expCash + cur.expCash, netOpCash: acc.netOpCash + cur.netOpCash, 
                    tax: acc.tax + cur.tax, interest: acc.interest + cur.interest, principal: acc.principal + cur.principal, 
                    vatPaid: acc.vatPaid + cur.vatPaid
                }), { rev: 0, revCashIn: 0, expCash: 0, netOpCash: 0, tax: 0, interest: 0, principal: 0, vatPaid: 0 });
                cfTotal.cashFinal = cfFinal[11].cashFinal;

                const annualNetProfitAfterAll = taxableIncome - totalTaxEst; 
                const dividendTotal = annualNetProfitAfterAll > 0 ? annualNetProfitAfterAll * (data.dividend.payout / 100) : 0;
                const dividendPerPersonYear = data.dividend.founders > 0 ? dividendTotal / data.dividend.founders : 0;
                const dividendPerPersonMonth = dividendPerPersonYear / 12;
                const roi = totalSources > 0 ? (annualNetProfitAfterAll / totalSources) * 100 : 0;
                
                const vcTotal = totalVar; 
                const revenueTotal = baseRev;
                const fcTotal = fixedCashTotal;
                const revPerBag = revenueTotal / data.targetBags;
                const vcPerBag = vcTotal / data.targetBags;
                const cmPerBag = revPerBag - vcPerBag; 
                const bepUnits = cmPerBag > 0 ? fcTotal / cmPerBag : 0;
                const bepSales = bepUnits * revPerBag;
                const bepData = [];
                [0, 0.5, 1.0, 1.5].forEach(s => {
                    const units = data.targetBags * s;
                    bepData.push({ units: units, revenue: units * revPerBag, totalCost: fcTotal + (units * vcPerBag), fixedCost: fcTotal });
                });
                if(bepUnits < data.targetBags * 1.5) bepData.push({ units: bepUnits, revenue: bepSales, totalCost: bepSales, fixedCost: fcTotal, isBep: true });
                bepData.sort((a,b) => a.units - b.units);

                const netMargin = (annualNetProfitAfterAll / cfTotal.rev) * 100;
                const grossMargin = ((riceRev - (riceTotal + packTotal + elecTotal + salaryTotal)) / riceRev) * 100;
                const debtService = annualPrincipalPaid + annualFinanceCost;
                const dscr = debtService > 0 ? annualOperatingCashProfit / debtService : (annualOperatingCashProfit > 0 ? 999 : 0);

                let paybackMonth = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô";
                const annualCashFlow = annualOperatingCashProfit - totalTaxEst - annualFinanceCost;
                if (annualCashFlow > 0) {
                      const monthsToPayback = totalSources / (annualCashFlow/12);
                      if (monthsToPayback <= 12) paybackMonth = `${Math.ceil(monthsToPayback)} ${t('month')}`;
                      else paybackMonth = `${(monthsToPayback/12).toFixed(1)} ${t('year')}`;
                }

                const vatBreakdown = {
                    vatableExp: vatableExpenses,
                    inputVat: totalVatIn,
                    outputVat: totalVatOut,
                    netVat: (totalVatOut - totalVatIn) 
                };

                const revBreakdown = {
                    sales: riceRev, byProduct: totalByProductIncome, logistics: logIncome,
                    totalIn: baseRev, vat: totalVatOut,
                    opCost: (totalVar - totalVatOut) + fixedCashTotal,
                    opVar: totalVar - totalVatOut,
                    opFixed: fixedCashTotal,
                    netCash: baseRev - totalVatOut - (totalVar - totalVatOut) - fixedCashTotal,
                    riceCost: riceTotal, packCost: packTotal, feesCost: platformTotal + mktTotal,
                    elecCost: elecTotal, salaryCost: salaryTotal, otherFixed: fixedCostItems,
                    otherDetails: {
                        erp: data.fixedParams.erp,
                        campaign: data.fixedParams.campaign,
                        misc: data.fixedParams.other,
                        maintenance: maintenanceCostMonthly,
                        insurance: insuranceMonthly,
                        audit: data.fixedParams.audit,
                        travel: data.fixedParams.travel
                    }
                };
                
                // Capacity Engine Calculations
                const maxCapacity = data.maxCapacity || 30000;
                const utilizationPct = (data.targetBags / maxCapacity) * 100;
                const fixedCostPerUnit = data.targetBags > 0 ? fixedCashTotal / data.targetBags : 0;
                // Variable Cost Per Unit (Approx for display)
                const varCostPerUnitDisplay = data.targetBags > 0 ? (totalVar - totalVatOut) / data.targetBags : 0;

                return {
                    totalCapex, totalSources, workingCap, dayTarget, hourTarget, paddyTons,
                    annualDepreciation, depFactory: data.capex.factory / data.depreciation.factoryYears, depMachine: data.capex.machine / data.depreciation.machineYears,
                    totalByProductIncome, byProductsCalc, riceCostUnit, matCostUnit, grossRev: riceRev,
                    riceTotal, packTotal, elecTotal, platformTotal, mktTotal, totalVar,
                    salaryTotal, fixedCashTotal, logIncome, hrCosts,
                    ebitda: annualOperatingCashProfit, 
                    annualProfitEst: taxableIncome, annualTax: totalTaxEst, taxDetails, 
                    netProfit: annualNetProfitAfterAll, roi, paybackMonth, netMargin, grossMargin, dscr,
                    bepUnits, bepSales, fcTotal, vcPerBag, revPerBag, bepData,
                    cf: cfFinal, cfTotal, dividendTotal, revBreakdown, vatBreakdown,
                    section7Total, elecTotal, platformTotal, mktTotal,
                    dividendPerPersonYear, dividendPerPersonMonth,
                    annualFinanceCost, annualPrincipalPaid,
                    lowestCashBalance, 
                    funnelMetrics, blendedFeePct, elasticityData,
                    yrProj: null,
                    refundTotal,
                    // Capacity Data
                    utilizationPct, fixedCostPerUnit, varCostPerUnitDisplay
                };
            };

            const sensitivityData = useMemo(() => {
                const results = [];
                const priceSteps = [0.9, 1.0, 1.1]; 
                const volumeSteps = [0.9, 1.0, 1.1]; 
                priceSteps.forEach(pStep => {
                    const row = [];
                    volumeSteps.forEach(vStep => {
                        const tData = JSON.parse(JSON.stringify(d));
                        tData.targetBags = Math.round(d.targetBags * vStep);
                        tData.paddyPrice = Math.round(d.paddyPrice * pStep);
                        const financials = calculateFinancials(tData);
                        row.push({ vLabel: `${(vStep*100-100).toFixed(0)}%`, pLabel: `${(pStep*100-100).toFixed(0)}%`, profit: financials.netProfit });
                    });
                    results.push(row);
                });
                return results;
            }, [d]);

            // NEW: Spread Sensitivity (Paddy Price vs Selling Price)
            const spreadData = useMemo(() => {
                const results = [];
                const paddySteps = [0.9, 1.0, 1.1]; // Row: Paddy Cost -10%, Base, +10%
                const sellPriceSteps = [0.9, 1.0, 1.1]; // Col: Sell Price -10%, Base, +10%
                
                paddySteps.forEach(costStep => {
                    const row = [];
                    sellPriceSteps.forEach(priceStep => {
                        const tData = JSON.parse(JSON.stringify(d));
                        tData.paddyPrice = Math.round(d.paddyPrice * costStep);
                        tData.price = Math.round(d.price * priceStep);
                        const financials = calculateFinancials(tData);
                        row.push({ 
                            cLabel: `${(costStep*100-100).toFixed(0)}%`, 
                            pLabel: `${(priceStep*100-100).toFixed(0)}%`, 
                            profit: financials.netProfit 
                        });
                    });
                    results.push(row);
                });
                return results;
            }, [d]);

            // NEW: Scenario Comparison Data
            const scenarioComparison = useMemo(() => {
                const scenarios = ['worst', 'base', 'best'];
                return scenarios.map(type => {
                    let sData = JSON.parse(JSON.stringify(d)); // Clone current
                    // Apply logic same as applyScenario function
                    if (type === 'worst') { sData.targetBags = 14000; sData.paddyPrice = 13500; sData.growth = 0; sData.varParams.mktPercent = 18; } 
                    else if (type === 'base') { sData.targetBags = 20000; sData.paddyPrice = 12000; sData.growth = 10; sData.varParams.mktPercent = 14; } 
                    else if (type === 'best') { sData.targetBags = 25000; sData.paddyPrice = 11500; sData.growth = 15; sData.varParams.mktPercent = 12; }
                    
                    // We need to re-calculate minimal required fields for profit/cash
                    // To avoid infinite loop or heavy calc, we just call calculateFinancials for each
                    const res = calculateFinancials(sData);
                    return { type, netProfit: res.netProfit, cashFinal: res.cfTotal.cashFinal };
                });
            }, [d]); // Recalc when d changes (base params might change)

            // NEW: Ads Sensitivity Matrix (CVR x CTR => ROAS)
            const adsMatrixData = useMemo(() => {
                if (!c) return [];
                const baseCPM = c.funnelMetrics.cpm || 150; // Fallback to 150 if 0
                const basePrice = d.price;
                const baseBasket = d.mktFunnel.basketSize;
                
                // Rows: CVR (Y-axis) -20%, Base, +20%
                const cvrSteps = [0.8, 1.0, 1.2]; 
                // Cols: CTR (X-axis) -20%, Base, +20%
                const ctrSteps = [0.8, 1.0, 1.2];

                const results = [];
                cvrSteps.forEach(cvrMult => {
                    const row = [];
                    ctrSteps.forEach(ctrMult => {
                        const simCVR = d.mktFunnel.cvr * cvrMult;
                        const simCTR = d.mktFunnel.ctr * ctrMult;
                        
                        // Formula derivation:
                        // ROAS = Revenue / Cost
                        // Revenue per 1000 Imp = (1000 * CTR% * CVR% * Basket * Price)
                        // Cost per 1000 Imp = CPM
                        // ROAS = (1000 * (CTR/100) * (CVR/100) * Basket * Price) / CPM
                        //       = (Basket * Price * CTR * CVR) / (CPM / 10)
                        
                        const simRoas = (baseBasket * basePrice * simCVR * simCTR) / (baseCPM / 10);
                        
                        row.push({
                            cvrLabel: simCVR.toFixed(2) + '%',
                            ctrLabel: simCTR.toFixed(2) + '%',
                            roas: simRoas
                        });
                    });
                    results.push(row);
                });
                return results;
            }, [d, c]);

            useEffect(() => { 
                const financials = calculateFinancials(d);
                setC(financials); 
            }, [d, lang]);

            const projection = useMemo(() => {
                if(!c) return { data: [], npv: 0 }; 
                const yrProj = [];
                let yCash = c.cfTotal.cashFinal;
                const y1TaxPaid = (d.taxPaymentMode === 'annual' || d.taxPaymentMode === 'monthly') ? c.annualTax : 0;
                
                const y1ExpCash = c.cfTotal.expCash + y1TaxPaid + c.cfTotal.interest + c.cfTotal.principal;
                yCash -= c.dividendTotal;
                
                let accumulatedLoss = 0;
                if (c.annualProfitEst < 0) accumulatedLoss = Math.abs(c.annualProfitEst);

                yrProj.push({ y: 1, rev: c.cfTotal.rev, exp: y1ExpCash, ebitda: c.ebitda, dep: c.annualDepreciation, tax: c.annualTax, net: c.netProfit, div: c.dividendTotal, cash: yCash, taxSaving: 0 });

                let prevRev = c.cfTotal.rev;
                
                const totalExpY1 = c.cfTotal.expCash;
                const fixedComponentY1 = c.salaryTotal + (c.section7Total - c.elecTotal - c.platformTotal - c.mktTotal); 
                const varComponentY1 = totalExpY1 - fixedComponentY1;

                let prevVar = varComponentY1;
                let prevFixed = fixedComponentY1;

                let prevTaxLiability = d.taxPaymentMode === 'deferred' ? c.annualTax : 0;
                let remainingLoan = d.loan.amount - c.annualPrincipalPaid;

                let npv = -c.totalSources; 
                const discountRate = (d.discountRate || 10) / 100;

                const calcTax = (profit) => {
                    if(profit <= 300000) return 0;
                    let tax = 0;
                    if(profit > 300000) tax += Math.min(profit - 300000, 2700000) * 0.15;
                    if(profit > 3000000) tax += (profit - 3000000) * 0.20;
                    return tax;
                };

                for(let y=2;y<=5;y++) {
                    const growthRate = d.growth / 100;
                    const inflationRate = d.inflation / 100;
                    
                    const yRev = prevRev * (1 + growthRate);
                    const yVar = prevVar * (1 + growthRate); 
                    const yFixed = prevFixed * (1 + inflationRate); 
                    const yExpExclTax = yVar + yFixed;

                    const yGrossMargin = yRev - yExpExclTax;
                    const yVatLiability = yGrossMargin * (7/107);
                    const yEbitda = yGrossMargin - yVatLiability; 

                    const annualPrincipal = c.annualPrincipalPaid;
                    remainingLoan = Math.max(0, remainingLoan - annualPrincipal);
                    const yInterest = remainingLoan * (d.loan.rate / 100); 
                    const yPrincipal = remainingLoan > 0 ? annualPrincipal : 0;
                    
                    const yTaxable = yEbitda - c.annualDepreciation - yInterest;
                    
                    let taxableAfterShield = yTaxable;
                    let usedLoss = 0;
                    
                    if (yTaxable > 0 && accumulatedLoss > 0) {
                        usedLoss = Math.min(yTaxable, accumulatedLoss);
                        taxableAfterShield = yTaxable - usedLoss;
                        accumulatedLoss -= usedLoss;
                    } else if (yTaxable < 0) {
                        accumulatedLoss += Math.abs(yTaxable);
                        taxableAfterShield = 0;
                    }

                    const taxNormal = calcTax(yTaxable > 0 ? yTaxable : 0);
                    const taxShielded = calcTax(taxableAfterShield);
                    const taxSaving = taxNormal - taxShielded;
                    const yTax = taxShielded;

                    let taxPaidThisYear = d.taxPaymentMode === 'deferred' ? prevTaxLiability : yTax;
                    if (d.taxPaymentMode === 'deferred') prevTaxLiability = yTax;

                    const yNetAcc = yTaxable - yTax; 
                    const yDiv = yNetAcc > 0 ? yNetAcc * (d.dividend.payout / 100) : 0;
                    
                    yCash += (yEbitda - taxPaidThisYear - yDiv - yInterest - yPrincipal);
                    
                    yrProj.push({ y, rev: yRev, exp: yExpExclTax + taxPaidThisYear + yInterest + yPrincipal, ebitda: yEbitda, dep: c.annualDepreciation, tax: yTax, net: yNetAcc, div: yDiv, cash: yCash, taxSaving });
                    prevRev = yRev;
                    prevVar = yVar;
                    prevFixed = yFixed;
                }
                
                yrProj.forEach((yr) => {
                      const cashFlow = yr.ebitda - yr.tax;
                      npv += cashFlow / Math.pow(1 + discountRate, yr.y);
                });

                return { data: yrProj, npv };
            }, [c, d.growth, d.inflation, d.dividend.payout, d.taxPaymentMode, d.discountRate, d.loan.amount, d.loan.rate, d.loan.term]);

            if(c && projection.data.length > 0) {
                c.yrProj = projection;
            }

            if(!c) return <div className="p-10 text-center text-slate-500">Loading System...</div>;

            const costData = [
                { name: t('rice'), value: c.revBreakdown.riceCost }, { name: t('bag'), value: c.revBreakdown.packCost },
                { name: t('marketing'), value: c.mktTotal }, { name: t('platform'), value: c.platformTotal },
                { name: t('elec'), value: c.elecTotal }, { name: t('salary'), value: c.salaryTotal },
                { name: t('misc'), value: c.revBreakdown.otherFixed + c.annualFinanceCost },
            ];
            const revenueData = [ { name: t('rice'), value: c.grossRev }, { name: t('item'), value: c.totalByProductIncome }, { name: 'Logistics', value: c.logIncome } ];
            
            const getHeatmapColor = (profit) => {
                if (profit < 0) return 'bg-red-100 text-red-700';
                if (profit < c.netProfit * 0.5) return 'bg-orange-100 text-orange-700';
                if (profit < c.netProfit * 0.8) return 'bg-yellow-100 text-yellow-700';
                return 'bg-green-100 text-green-700';
            };

            return (
                <div className="app-container font-sans text-slate-800">
                    <header className="header-bar sticky top-0 z-50 flex flex-col md:flex-row justify-between items-center gap-4">
                        <div>
                            <h1 className="text-xl font-bold tracking-tight">{t('title')}</h1>
                            <p className="text-xs text-slate-400">{t('subtitle')}</p>
                        </div>
                        <div className="flex items-center gap-2 header-controls">
                            <span className="text-xs text-slate-400 font-bold mr-1">{t('scenario')}</span>
                            <button onClick={()=>applyScenario('worst')} className={`scenario-btn ${d.scenario==='worst'?'bg-red-100 text-red-700 active ring-2 ring-red-500':'bg-slate-700 text-slate-300'}`}>Worst</button>
                            <button onClick={()=>applyScenario('base')} className={`scenario-btn ${d.scenario==='base'?'bg-blue-100 text-blue-700 active ring-2 ring-blue-500':'bg-slate-700 text-slate-300'}`}>Base</button>
                            <button onClick={()=>applyScenario('best')} className={`scenario-btn ${d.scenario==='best'?'bg-green-100 text-green-700 active ring-2 ring-green-500':'bg-slate-700 text-slate-300'}`}>Best</button>
                            
                            <div className="h-6 w-px bg-slate-600 mx-2"></div>
                            
                            <button onClick={() => setLang(lang === 'th' ? 'cn' : 'th')} className="scenario-btn bg-yellow-500 text-white hover:bg-yellow-600 flex items-center gap-1 font-bold">
                                <span>üåê</span> {lang === 'th' ? 'TH | CN' : 'CN | TH'}
                            </button>

                            <button onClick={resetToDefault} className="scenario-btn bg-slate-600 text-slate-200 ml-2 hover:bg-slate-500">{t('reset')}</button>
                            <button onClick={handleShare} className="scenario-btn bg-purple-600 text-white ml-2 hover:bg-purple-500 flex items-center gap-1"><span>üîó</span> {t('share')}</button>
                            <button onClick={handleExport} className="scenario-btn bg-emerald-600 text-white ml-2 hover:bg-emerald-500 flex items-center gap-1"><span>üì•</span> CSV</button>
                            <button onClick={handlePrint} className="scenario-btn bg-white text-slate-800 ml-2 hover:bg-slate-100 flex items-center gap-1 font-bold border border-slate-300"><span>üñ®Ô∏è</span> {t('print')}</button>
                        </div>
                    </header>
                    
                    {/* RISK SIMULATION CENTER */}
                    <div className="risk-sim-section bg-white border-b border-slate-200 p-4 sticky top-[70px] z-40 shadow-sm">
                         <div className="max-w-[1600px] mx-auto">
                            <div className="flex justify-between items-center mb-2">
                                <div className="text-sm font-bold text-slate-700 flex items-center gap-2">
                                    <span>{t('riskTitle')}</span>
                                    {activeSim && <span className="bg-red-100 text-red-600 text-xs px-2 py-0.5 rounded-full animate-pulse">{t('simActive')} {SCENARIOS[activeSim].label[lang]}</span>}
                                </div>
                                {activeSim && (
                                    <button onClick={() => handleSimulate(activeSim)} className="text-xs bg-slate-200 hover:bg-slate-300 px-3 py-1 rounded text-slate-600 font-bold transition">
                                        ‚Ü∫ {t('stopSim')}
                                    </button>
                                )}
                            </div>
                            
                            <div className="grid grid-cols-4 gap-4">
                                {/* Cat 1: Market */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelMarket')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['price_war', 'new_competitor', 'algo_change', 'negative_viral'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-1 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 2: Supply */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelSupply')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['drought', 'machine_break', 'pack_cost', 'energy_crisis'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-2 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 3: Financial */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelFin')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['rate_hike', 'credit_crunch', 'tax_fine', 'inflation'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-3 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                                {/* Cat 4: Ops */}
                                <div className="space-y-1">
                                    <div className="text-[10px] font-bold text-slate-400 uppercase tracking-wide">{t('riskLabelOps')}</div>
                                    <div className="grid grid-cols-2 gap-1">
                                        {['staff_turnover', 'fraud', 'warehouse_pest', 'platform_ban'].map(k => (
                                            <button key={k} onClick={() => handleSimulate(k)} className={`risk-btn cat-4 ${activeSim === k ? 'active' : ''}`}>
                                                {SCENARIOS[k].label[lang]}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Analysis Result Box */}
                            {activeSim && (
                                <div className="mt-3 bg-slate-50 border border-slate-200 rounded p-3 text-sm animate-fade-in">
                                    <h4 className="font-bold text-slate-700 mb-2 flex items-center gap-2">
                                        {t('riskAnalTitle')} <span className="text-xs font-normal text-slate-400">({SCENARIOS[activeSim].label[lang]})</span>
                                    </h4>
                                    
                                    <div className="mb-3 p-2 bg-yellow-50 text-yellow-800 text-xs rounded border border-yellow-200">
                                        <strong>{t('simLogic')}</strong> {SCENARIOS[activeSim].math_desc[lang]}
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div className="text-red-600">
                                            <div className="font-bold text-xs uppercase mb-1">{t('impact')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].impact}
                                        </div>
                                        <div className="text-slate-600">
                                            <div className="font-bold text-xs uppercase mb-1">{t('cause')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].cause}
                                        </div>
                                        <div className="text-blue-600 bg-blue-50 p-2 rounded">
                                            <div className="font-bold text-xs uppercase mb-1">{t('strategy')}</div>
                                            {SCENARIOS[activeSim].analysis[lang].strategy}
                                        </div>
                                    </div>
                                </div>
                            )}
                         </div>
                    </div>

                    {toast && (
                        <div className="fixed top-20 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-[100] animate-bounce">
                            {toast}
                        </div>
                    )}

                    <main className="p-4 max-w-[1600px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
                        
                        {/* --- LEFT: Production & Cost --- */}
                        <div className="lg:col-span-3 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section1')}</h2>
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('capexTitle')}</div><div className="text-red-500 font-bold text-sm">{fmt(c.totalCapex)}</div></div>
                                <div className="card-body">
                                    <div className="input-group"><label className="input-label">{t('regCapital')}</label><input type="number" className="input-field border-blue-200 bg-blue-50 text-blue-800" value={d.regCapital} onChange={e=>up('regCapital',null,e.target.value)} /></div>
                                    <div className="p-2 border border-dashed rounded mb-3 bg-yellow-50/50"><div className="text-xs font-bold text-slate-500 mb-1">{t('bankLoan')}</div><div className="flex gap-2 mb-1"><div className="flex-1"><label className="text-[10px]">{t('loanAmount')}</label><input type="number" className="input-field" value={d.loan.amount} onChange={e=>up('loan','amount',e.target.value)}/></div><div className="w-16"><label className="text-[10px]">{t('interestRate')}</label><input type="number" className="input-field text-center" value={d.loan.rate} onChange={e=>up('loan','rate',e.target.value)}/></div></div><div className="flex gap-2"><div className="flex-1 text-[10px] text-slate-400 pt-1">{t('loanTerm')} {d.loan.term} {t('year')}</div><div className="text-[10px] text-red-400 font-bold pt-1">{t('interestPerYear')} {fmt(c.annualFinanceCost)}</div></div></div>
                                    <div className="grid grid-cols-2 gap-2 mb-2"><div><label className="input-label">{t('factory')}</label><input type="number" className="input-field" value={d.capex.factory} onChange={e=>up('capex','factory',e.target.value)}/></div><div><label className="input-label">{t('machine')}</label><input type="number" className="input-field" value={d.capex.machine} onChange={e=>up('capex','machine',e.target.value)}/></div></div>
                                    <div className="input-group"><label className="input-label">{t('license')}</label><input type="number" className="input-field" value={d.capex.license} onChange={e=>up('capex','license',e.target.value)} /></div>
                                    <div className="input-group bg-orange-50 p-2 rounded border border-orange-100"><label className="input-label text-orange-800 font-bold">{t('stockMoney')}</label><input type="number" className="input-field bg-white text-orange-700 font-bold" value={d.capex.stock} onChange={e=>up('capex','stock',e.target.value)} /></div>
                                    <div className="flex justify-between text-xs text-green-600 mt-2 bg-green-50 p-2 rounded"><span>{t('workingCap')}</span><span className="font-bold">{fmt(c.workingCap)}</span></div>
                                </div>
                            </div>

                            {/* NEW: Seasonal Shock Simulator */}
                            <div className="card border-red-100">
                                <div className="card-header bg-red-50"><div className="card-title text-red-700">{t('seasonalTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="flex items-center gap-2 mb-3">
                                        <input type="checkbox" className="w-4 h-4" checked={d.seasonalShock.active} onChange={e=>upNew('seasonalShock', 'active', e.target.checked)}/>
                                        <span className="text-sm font-bold text-slate-700">{t('enableShock')}</span>
                                    </div>
                                    <div className={`space-y-2 ${!d.seasonalShock.active && 'opacity-50 pointer-events-none'}`}>
                                        <div className="flex gap-2">
                                            <div><label className="text-[10px] text-slate-500">{t('shockMonthStart')}</label><input type="number" className="input-field" min="1" max="12" value={d.seasonalShock.startM} onChange={e=>upNew('seasonalShock', 'startM', e.target.value)}/></div>
                                            <div><label className="text-[10px] text-slate-500">{t('shockMonthEnd')}</label><input type="number" className="input-field" min="1" max="12" value={d.seasonalShock.endM} onChange={e=>upNew('seasonalShock', 'endM', e.target.value)}/></div>
                                        </div>
                                        <div><label className="text-[10px] text-slate-500">{t('shockCostImpact')}</label><input type="number" className="input-field border-red-300" value={d.seasonalShock.costImpact} onChange={e=>upNew('seasonalShock', 'costImpact', e.target.value)}/></div>
                                        <div className="text-[9px] text-slate-400 mt-1">{t('shockDesc')}</div>
                                    </div>
                                </div>
                            </div>

                            <div className="card"><div className="card-header"><div className="card-title">{t('productionTitle')}</div></div><div className="card-body"><div className="input-group mb-4"><label className="input-label flex justify-between"><span>{t('yieldRice')}</span><span className="font-bold text-blue-600">{d.yield}%</span></label><input type="range" className="w-full" min="40" max="70" value={d.yield} onChange={handleYieldChange}/></div><div className="input-group"><label className="input-label">{t('paddyPrice')}</label><input type="number" className="input-field" value={d.paddyPrice} onChange={e=>up('paddyPrice',null,e.target.value)}/></div><div className="text-xs text-slate-500 mt-2 text-right">{t('paddyUsed')} <b>{fmtDec(c.paddyTons)}</b> {t('ton')}</div><div className="text-xs text-right text-orange-600 font-bold">{t('riceBudget')} {fmt(c.riceTotal)}</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">{t('unitCostTitle')}</div><div className="text-red-600 font-bold">{fmtDec(c.matCostUnit)}</div></div><div className="card-body"><div className="grid grid-cols-3 gap-2 text-center text-xs mb-2"><div className="bg-slate-100 p-1 rounded"><div>{t('rice')}</div><b>{fmtDec(c.riceCostUnit)}</b><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(c.riceTotal)}</div></div><div className="bg-slate-100 p-1 rounded"><div>{t('bag')}</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.bag} onChange={e=>up('unit','bag',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.bag * d.targetBags)}</div></div><div className="bg-slate-100 p-1 rounded"><div>{t('sticker')}</div><input className="w-full text-center bg-transparent font-bold" value={d.unit.sticker} onChange={e=>up('unit','sticker',e.target.value)}/><div className="text-[10px] text-slate-500 mt-1 border-t border-slate-200 pt-1">{fmt(d.unit.sticker * d.targetBags)}</div></div></div><div className="text-xs text-right text-red-600 font-bold border-t border-slate-100 pt-2">{t('totalUnitCost')} {fmt(c.riceTotal + c.packTotal)}</div></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">{t('hrTitle')}</div><div className="text-blue-600 font-bold text-sm">{fmt(c.salaryTotal)}</div></div><div className="card-body"><table className="w-full hr-table"><thead><tr><th>{t('role')}</th><th className="w-10 text-center">{t('count')}</th><th className="w-20 text-right">{t('salary')}</th><th className="w-16 text-right text-xs text-slate-500">{t('sso')}</th><th className="w-20 text-right font-bold">{t('total')}</th></tr></thead><tbody>{c.hrCosts.map((h,i)=>(<tr key={i}><td>{h.role}</td><td><input type="number" className="hr-input text-center" value={h.count} onChange={e=>upArr('hr',i,'count',e.target.value)}/></td><td><input type="number" className="hr-input" value={h.salary} onChange={e=>upArr('hr',i,'salary',e.target.value)}/></td><td className="text-right text-xs text-slate-500">{fmt(h.ssoTotalRole)}</td><td className="text-right font-bold text-slate-700">{fmt(h.totalPerRole)}</td></tr>))}</tbody></table></div></div>
                            <div className="card"><div className="card-header"><div className="card-title">{t('expenseTitle')}</div><div className="text-red-500 font-bold text-sm">{fmt(c.section7Total)}</div></div><div className="card-body space-y-3">
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">{t('varParamTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('elec')} ({d.varParams.elecRate} /{t('ton')})</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.elecRate} onChange={e=>up('varParams','elecRate',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.elecTotal)}</span></div></div>
                                    <div className="input-row">
                                        <span className="text-sm flex flex-col">
                                            <span>{t('platform')} (%)</span>
                                            <span className="text-[9px] text-slate-400 italic">(Auto from Channel Mix)</span>
                                        </span>
                                        <div className="flex items-center gap-2">
                                            <input type="number" className="input-field w-16 bg-slate-100 text-slate-500 cursor-not-allowed" value={(c.blendedFeePct || 0).toFixed(2)} disabled />
                                            <span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.platformTotal)}</span>
                                        </div>
                                    </div>
                                    <div className="input-row"><span className="text-sm">{t('marketing')} (%)</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.mktPercent} onChange={e=>up('varParams','mktPercent',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">{fmt(c.mktTotal)}</span></div></div>
                                    <div className="input-row"><span className="text-sm">{t('returnRate')}</span><div className="flex items-center gap-2"><input type="number" className="input-field w-16" value={d.varParams.returnRate} onChange={e=>up('varParams','returnRate',e.target.value)}/><span className="text-xs font-bold text-slate-600 min-w-[60px] text-right">-{fmt(c.refundTotal)}</span></div></div>
                                </div>
                                <div>
                                    <div className="text-xs font-bold text-slate-500 mb-1">{t('fixedParamTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('maintenance')}</span><input type="number" className="input-field w-24" value={d.fixedParams.maintPercent} onChange={e=>up('fixedParams','maintPercent',e.target.value)} placeholder="% Machine"/></div>
                                    <div className="input-row"><span className="text-sm">{t('erp')}</span><input type="number" className="input-field w-24" value={d.fixedParams.erp} onChange={e=>up('fixedParams','erp',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('insurance')}</span><input type="number" className="input-field w-24" value={d.fixedParams.insurance} onChange={e=>up('fixedParams','insurance',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('misc')}</span><input type="number" className="input-field w-24" value={d.fixedParams.other} onChange={e=>up('fixedParams','other',e.target.value)}/></div>
                                    
                                    <div className="text-xs font-bold text-slate-500 mt-2 mb-1 pt-2 border-t border-slate-100">{t('operationTitle')}</div>
                                    <div className="input-row"><span className="text-sm">{t('audit')}</span><input type="number" className="input-field w-24" value={d.fixedParams.audit} onChange={e=>up('fixedParams','audit',e.target.value)}/></div>
                                    <div className="input-row"><span className="text-sm">{t('travel')}</span><input type="number" className="input-field w-24" value={d.fixedParams.travel} onChange={e=>up('fixedParams','travel',e.target.value)}/></div>
                                    
                                    <div className="input-row bg-yellow-50 p-1 rounded border border-yellow-100 mt-2"><span className="text-sm font-bold text-yellow-800">{t('campaign')}</span><div className="font-bold text-yellow-700">{fmt(d.fixedParams.campaign)}</div></div>
                                </div>
                                
                                {/* Campaign Details Breakdown */}
                                <div className="mt-2 border-t border-slate-200 pt-2">
                                    <div className="text-[10px] font-bold text-slate-400 mb-1">{t('campaignBreakdown')}</div>
                                    <table className="w-full text-[10px]">
                                        <thead>
                                            <tr className="bg-yellow-50 text-yellow-800">
                                                <th className="text-left p-1 rounded-l">{t('reward')}</th>
                                                <th className="text-center p-1">{t('qty')}</th>
                                                <th className="text-right p-1">{t('costPerUnit')}</th>
                                                <th className="text-right p-1 rounded-r">{t('total')}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {d.campaignDetails.map((item, i) => (
                                                <tr key={i} className="border-b border-slate-100">
                                                    <td className="p-1"><input className="w-full bg-transparent outline-none focus:text-blue-600" value={item.id ? t(item.id) : item.name} onChange={e=>upCampaign(i,'name',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-8 text-center bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.qty} onChange={e=>upCampaign(i,'qty',e.target.value)}/></td>
                                                    <td className="p-1"><input type="number" className="w-12 text-right bg-slate-50 border rounded p-0.5 outline-none focus:border-blue-300" value={item.costPerUnit} onChange={e=>upCampaign(i,'costPerUnit',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-medium text-slate-600">{fmt(item.qty * item.costPerUnit)}</td>
                                                </tr>
                                            ))}
                                            <tr className="font-bold text-yellow-900 border-t border-yellow-200">
                                                <td colSpan="3" className="p-1 text-right">Total Campaign</td>
                                                <td className="p-1 text-right">{fmt(d.fixedParams.campaign)}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div></div>
                        </div>

                        {/* --- CENTER: Strategy & Dashboard --- */}
                        <div className="lg:col-span-5 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section2')}</h2>
                            
                            <div className="bg-slate-800 rounded-xl p-4 text-white shadow-lg mb-4">
                                <div className="flex justify-between items-start mb-4">
                                    <h3 className="font-bold text-lg flex items-center gap-2"><span className="text-yellow-400">‚òÖ</span> {t('execSummary')}</h3>
                                    <div className="text-right">
                                        <div className="text-xs text-slate-400">{t('netProfitYear1')}</div>
                                        <div className={`text-2xl font-bold ${c.netProfit>0?'text-green-400':'text-red-400'}`}>{fmt(c.netProfit)} ‡∏ø</div>
                                    </div>
                                </div>
                                <div className="grid grid-cols-4 gap-2 text-center">
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">Net Margin</div>
                                        <div className="font-bold text-md text-green-300">{(c.netMargin || 0).toFixed(1)}%</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">Gross Margin</div>
                                        <div className="font-bold text-md text-blue-300">{(c.grossMargin || 0).toFixed(1)}%</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">DSCR</div>
                                        <div className={`font-bold text-md ${c.dscr>=1.25?'text-green-300':c.dscr>=1?'text-yellow-300':'text-red-400'}`}>{(c.dscr || 0).toFixed(2)}</div>
                                    </div>
                                    <div className="bg-slate-700/50 rounded p-2 border border-slate-600">
                                        <div className="text-[10px] text-slate-400">ROI</div>
                                        <div className="font-bold text-md text-yellow-300">{fmtDec(c.roi)}%</div>
                                    </div>
                                </div>
                                
                                {/* Scenario Comparison Table */}
                                <div className="mt-3 pt-3 border-t border-slate-600">
                                    <div className="text-xs text-slate-400 mb-2 font-bold">{t('scenComp')}</div>
                                    <div className="grid grid-cols-4 text-xs gap-1 text-center">
                                        <div className="text-slate-500">Metric</div>
                                        <div className="text-red-300">{t('scenWorst')}</div>
                                        <div className="text-blue-300">{t('scenBase')}</div>
                                        <div className="text-green-300">{t('scenBest')}</div>
                                        
                                        <div className="text-left text-slate-300 pl-1">{t('scenProfit')}</div>
                                        {scenarioComparison.map((s, i) => (
                                            <div key={i} className={`font-bold ${s.netProfit > 0 ? 'text-white' : 'text-red-400'}`}>{fmt(s.netProfit/1000)}k</div>
                                        ))}
                                        
                                        <div className="text-left text-slate-300 pl-1">{t('scenCash')}</div>
                                        {scenarioComparison.map((s, i) => (
                                            <div key={i} className={`font-bold ${s.cashFinal > 0 ? 'text-white' : 'text-red-400'}`}>{fmt(s.cashFinal/1000)}k</div>
                                        ))}
                                    </div>
                                </div>

                                <div className="mt-2 text-center text-xs text-slate-400">
                                    {t('payback')} <span className="text-white font-bold">{c.paybackMonth}</span> | 
                                    BEP: <span className="text-white font-bold">{fmt(c.bepUnits)}</span> {t('bag')}/{t('month')}
                                </div>
                            </div>

                            <div className="card border-blue-200">
                                <div className="card-header bg-blue-50/50"><div className="card-title text-blue-800">{t('salesTargetTitle')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">{t('targetBags')}</label><input type="number" className="input-field text-lg font-bold text-blue-700 border-blue-300" value={d.targetBags} onChange={e=>up('targetBags',null,e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">{t('sellPrice')}</label><input type="number" className="input-field text-lg" value={d.price} onChange={e=>up('price',null,e.target.value)}/></div>
                                    </div>
                                    <div className="input-group bg-yellow-50 p-2 rounded border border-yellow-200"><label className="input-label text-yellow-800 font-bold">{t('creditTerm')}</label><select className="input-field bg-white text-yellow-900" value={d.creditTerm} onChange={e=>up('creditTerm',null,e.target.value)}><option value="0">{t('cash')}</option><option value="15">TikTok Shop (15 {t('day')})</option><option value="20">{t('credit')} 20</option><option value="30">{t('credit')} 30</option><option value="60">{t('credit')} 60</option></select><div className="text-[10px] text-yellow-600 mt-1">{t('creditWarning')}</div></div>
                                    <div className="flex justify-between bg-slate-50 p-3 rounded mt-2 border border-slate-100">
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('totalSales')}</div><div className="font-bold text-slate-700">{fmt(c.grossRev)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('targetPerDay')}</div><div className="font-bold text-slate-700">{fmt(c.dayTarget)}</div></div>
                                        <div className="text-center"><div className="text-xs text-slate-500">{t('targetPerHour')}</div><div className="font-bold text-slate-700">{fmtDec(c.hourTarget)}</div></div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* NEW: Capacity Utilization Engine */}
                            <div className="card border-slate-300">
                                <div className="card-header bg-slate-100"><div className="card-title text-slate-700">{t('capTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="input-group mb-2">
                                        <label className="input-label">{t('maxCapInput')}</label>
                                        <input type="number" className="input-field text-right font-bold" value={d.maxCapacity} onChange={e=>up('maxCapacity',null,e.target.value)} />
                                    </div>
                                    
                                    <div className="mb-2">
                                        <div className="flex justify-between text-xs mb-1">
                                            <span>{t('utilRate')}</span>
                                            <span className={`font-bold ${c.utilizationPct > 100 ? 'text-red-600' : (c.utilizationPct < 50 ? 'text-orange-500' : 'text-green-600')}`}>
                                                {c.utilizationPct.toFixed(1)}%
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                                            <div className={`h-2.5 rounded-full ${c.utilizationPct > 100 ? 'bg-red-600' : (c.utilizationPct > 80 ? 'bg-green-500' : 'bg-blue-500')}`} style={{width: `${Math.min(c.utilizationPct, 100)}%`}}></div>
                                        </div>
                                        <div className="text-[10px] text-right mt-1 text-slate-500">
                                            {c.utilizationPct > 100 ? t('capWarning') : (c.utilizationPct >= 70 ? t('capOptimal') : t('capWaste'))}
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-2 mt-3 pt-3 border-t border-dashed">
                                        <div className="text-center p-2 bg-slate-50 rounded">
                                            <div className="text-[10px] text-slate-500">Fixed Cost / Unit</div>
                                            <div className="text-sm font-bold text-slate-700">{fmtDec(c.fixedCostPerUnit)} ‡∏ø</div>
                                        </div>
                                        <div className="text-center p-2 bg-slate-50 rounded">
                                            <div className="text-[10px] text-slate-500">Var Cost / Unit</div>
                                            <div className="text-sm font-bold text-slate-700">{fmtDec(c.varCostPerUnitDisplay)} ‡∏ø</div>
                                        </div>
                                    </div>
                                    <div className="text-center mt-2 p-1 bg-green-50 rounded border border-green-100">
                                        <div className="text-[10px] text-green-600">Total Cost / Unit</div>
                                        <div className="font-bold text-green-800">{fmtDec(c.fixedCostPerUnit + c.varCostPerUnitDisplay)} ‡∏ø</div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Channel Mix Calculator */}
                            <div className="card border-purple-200">
                                <div className="card-header bg-purple-50"><div className="card-title text-purple-800">{t('channelMixTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="flex justify-between text-xs font-bold text-slate-500 mb-2 px-2">
                                        <span>Channel</span>
                                        <span>{t('channelPct')}</span>
                                        <span>{t('platformFeePct')}</span>
                                    </div>
                                    {['tiktok', 'shopee', 'offline'].map(ch => (
                                        <div key={ch} className="flex items-center justify-between mb-2 text-sm">
                                            <span className="capitalize w-20">{ch === 'offline' ? t('offline') : ch}</span>
                                            <input type="number" className="w-12 border rounded text-center" value={d.channelMix[ch]} onChange={e=>upNew('channelMix', ch, e.target.value)}/>
                                            <input type="number" className="w-12 border rounded text-center text-slate-500" value={d.channelFees[ch]} onChange={e=>upNew('channelFees', ch, e.target.value)}/>
                                        </div>
                                    ))}
                                    <div className="mt-2 pt-2 border-t flex justify-between text-sm font-bold text-purple-700">
                                        <span>{t('weightedFee')}</span>
                                        <span>{(c.blendedFeePct || 0).toFixed(2)}%</span>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Pricing Elasticity */}
                            <div className="card border-blue-200">
                                <div className="card-header bg-blue-50"><div className="card-title text-blue-800">{t('elasticityTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="flex items-center justify-between mb-4">
                                        <div className="text-xs text-slate-500">{t('elasticityCoef')}</div>
                                        <input type="number" className="w-16 border rounded text-right font-bold text-blue-600" step="0.1" value={d.elasticityParams.coefficient} onChange={e=>upNew('elasticityParams', 'coefficient', e.target.value)}/>
                                    </div>
                                    <div className="text-[10px] text-slate-400 mb-3 text-center">
                                        {typeof t('elasticityDesc') === 'function' ? t('elasticityDesc')(d.elasticityParams.coefficient) : t('elasticityDesc')}
                                    </div>
                                    
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-xs text-right">
                                            <thead>
                                                <tr className="bg-slate-100 text-slate-600">
                                                    <th className="p-1 text-center">Change</th>
                                                    <th className="p-1">{t('optPrice')}</th>
                                                    <th className="p-1">{t('estVol')}</th>
                                                    <th className="p-1">{t('estRev')}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {c.elasticityData.map((row, i) => (
                                                    <tr key={i} className={`border-b ${row.pct === '+0%' ? 'bg-blue-50 font-bold' : ''}`}>
                                                        <td className="p-1 text-center">{row.pct}</td>
                                                        <td className="p-1">{fmt(row.price)}</td>
                                                        <td className="p-1">{fmt(row.vol)}</td>
                                                        <td className={`p-1 ${row.rev > c.grossRev ? 'text-green-600' : 'text-slate-600'}`}>{fmt(row.rev)}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div className="card border-orange-200">
                                <div className="card-header bg-orange-50"><div className="card-title text-orange-800">{t('byProductTitle')}</div></div>
                                <div className="card-body p-2">
                                    <table className="w-full text-xs">
                                        <thead><tr className="border-b border-orange-100 text-orange-600"><th className="p-1 text-left">{t('item')}</th><th className="p-1 text-center">%</th><th className="p-1 text-right">{t('ton')}</th><th className="p-1 text-right">{t('pricePerTon')}</th><th className="p-1 text-right">{t('totalIncome')}</th></tr></thead>
                                        <tbody>
                                            {c.byProductsCalc.map((item, i) => (
                                                <tr key={i} className="border-b border-dashed border-slate-100 hover:bg-orange-50/30">
                                                    <td className="p-1">{item.id ? t(item.id) : item.name}</td>
                                                    <td className="p-1 text-center text-slate-400">
                                                        <input type="number" className="input-field text-xs p-1 h-6 w-full text-center" value={item.percent} onChange={e=>upArr('byProducts',i,'percent',e.target.value)}/>
                                                    </td>
                                                    <td className="p-1 text-right font-medium">{fmtDec(item.weight)}</td>
                                                    <td className="p-1"><input type="number" className="input-field text-xs p-1 h-6 w-full text-right" value={item.price} onChange={e=>upArr('byProducts',i,'price',e.target.value)}/></td>
                                                    <td className="p-1 text-right font-bold text-orange-700">{fmt(item.revenue)}</td>
                                                </tr>
                                            ))}
                                            <tr className="bg-orange-50 font-bold border-t border-orange-200"><td colSpan="4" className="p-2 text-right text-orange-800">{t('totalByProductIncome')}</td><td className="p-2 text-right text-orange-800">{fmt(c.totalByProductIncome)}</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">{t('logisticsTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="input-group"><label className="input-label">{t('ownDeliveryPercent')}</label><input type="number" className="input-field" value={d.logistics.percent} onChange={e=>up('logistics','percent',e.target.value)}/></div>
                                        <div className="input-group"><label className="input-label">{t('dropOffProfit')}</label><input type="number" className="input-field" value={d.logistics.profit} onChange={e=>up('logistics','profit',e.target.value)}/></div>
                                    </div>
                                    <div className="text-right text-sm text-green-600 font-bold mt-2 border-t pt-2">{t('extraIncome')} +{fmt(c.logIncome)}</div>
                                </div>
                            </div>

                            {/* NEW: VAT Refund Section */}
                            <div className="card border-blue-100">
                                <div className="card-header bg-blue-50"><div className="card-title text-blue-800">{t('vatRefundTitle')}</div></div>
                                <div className="card-body p-3 text-xs">
                                    <div className="flex justify-between mb-1 text-slate-500"><span>{t('vatableExp')}</span><span>{fmt(c.vatBreakdown.vatableExp)}</span></div>
                                    <div className="text-[10px] text-slate-400 pl-2 mb-2">{t('vatNote')}</div>
                                    <div className="flex justify-between border-t border-dashed pt-2">
                                        <span>{t('outputVat')}</span>
                                        <span className="text-red-500 font-bold">{fmt(c.vatBreakdown.outputVat)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>{t('inputVat')}</span>
                                        <span className="text-green-500 font-bold">-{fmt(c.vatBreakdown.inputVat)}</span>
                                    </div>
                                    <div className={`flex justify-between mt-2 pt-2 border-t font-bold text-sm ${c.vatBreakdown.netVat > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                        <span>{c.vatBreakdown.netVat > 0 ? t('payMore') : t('refund')}</span>
                                        <span>{fmt(Math.abs(c.vatBreakdown.netVat))}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title text-indigo-700">{t('monthlyFlowTitle')}</div></div>
                                <div className="card-body">
                                    <div className="flow-row"><span className="text-indigo-600 font-bold">{t('cashInflow')}</span><span>{fmt(c.revBreakdown.totalIn)}</span></div>
                                    <div className="flow-row flow-sub"><span>{t('salesGross')}</span><span>{fmt(c.revBreakdown.sales)}</span></div>
                                    <div className="flow-row flow-sub"><span>{t('refundDeduction')}</span><span className="text-red-400">-{fmt(c.refundTotal)}</span></div>
                                    <div className="flow-row flow-sub"><span>- {t('byProductTitle')}</span><span>{fmt(c.revBreakdown.byProduct)}</span></div>
                                    <div className="flow-row flow-sub"><span>- Logistics</span><span>{fmt(c.revBreakdown.logistics)}</span></div>
                                    <div className="flow-row mt-2"><span className="text-red-600 font-bold">{t('vatObligation')}</span><span>-{fmt(c.revBreakdown.vat)}</span></div>
                                    <div className="flow-row flow-sub text-xs"><span>{t('vatNote2')}</span></div>
                                    <div className="flow-row mt-2"><span className="text-orange-600 font-bold">{t('opOutflow')}</span><span>-{fmt(c.revBreakdown.opCost)}</span></div>
                                    <div className="flow-row flow-sub font-bold text-slate-600">{t('varExclVat')}<span>{fmt(c.revBreakdown.opVar)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Rice: {fmt(c.revBreakdown.riceCost)} | Pack: {fmt(c.revBreakdown.packCost)}<br/>- Fees: {fmt(c.revBreakdown.feesCost)} | Elec: {fmt(c.revBreakdown.elecCost)}</div>
                                    <div className="flow-row flow-sub font-bold text-slate-600 mt-1">{t('fixedCost')}<span>{fmt(c.revBreakdown.opFixed)}</span></div>
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Salary (Base+SSO): {fmt(c.revBreakdown.salaryCost)}</div>
                                    
                                    {/* Expanded Other Fixed Breakdown */}
                                    <div className="flow-row flow-sub pl-6 text-xs text-slate-500">- Other Fixed: {fmt(c.revBreakdown.otherFixed)}</div>
                                    <div className="bg-slate-50 rounded p-2 ml-6 my-1 border border-slate-100">
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Campaign:</span><span>{fmt(c.revBreakdown.otherDetails.campaign)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ ERP:</span><span>{fmt(c.revBreakdown.otherDetails.erp)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Insurance:</span><span>{fmt(c.revBreakdown.otherDetails.insurance)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Audit/Legal:</span><span>{fmt(c.revBreakdown.otherDetails.audit)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Travel/Ent:</span><span>{fmt(c.revBreakdown.otherDetails.travel)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Misc:</span><span>{fmt(c.revBreakdown.otherDetails.misc)}</span></div>
                                        <div className="flex justify-between text-[10px] text-slate-400"><span>‚Ä¢ Maintenance:</span><span>{fmt(c.revBreakdown.otherDetails.maintenance)}</span></div>
                                    </div>

                                    <div className="flow-row total text-lg bg-green-50 p-2 rounded mt-2"><span className="text-green-700">{t('netCashEbitda')}</span><span className="text-green-700">{fmt(c.revBreakdown.netCash)}</span></div>
                                </div>
                            </div>
                        </div>

                        {/* --- RIGHT: Analysis --- */}
                        <div className="lg:col-span-4 space-y-4">
                            <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">{t('section3')}</h2>
                            
                            <div className="card print-btn-hide">
                                <div className="card-header"><div className="card-title">{t('cumCashflow')}</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <AreaChart data={c.cf}><CartesianGrid strokeDasharray="3 3" vertical={false} /><XAxis dataKey="m" tick={{fontSize: 10}} /><YAxis tick={{fontSize: 10}} tickFormatter={(val)=>`${val/1000000}M`} /><Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Month ${l}`} /><Area type="monotone" dataKey="cashFinal" stroke="#10b981" fill="#dcfce7" strokeWidth={2} /></AreaChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Break-even Chart - FIXED */}
                            <div className="card">
                                <div className="card-header"><div className="card-title text-sm">{t('bepTitle')}</div></div>
                                <div className="card-body h-[200px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <ComposedChart data={c.bepData}>
                                            <CartesianGrid strokeDasharray="3 3" />
                                            <XAxis dataKey="units" type="number" tickFormatter={(val)=>`${val/1000}k`} label={{ value: 'Units (Bags)', position: 'insideBottom', offset: -5, fontSize: 10 }} />
                                            <YAxis tickFormatter={(val)=>`${val/1000}k`} tick={{fontSize: 10}} />
                                            <Tooltip formatter={(value) => fmt(value)} labelFormatter={(l)=>`Units: ${fmt(l)}`} />
                                            <Line type="monotone" dataKey="revenue" stroke="#10b981" name="Revenue" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="totalCost" stroke="#ef4444" name="Total Cost" strokeWidth={2} dot={false} />
                                            <Line type="monotone" dataKey="fixedCost" stroke="#94a3b8" name="Fixed Cost" strokeDasharray="5 5" dot={false} />
                                        </ComposedChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Revenue Structure */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('revStruct')}</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={revenueData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={5} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{revenueData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            
                            {/* Cost Structure - Resized */}
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('costStruct')}</div></div>
                                <div className="card-body h-[300px]">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart><Pie data={costData} cx="50%" cy="45%" innerRadius={40} outerRadius={70} paddingAngle={2} dataKey="value" label={({percent}) => `${(percent * 100).toFixed(0)}%`}>{costData.map((entry, index) => <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />)}</Pie><Tooltip formatter={(value) => fmt(value)} /><Legend iconSize={10} layout="horizontal" verticalAlign="bottom" align="center" wrapperStyle={{fontSize:'11px'}}/></PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Sensitivity Analysis with Heatmap */}
                            <div className="card mt-4">
                                <div className="card-header"><div className="card-title text-sm">{t('sensitivity')}</div></div>
                                <div className="card-body p-2">
                                    <div className="text-[10px] text-center mb-1 text-slate-400">Y: Price | X: Vol</div>
                                    <table className="w-full matrix-table">
                                        <thead>
                                            <tr>
                                                <th className="bg-slate-100">Price \ Vol</th>
                                                <th className="matrix-header">-10%</th>
                                                <th className="matrix-header">Base</th>
                                                <th className="matrix-header">+10%</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {sensitivityData.map((row, rI) => (
                                                <tr key={rI}>
                                                    <td className="matrix-header">{row[0].pLabel}</td>
                                                    {row.map((cell, cI) => (
                                                        <td key={cI} className={`font-bold ${getHeatmapColor(cell.profit)}`}>{fmt(cell.profit/1000)}k</td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Spread Sensitivity */}
                            <div className="card mt-4">
                                <div className="card-header"><div className="card-title text-sm">{t('spreadAnalysis')}</div></div>
                                <div className="card-body p-2">
                                    <div className="text-[10px] text-center mb-1 text-slate-400">Y: {t('paddyLabel')} | X: {t('priceLabel')}</div>
                                    <table className="w-full matrix-table">
                                        <thead>
                                            <tr>
                                                <th className="bg-slate-100">Cost \ Price</th>
                                                <th className="matrix-header">-10%</th>
                                                <th className="matrix-header">Base</th>
                                                <th className="matrix-header">+10%</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {spreadData.map((row, rI) => (
                                                <tr key={rI}>
                                                    <td className="matrix-header">{row[0].cLabel}</td>
                                                    {row.map((cell, cI) => (
                                                        <td key={cI} className={`font-bold ${getHeatmapColor(cell.profit)}`}>{fmt(cell.profit/1000)}k</td>
                                                    ))}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Marketing Funnel & Budget Allocation */}
                            <div className="card mt-4 border-indigo-200">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800">{t('tiktokAdsTitle')}</div></div>
                                <div className="card-body p-3">
                                    {/* Top Row: Budget & ROAS (The most important for GMV Max) */}
                                    <div className="grid grid-cols-4 gap-2 mb-4 border-b border-indigo-100 pb-3">
                                        <div className="text-center col-span-1">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('totalBudget')}</div>
                                            <div className="text-lg font-bold text-indigo-700">{fmt(c.funnelMetrics.budget)}</div>
                                            <div className="text-[9px] text-slate-400">{t('budgetNote')}</div>
                                        </div>
                                        <div className="text-center bg-indigo-50 rounded border border-indigo-100 p-1 col-span-1">
                                            <div className="text-[10px] text-indigo-800 uppercase font-bold">{t('targetRoas')}</div>
                                            <div className="text-xl font-bold text-indigo-600">{(c.funnelMetrics.roas || 0).toFixed(2)}x</div>
                                            <div className="text-[9px] text-indigo-400">{t('minRoasNote')}</div>
                                        </div>
                                        
                                        {/* NEW: Breakeven ROAS */}
                                        <div className="text-center bg-red-50 rounded border border-red-100 p-1 col-span-1">
                                            <div className="text-[10px] text-red-800 uppercase font-bold">{t('beRoas')}</div>
                                            <div className="text-xl font-bold text-red-600">{(c.funnelMetrics.beRoas || 0).toFixed(2)}x</div>
                                            <div className="text-[9px] text-red-400 truncate">{t('beRoasNote')}</div>
                                        </div>

                                         <div className="text-center col-span-1">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('acos')}</div>
                                            <div className="text-lg font-bold text-slate-600">{(c.funnelMetrics.acos || 0).toFixed(1)}%</div>
                                            <div className="text-[9px] text-slate-400">{t('acosNote')}</div>
                                        </div>
                                    </div>

                                    {/* Middle Row: Manual Bidding Reference (CPA/CPC) */}
                                    <div className="grid grid-cols-2 gap-4 mb-3">
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">{t('maxCpa')}</div>
                                            <div className="text-xl font-bold text-pink-600">{fmt(c.funnelMetrics.cpa)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">{t('maxCpaNote')}</div>
                                        </div>
                                        <div>
                                            <div className="text-[10px] text-slate-400 uppercase font-bold">{t('maxCpc')}</div>
                                            <div className="text-xl font-bold text-blue-600">{(c.funnelMetrics.cpc || 0).toFixed(2)} ‡∏ø</div>
                                            <div className="text-[9px] text-slate-400">{t('maxCpcNote')}</div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-slate-50 rounded p-2 border border-slate-200 space-y-2">
                                        <div className="text-xs font-bold text-slate-700 mb-1 border-b pb-1">{t('funnelInput')}</div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>{t('basketSize')}</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.basketSize} onChange={e=>upFunnel('basketSize', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>Conversion Rate (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.cvr} onChange={e=>upFunnel('cvr', e.target.value)} />
                                        </div>
                                        <div className="flex justify-between items-center text-xs">
                                            <span>CTR (%)</span>
                                            <input type="number" className="w-16 border rounded text-right px-1" step="0.1" value={d.mktFunnel.ctr} onChange={e=>upFunnel('ctr', e.target.value)} />
                                        </div>
                                    </div>

                                    <div className="mt-3 space-y-1">
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">{t('impressionsNeeded')}</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.impressions)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs">
                                            <span className="text-slate-500">{t('clicksTraffic')}</span>
                                            <span className="font-medium">{fmt(c.funnelMetrics.visitors)}</span>
                                        </div>
                                        <div className="flex justify-between text-xs font-bold text-indigo-700 bg-indigo-50 p-1 rounded">
                                            <span>{t('ordersTarget')}</span>
                                            <span>{fmt(c.funnelMetrics.orders)}</span>
                                        </div>
                                    </div>

                                    {/* Ads Efficiency Matrix */}
                                    <div className="mt-4 pt-3 border-t border-indigo-200">
                                        <div className="flex justify-between items-center mb-2">
                                            <div className="text-xs font-bold text-indigo-800">{t('adsMatrixTitle')}</div>
                                            <div className="text-[9px] text-slate-500">Y: {t('adsMatY')} | X: {t('adsMatX')}</div>
                                        </div>
                                        <table className="w-full matrix-table">
                                            <thead>
                                                <tr>
                                                    <th className="bg-indigo-50 text-[9px] text-indigo-900">CVR \ CTR</th>
                                                    {adsMatrixData[0] && adsMatrixData[0].map((cell, i) => (
                                                        <th key={i} className="matrix-header text-[9px]">{cell.ctrLabel}</th>
                                                    ))}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {adsMatrixData.map((row, i) => (
                                                    <tr key={i}>
                                                        <td className="matrix-header text-[9px]">{row[0].cvrLabel}</td>
                                                        {row.map((cell, j) => (
                                                            <td key={j} className={`text-[10px] font-bold ${cell.roas < c.funnelMetrics.beRoas ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-700'}`}>
                                                                {cell.roas.toFixed(1)}x
                                                            </td>
                                                        ))}
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                        <div className="text-[9px] text-center mt-1 text-slate-400">*‡∏™‡∏µ‡πÅ‡∏î‡∏á = ‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ Breakeven {(c.funnelMetrics.beRoas || 0).toFixed(1)}x)</div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Customer Lifetime Value (CLV) */}
                            <div className="card mt-4 border-teal-200">
                                <div className="card-header bg-teal-50"><div className="card-title text-teal-800">{t('clvTitle')}</div></div>
                                <div className="card-body p-3">
                                    <div className="grid grid-cols-2 gap-3 mb-3">
                                        <div>
                                            <label className="text-[10px] text-slate-500">{t('freqPerYear')}</label>
                                            <input type="number" className="input-field text-center" value={d.clvParams.freq} onChange={e=>upNew('clvParams', 'freq', e.target.value)}/>
                                        </div>
                                        <div>
                                            <label className="text-[10px] text-slate-500">{t('retentionRate')}</label>
                                            <input type="number" className="input-field text-center" value={d.clvParams.retention} onChange={e=>upNew('clvParams', 'retention', e.target.value)}/>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-3 text-center mb-3">
                                        <div className="p-2 border rounded bg-teal-50/50">
                                            <div className="text-[9px] text-slate-400">{t('ltv1')}</div>
                                            <div className="font-bold text-teal-700">{fmt(c.funnelMetrics.ltv1)} ‡∏ø</div>
                                        </div>
                                        <div className="p-2 border rounded bg-teal-50/50">
                                            <div className="text-[9px] text-slate-400">{t('ltv3')}</div>
                                            <div className="font-bold text-teal-700">{fmt(c.funnelMetrics.ltv3)} ‡∏ø</div>
                                        </div>
                                    </div>
                                    <div className="flex justify-between items-center text-xs border-t pt-2">
                                        <span className="font-bold text-slate-600">{t('ltvCacRatio')}</span>
                                        <span className={`font-bold ${c.funnelMetrics.ltvCacRatio >= 3 ? 'text-green-600' : 'text-orange-500'}`}>{(c.funnelMetrics.ltvCacRatio || 0).toFixed(1)}x</span>
                                    </div>
                                    <div className="text-[9px] text-right text-slate-400 mt-1">{t('ltvDesc')}</div>
                                </div>
                            </div>

                        </div>

                        {/* --- BOTTOM --- */}
                        <div className="lg:col-span-12 space-y-6">
                             <div className="card">
                                <div className="card-header"><div className="card-title text-slate-700">{t('detailedCashflow')}</div><div className="flex items-center gap-2 text-xs"><span className="text-slate-500">{t('monthlyGrowth')}</span><input type="number" className="border border-slate-300 rounded px-2 py-1 w-16 text-right" value={d.monthlyGrowth} onChange={e=>up('monthlyGrowth', null, e.target.value)} /><span className="text-slate-500">%</span><span className="ml-2 text-slate-400 font-bold bg-slate-100 px-2 py-1 rounded">Credit: {d.creditTerm} Days</span></div></div>
                                <div className="overflow-x-auto custom-scroll">
                                    <table className="w-full text-xs text-right border-collapse min-w-[800px]">
                                        <thead className="bg-slate-100 text-slate-600"><tr><th className="p-3 text-center">{t('month')}</th><th className="p-3 text-slate-400">{t('cfSales')}</th><th className="p-3 text-blue-700 font-bold">{t('cfInflow')}</th><th className="p-3 text-red-500">{t('cfExp')}</th><th className="p-3 text-orange-500">{t('cfVat')}</th><th className="p-3 text-blue-600">{t('cfOpCash')}</th><th className="p-3 font-bold text-green-700 bg-green-50">{t('cfBalance')}</th></tr></thead>
                                        <tbody>
                                            <tr className="bg-slate-50 border-b border-slate-200"><td className="p-3 text-center font-bold text-slate-500">{t('start0')}</td><td className="p-3" colSpan="5"></td><td className="p-3 font-bold text-slate-700 bg-green-50/50">{fmt(c.workingCap)}</td></tr>
                                            {c.cf.map((row) => (<tr key={row.m} className={`border-b hover:bg-slate-50 ${row.cashFinal < 0 ? 'bg-red-50':''}`}><td className="p-3 text-center font-bold text-slate-400">{row.m}</td><td className="p-3 text-slate-400">{fmt(row.rev)}</td><td className="p-3 font-bold text-blue-700">{fmt(row.revCashIn)}</td><td className="p-3 text-red-400">{fmt(row.expCash)}</td><td className={`p-3 font-bold ${row.vatPaid > 0 ? 'text-orange-500' : 'text-green-500'}`}>{fmt(row.vatPaid)}</td><td className="p-3 font-bold text-blue-600">{fmt(row.netOpCash)}</td><td className={`p-3 font-bold ${row.cashFinal < 0 ? 'text-red-600':'text-green-700 bg-green-50/30'}`}>{fmt(row.cashFinal)}</td></tr>))}
                                            <tr className="bg-slate-200 font-bold border-t-2 border-slate-400 text-slate-800"><td className="p-3 text-center">{t('total')}</td><td className="p-3 text-slate-600">{fmt(c.cfTotal.rev)}</td><td className="p-3 text-blue-800">{fmt(c.cfTotal.revCashIn)}</td><td className="p-3 text-red-600">{fmt(c.cfTotal.expCash)}</td><td className="p-3 text-orange-600">{fmt(c.cfTotal.vatPaid)}</td><td className="p-3 text-blue-800">{fmt(c.cfTotal.netOpCash)}</td><td className="p-3 bg-green-100 text-green-900">{fmt(c.cfTotal.cashFinal)}</td></tr>
                                        </tbody>
                                    </table>
                                    <div className="mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                                            <div className="p-3 bg-slate-100 rounded border"><div className="text-xs text-slate-500">{t('wcStart')}</div><div className="font-bold text-slate-700">{fmt(c.workingCap)}</div></div>
                                            <div className={`p-3 rounded border ${c.lowestCashBalance < 0 ? 'bg-red-100 border-red-300' : 'bg-green-50 border-green-200'}`}><div className={`text-xs font-bold ${c.lowestCashBalance < 0 ? 'text-red-600' : 'text-green-600'}`}>{t('lowestCash')}</div><div className={`font-bold ${c.lowestCashBalance < 0 ? 'text-red-700' : 'text-green-700'}`}>{fmt(c.lowestCashBalance)}</div></div>
                                            <div className="p-3 bg-blue-50 rounded border border-blue-100 text-red-500"><div className="text-xs text-red-500">{t('debtService')}</div><div className="font-bold">-{fmt(c.annualPrincipalPaid + c.annualFinanceCost)}</div></div>
                                            <div className="p-3 bg-red-50 rounded border border-red-100"><div className="text-xs text-red-500">{t('taxPaidCash')}</div><div className="font-bold text-red-700">-{fmt(c.cfTotal.tax)}</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-indigo-50 rounded border border-indigo-200 mt-2 md:mt-0"><div className="text-xs text-indigo-600">{t('netProfitAcc')}</div><div className="font-bold text-xl text-indigo-800">{fmt(c.netProfit)}</div><div className="text-[10px] text-indigo-400">{t('netProfitDesc')}</div></div>
                                            <div className="col-span-1 md:col-span-2 p-3 bg-green-50 rounded border border-green-200 mt-2 md:mt-0"><div className="text-xs text-green-600">{t('cashEndYear')}</div><div className={`font-bold text-xl ${c.cfTotal.cashFinal < 0 ? 'text-red-600':'text-green-800'}`}>{fmt(c.cfTotal.cashFinal)}</div><div className="text-[10px] text-green-500">{t('cashEndDesc')}</div></div>
                                    </div>
                                </div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('taxDepTitle')}</div><div className="flex bg-slate-100 rounded text-[10px] overflow-hidden toggle-switch-container"><button className={`px-2 py-1 ${d.taxPaymentMode==='monthly'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'monthly')}>Monthly</button><button className={`px-2 py-1 ${d.taxPaymentMode==='annual'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'annual')}>Annual</button><button className={`px-2 py-1 ${d.taxPaymentMode==='deferred'?'bg-blue-600 text-white':''}`} onClick={()=>up('taxPaymentMode',null,'deferred')}>Deferred</button></div></div>
                                <div className="card-body"><div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">{t('depSchedule')}</h4><table className="w-full text-sm text-right"><thead className="bg-slate-50 text-slate-500"><tr><th className="text-left p-2">{t('asset')}</th><th className="p-2">{t('value')}</th><th className="p-2">{t('lifeYear')}</th><th className="p-2">{t('depPerYear')}</th></tr></thead><tbody><tr><td className="text-left p-2">{t('factory')}</td><td className="p-2">{fmt(d.capex.factory)}</td><td className="p-2"><input type="number" className="input-field text-center w-16" value={d.depreciation.factoryYears} onChange={e=>up('depreciation','factoryYears',e.target.value)}/></td><td className="p-2">{fmt(c.depFactory)}</td></tr><tr><td className="text-left p-2">{t('machine')}</td><td className="p-2">{fmt(d.capex.machine)}</td><td className="p-2"><input type="number" className="input-field text-center w-16" value={d.depreciation.machineYears} onChange={e=>up('depreciation','machineYears',e.target.value)}/></td><td className="p-2">{fmt(c.depMachine)}</td></tr><tr className="font-bold border-t"><td className="text-left p-2">{t('total')}</td><td></td><td></td><td className="p-2 text-red-500">{fmt(c.annualDepreciation)}</td></tr></tbody></table></div>
                                    <div><h4 className="font-bold text-slate-700 mb-3 border-b pb-2">{t('corpTax')}</h4><div className="space-y-2 text-sm"><div className="flex justify-between"><span>EBITDA</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-red-500"><span>- Depreciation</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-red-500"><span>- Interest</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between font-bold text-blue-700 border-t pt-2"><span>{t('taxableIncome')}</span><span>{fmt(c.annualProfitEst)}</span></div></div><div className="bg-slate-50 p-2 rounded text-xs mt-3"><table className="w-full text-right"><thead><tr className="text-slate-400"><th>Tier</th><th>Rate</th><th>Tax</th></tr></thead><tbody>{c.taxDetails.map((t,i)=>(<tr key={i}><td className="text-slate-600">{t.tier}</td><td>{t.rate}%</td><td className="font-medium">{fmt(t.amount)}</td></tr>))}<tr className="border-t font-bold text-red-600"><td colSpan="2" className="pt-1">Total Tax</td><td className="pt-1">{fmt(c.annualTax)}</td></tr></tbody></table></div></div></div></div>
                            </div>

                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('dividendTitle')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">{t('policyInput')}</h4><div className="input-group"><label className="input-label">{t('payoutRatio')}</label><input className="input-field" value={d.dividend.payout} onChange={e=>up('dividend','payout',e.target.value)}/></div><div className="input-group"><label className="input-label">{t('shareholders')}</label><input className="input-field" value={d.dividend.founders} onChange={e=>up('dividend','founders',e.target.value)}/></div></div>
                                        <div className="space-y-3"><h4 className="font-bold text-slate-700 text-sm border-b pb-1">{t('netProfitBreakdown')}</h4><div className="flex justify-between text-xs text-slate-500"><span>EBITDA (Year)</span><span>{fmt(c.ebitda)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- Depreciation</span><span>-{fmt(c.annualDepreciation)}</span></div><div className="flex justify-between text-xs text-red-400"><span>- Interest</span><span>-{fmt(c.annualFinanceCost)}</span></div><div className="flex justify-between text-xs text-red-400 border-b border-slate-200 pb-1"><span>- Tax Liability</span><span>-{fmt(c.annualTax)}</span></div><div className="flex justify-between text-sm pt-1"><span className="font-bold text-slate-700">Net Profit</span><span className="font-bold text-blue-600">{fmt(c.netProfit)}</span></div></div>
                                        <div className="bg-yellow-50 p-4 rounded border border-yellow-200 text-center flex flex-col justify-center"><h4 className="font-bold text-yellow-800 text-sm mb-2">{t('shareholderReturn')}</h4><div className="text-xs text-slate-500 mb-1">{t('totalPool')}</div><div className="text-lg font-bold text-yellow-700 mb-2">{fmt(c.dividendTotal)} ‡∏ø</div><div className="border-t border-yellow-200 my-2"></div><div className="text-2xl font-bold text-yellow-700">{fmt(c.dividendPerPersonYear)} <span className="text-sm font-normal text-yellow-600">{t('perYear')}</span></div><div className="text-sm text-yellow-600 mt-1">{t('avgPerMonth')} {fmt(c.dividendPerPersonMonth)} {t('perMonth')}</div></div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Financial Health Check */}
                            <div className="card border-emerald-200">
                                <div className="card-header bg-emerald-50"><div className="card-title text-emerald-800">{t('financialHealth')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('debtToEquity')}</div>
                                            <div className={`text-lg font-bold ${d.loan.amount/d.regCapital > 2 ? 'text-red-500' : 'text-emerald-600'}`}>{(d.loan.amount/d.regCapital).toFixed(2)}x</div>
                                            <div className="text-[9px] text-slate-400">{t('debtToEquityDesc')}</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('returnOnAsset')}</div>
                                            <div className="text-lg font-bold text-blue-600">{c.totalSources > 0 ? ((c.netProfit / c.totalSources)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">ROA</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">{t('returnOnEquity')}</div>
                                            <div className="text-lg font-bold text-blue-600">{d.regCapital > 0 ? ((c.netProfit / d.regCapital)*100).toFixed(1) : 0}%</div>
                                            <div className="text-[9px] text-slate-400">ROE</div>
                                        </div>
                                        <div className="p-2 border rounded bg-white">
                                            <div className="text-[10px] text-slate-500 uppercase font-bold">Asset Turnover</div>
                                            <div className="text-lg font-bold text-slate-600">{c.totalSources > 0 ? (c.grossRev / c.totalSources).toFixed(2) : 0}x</div>
                                            <div className="text-[9px] text-slate-400">{t('assetTurnoverDesc')}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="card">
                                <div className="card-header"><div className="card-title">{t('projectionTitle')}</div><div className="flex gap-4 text-xs items-center"><div className="flex items-center gap-1"><span>Growth:</span><input className="w-12 border rounded text-center" value={d.growth} onChange={e=>up('growth',null,e.target.value)}/>%</div><div className="flex items-center gap-1"><span>Inflation:</span><input className="w-12 border rounded text-center" value={d.inflation} onChange={e=>up('inflation',null,e.target.value)}/>%</div><div className="flex items-center gap-1 font-bold text-blue-600"><span>Discount Rate:</span><input className="w-12 border rounded text-center" value={d.discountRate} onChange={e=>up('discountRate',null,e.target.value)}/>%</div></div></div>
                                <div className="overflow-x-auto custom-scroll mb-2">
                                    <table className="w-full text-xs text-right border-collapse min-w-[800px]"><thead className="bg-indigo-900 text-white"><tr><th className="p-3 text-center">{t('pyYear')}</th><th className="p-3">{t('pyRev')}</th><th className="p-3 text-red-300">{t('pyExp')}</th><th className="p-3 font-bold text-yellow-300">{t('pyEbitda')}</th><th className="p-3 text-slate-300">{t('pyDep')}</th><th className="p-3 text-orange-300">{t('pyTax')}</th><th className="p-3 font-bold text-blue-300 bg-indigo-800">{t('pyNet')}</th><th className="p-3 text-green-300">{t('pyDiv')}</th><th className="p-3 font-bold text-green-400 bg-indigo-950">{t('pyCashEnd')}</th></tr></thead>
                                    <tbody>{projection.data.map((y,i) => (<tr key={i} className="border-b last:border-0 hover:bg-indigo-50"><td className="p-3 text-center font-bold text-indigo-900 bg-gray-50">{y.y}</td><td className="p-3 font-medium">{fmt(y.rev)}</td><td className="p-3 text-red-600">{fmt(y.exp)}</td><td className="p-3 font-bold text-yellow-700 bg-yellow-50">{fmt(y.ebitda)}</td><td className="p-3 text-slate-500">{fmt(y.dep)}</td><td className="p-3 text-orange-600">{fmt(y.tax)}{y.taxSaving > 0 && <div className="text-[9px] text-green-500">(Save {fmt(y.taxSaving)})</div>}</td><td className="p-3 font-bold text-blue-700 bg-blue-50">{fmt(y.net)}</td><td className="p-3 text-green-700">{fmt(y.div)}</td><td className="p-3 font-bold text-green-800 bg-green-100">{fmt(y.cash)}</td></tr>))}</tbody></table>
                                </div>
                                <div className="p-3 bg-blue-50 border-t flex justify-between items-center">
                                    <div className="text-xs text-slate-500">{t('npvDesc')}</div>
                                    <div className={`text-xl font-bold ${projection.npv > 0 ? 'text-green-600' : 'text-red-600'}`}>NPV: {fmt(projection.npv)}</div>
                                </div>
                            </div>

                            {/* NEW: AI Analysis & Recommendation Section */}
                            <div className="card mt-6 border-slate-300 shadow-md">
                                <div className="card-header bg-slate-800 text-white"><div className="card-title text-white">{t('aiAnalysis')}</div></div>
                                <div className="card-body space-y-4">
                                    
                                    {/* 1. NPV Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${projection.npv > 0 ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{projection.npv > 0 ? '‚úÖ' : '‚ùå'}</span> 
                                            NPV = {fmt(projection.npv)}
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>{t('meaning')}:</strong> {projection.npv > 0 ? t('npvPos') : t('npvNeg')}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            {t('advice')}: {projection.npv > 0 ? t('npvAdvPos') : t('npvAdvNeg')}
                                        </div>
                                    </div>

                                    {/* 2. ROAS Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${c.funnelMetrics.roas >= 5 ? 'bg-blue-50 border-blue-500' : (c.funnelMetrics.roas >= 3 ? 'bg-yellow-50 border-yellow-500' : 'bg-orange-50 border-orange-500')}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{c.funnelMetrics.roas >= 5 ? 'üöÄ' : (c.funnelMetrics.roas >= 3 ? '‚ö†Ô∏è' : 'üî•')}</span>
                                            ROAS = {(c.funnelMetrics.roas || 0).toFixed(2)}x
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>{t('situation')}:</strong> {c.funnelMetrics.roas >= 5 ? t('roasHigh') : (c.funnelMetrics.roas >= 3 ? t('roasMed') : t('roasLow'))}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            {t('advice')}: {c.funnelMetrics.roas >= 5 ? t('roasAdvHigh') : (c.funnelMetrics.roas >= 3 ? t('roasAdvMed') : t('roasAdvLow'))}
                                        </div>
                                    </div>

                                    {/* 3. Cash Flow Analysis */}
                                    <div className={`p-4 rounded border-l-4 ${c.lowestCashBalance >= 0 ? 'bg-emerald-50 border-emerald-500' : 'bg-red-50 border-red-500'}`}>
                                        <div className="font-bold text-slate-700 flex items-center gap-2">
                                            <span className="text-lg">{c.lowestCashBalance >= 0 ? 'üí∞' : 'üí∏'}</span>
                                            {t('status')} (Cash Flow)
                                        </div>
                                        <div className="text-sm text-slate-600 mt-2">
                                            <strong>{t('status')}:</strong> {c.lowestCashBalance >= 0 ? t('cfSafe')(fmt(c.lowestCashBalance)) : t('cfDanger')(fmt(c.lowestCashBalance))}
                                        </div>
                                        <div className="text-sm font-bold mt-2 text-slate-700 bg-white/50 p-2 rounded inline-block">
                                            {t('advice')}: {c.lowestCashBalance >= 0 ? t('cfAdvSafe') : t('cfAdvDanger')}
                                        </div>
                                    </div>

                                    {/* --- NEW: Financial Deep Dive (Grid) --- */}
                                    <div className="mt-6 pt-4 border-t border-slate-200">
                                        <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">{t('financialDeepDive')}</h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                            
                                            {/* EBITDA */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>EBITDA</span><span className={c.ebitda > 0 ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.ebitda)}</span></div>
                                                <div className="text-[10px] text-slate-600">{c.ebitda > 0 ? t('ebitdaOk') : t('ebitdaFail')}</div>
                                            </div>

                                            {/* DSCR */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>DSCR</span><span className={c.dscr >= 1.25 ? 'text-green-500 font-bold' : 'text-orange-500 font-bold'}>{(c.dscr || 0).toFixed(2)}x</span></div>
                                                <div className="text-[10px] text-slate-600">{c.dscr >= 1.25 ? t('dscrOk') : (c.dscr >= 1 ? t('dscrWarn') : t('dscrFail'))}</div>
                                            </div>

                                            {/* D/E Ratio */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>D/E Ratio</span><span className={(d.loan.amount/d.regCapital) <= 2 ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{(d.loan.amount/d.regCapital).toFixed(2)}x</span></div>
                                                <div className="text-[10px] text-slate-600">{(d.loan.amount/d.regCapital) <= 2 ? t('deOk') : t('deFail')}</div>
                                            </div>

                                            {/* BEP */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>BEP</span><span className={d.targetBags >= c.bepUnits ? 'text-green-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.bepUnits)}</span></div>
                                                <div className="text-[10px] text-slate-600">{d.targetBags >= c.bepUnits ? t('bepOk')(fmt(d.targetBags - c.bepUnits)) : t('bepFail')}</div>
                                            </div>

                                            {/* ROE */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>ROE</span><span className="text-blue-500 font-bold">{fmtDec(c.roi)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.roi > 15 ? t('roeHigh') : (c.roi > 5 ? t('roeMed') : t('roeLow'))}</div>
                                            </div>

                                            {/* Margins */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Net Margin</span><span className={c.netMargin > 10 ? 'text-green-500 font-bold' : 'text-orange-500 font-bold'}>{(c.netMargin || 0).toFixed(1)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.netMargin > 15 ? t('nmHigh') : (c.netMargin > 5 ? t('nmMed') : t('nmLow'))}</div>
                                            </div>

                                            {/* Fixed/Variable Check */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Cost Structure</span><span className="text-slate-700 font-bold">Fix {((c.revBreakdown.opFixed/c.revBreakdown.opCost)*100).toFixed(0)}% : Var {((c.revBreakdown.opVar/c.revBreakdown.opCost)*100).toFixed(0)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.revBreakdown.opFixed > c.revBreakdown.opVar ? t('fixHigh') : t('varHigh')}</div>
                                            </div>

                                            {/* Working Cap */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Working Cap</span><span className={c.workingCap > 0 ? 'text-blue-500 font-bold' : 'text-red-500 font-bold'}>{fmt(c.workingCap)}</span></div>
                                                <div className="text-[10px] text-slate-600">{c.workingCap > 0 ? t('wcOk') : t('wcFail')}</div>
                                            </div>

                                            {/* CAPEX */}
                                            <div className="p-3 border rounded bg-white hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>CAPEX Break-even</span><span className="text-slate-700 font-bold">{c.paybackMonth}</span></div>
                                                <div className="text-[10px] text-slate-600">Period to recover initial investment</div>
                                            </div>

                                        </div>
                                    </div>

                                    {/* --- NEW: Marketing Deep Dive (Grid) --- */}
                                    <div className="mt-4 pt-4 border-t border-slate-200">
                                        <h4 className="font-bold text-indigo-700 mb-3 flex items-center gap-2">{t('adsPerformance')}</h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                            
                                            {/* ACOS */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>ACOS</span><span className={c.funnelMetrics.acos < 20 ? 'text-green-600 font-bold' : 'text-red-600 font-bold'}>{(c.funnelMetrics.acos || 0).toFixed(1)}%</span></div>
                                                <div className="text-[10px] text-slate-600">{c.funnelMetrics.acos < 20 ? t('acosOk') : t('acosFail')}</div>
                                            </div>

                                            {/* CPA */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>CPA</span><span className="text-indigo-700 font-bold">{fmt(c.funnelMetrics.cpa)} ‡∏ø</span></div>
                                                <div className="text-[10px] text-slate-600">{t('cpaCheck')(fmt(c.funnelMetrics.cpa))}</div>
                                            </div>

                                            {/* CPC (Bid) */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Max CPC</span><span className="text-blue-600 font-bold">{(c.funnelMetrics.cpc || 0).toFixed(2)} ‡∏ø</span></div>
                                                <div className="text-[10px] text-slate-600">{t('bidCheck')}</div>
                                            </div>

                                            {/* CTR / CVR */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Metrics Target</span><span className="text-slate-700 font-bold">CTR {d.mktFunnel.ctr}% / CVR {d.mktFunnel.cvr}%</span></div>
                                                <div className="text-[10px] text-slate-600">{d.mktFunnel.ctr < 1.5 ? t('ctrLow') : ""} {d.mktFunnel.cvr < 2 ? t('cvrLow') : ""}</div>
                                            </div>

                                            {/* Basket Size */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Basket Size (AOV)</span><span className="text-slate-700 font-bold">{d.mktFunnel.basketSize}</span></div>
                                                <div className="text-[10px] text-slate-600">{t('aovTip')}</div>
                                            </div>

                                            {/* Reach / Impression */}
                                            <div className="p-3 border rounded bg-indigo-50/50 hover:shadow-sm">
                                                <div className="flex justify-between text-xs text-slate-500 mb-1"><span>Scale</span><span className="text-slate-700 font-bold">{fmt(c.funnelMetrics.visitors)} Clicks</span></div>
                                                <div className="text-[10px] text-slate-600">{t('scaleTip')(fmt(c.funnelMetrics.visitors))}</div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>

                            {/* NEW: Financial Glossary Section */}
                            <div className="card mt-6 border-slate-200 shadow-sm">
                                <div className="card-header bg-slate-100"><div className="card-title text-slate-600 text-sm">{t('financialGlossary')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-700 mb-1">EBITDA</div>
                                            <div className="text-slate-500 italic mb-1">Earnings Before Interest, Tax, Depreciation</div>
                                            <div className="whitespace-pre-line">{t('gEbitda')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-700 mb-1">NPV</div>
                                            <div className="text-slate-500 italic mb-1">Net Present Value</div>
                                            <div className="whitespace-pre-line">{t('gNpv')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-700 mb-1">DSCR</div>
                                            <div className="text-slate-500 italic mb-1">Debt Service Coverage Ratio</div>
                                            <div className="whitespace-pre-line">{t('gDscr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-700 mb-1">D/E Ratio</div>
                                            <div className="text-slate-500 italic mb-1">Debt to Equity Ratio</div>
                                            <div className="whitespace-pre-line">{t('gDe')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">ROE</div>
                                            <div className="text-slate-500 italic mb-1">Return on Equity</div>
                                            <div className="whitespace-pre-line">{t('gRoe')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-pink-700 mb-1">Break-even Point</div>
                                            <div className="text-slate-500 italic mb-1">BEP (Units)</div>
                                            <div className="whitespace-pre-line">{t('gBep')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-teal-700 mb-1">ROA</div>
                                            <div className="text-slate-500 italic mb-1">Return on Assets</div>
                                            <div className="whitespace-pre-line">{t('gRoa')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">Asset Turnover</div>
                                            <div className="text-slate-500 italic mb-1">Asset Turnover Ratio</div>
                                            <div className="whitespace-pre-line">{t('gAssetTurn')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-blue-600 mb-1">Gross Margin</div>
                                            <div className="text-slate-500 italic mb-1">Gross Profit Margin</div>
                                            <div className="whitespace-pre-line">{t('gGross')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-green-600 mb-1">Net Margin</div>
                                            <div className="text-slate-500 italic mb-1">Net Profit Margin</div>
                                            <div className="whitespace-pre-line">{t('gNet')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-indigo-600 mb-1">Working Capital</div>
                                            <div className="text-slate-500 italic mb-1">Current Assets - Current Liabilities</div>
                                            <div className="whitespace-pre-line">{t('gWc')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-purple-600 mb-1">Tax Shield</div>
                                            <div className="text-slate-500 italic mb-1">Loss Carry Forward</div>
                                            <div className="whitespace-pre-line">{t('gTaxShield')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">CAPEX</div>
                                            <div className="text-slate-500 italic mb-1">Capital Expenditure</div>
                                            <div className="whitespace-pre-line">{t('gCapex')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-slate-700 mb-1">OPEX</div>
                                            <div className="text-slate-500 italic mb-1">Operating Expenditure</div>
                                            <div className="whitespace-pre-line">{t('gOpex')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-emerald-700 mb-1">Cash Flow</div>
                                            <div className="text-slate-500 italic mb-1">Liquidity</div>
                                            <div className="whitespace-pre-line">{t('gCf')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-red-600 mb-1">Fixed Cost</div>
                                            <div className="text-slate-500 italic mb-1">Fixed Expenses</div>
                                            <div className="whitespace-pre-line">{t('gFix')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-slate-50">
                                            <div className="font-bold text-orange-600 mb-1">Variable Cost</div>
                                            <div className="text-slate-500 italic mb-1">Variable Expenses</div>
                                            <div className="whitespace-pre-line">{t('gVar')}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* NEW: Marketing & Ads Glossary Section */}
                            <div className="card mt-6 border-indigo-200 shadow-sm">
                                <div className="card-header bg-indigo-50"><div className="card-title text-indigo-800 text-sm">{t('marketingGlossary')}</div></div>
                                <div className="card-body">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-xs text-slate-600">
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-700 mb-1">ROAS</div>
                                            <div className="text-slate-500 italic mb-1">Return on Ad Spend</div>
                                            <div className="whitespace-pre-line">{t('gRoas')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-pink-700 mb-1">ACOS</div>
                                            <div className="text-slate-500 italic mb-1">Advertising Cost of Sales</div>
                                            <div className="whitespace-pre-line">{t('gAcos')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-blue-700 mb-1">CPA</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Acquisition / Action</div>
                                            <div className="whitespace-pre-line">{t('gCpa')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-orange-700 mb-1">CPC</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Click</div>
                                            <div className="whitespace-pre-line">{t('gCpc')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-teal-700 mb-1">CTR</div>
                                            <div className="text-slate-500 italic mb-1">Click-Through Rate</div>
                                            <div className="whitespace-pre-line">{t('gCtr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-purple-700 mb-1">CVR</div>
                                            <div className="text-slate-500 italic mb-1">Conversion Rate</div>
                                            <div className="whitespace-pre-line">{t('gCvr')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-sky-700 mb-1">CPM</div>
                                            <div className="text-slate-500 italic mb-1">Cost Per Mille (1,000 Impressions)</div>
                                            <div className="whitespace-pre-line">{t('gCpm')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-green-700 mb-1">GMV</div>
                                            <div className="text-slate-500 italic mb-1">Gross Merchandise Value</div>
                                            <div className="whitespace-pre-line">{t('gGmv')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-red-700 mb-1">Impression</div>
                                            <div className="text-slate-500 italic mb-1">Ad Views</div>
                                            <div className="whitespace-pre-line">{t('gImp')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-indigo-600 mb-1">Basket Size / AOV</div>
                                            <div className="text-slate-500 italic mb-1">Average Order Value</div>
                                            <div className="whitespace-pre-line">{t('gAov')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Affiliate</div>
                                            <div className="text-slate-500 italic mb-1">Commission Base</div>
                                            <div className="whitespace-pre-line">{t('gAff')}</div>
                                        </div>
                                        <div className="p-2 border rounded hover:bg-indigo-50">
                                            <div className="font-bold text-slate-700 mb-1">Reach</div>
                                            <div className="text-slate-500 italic mb-1">Unique Users</div>
                                            <div className="whitespace-pre-line">{t('gReach')}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
